<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="pdoc 15.0.4"/>
    <title>src.cvxsimulator API documentation</title>

    <style>/*! * Bootstrap Reboot v5.0.0 (https://getbootstrap.com/) * Copyright 2011-2021 The Bootstrap Authors * Copyright 2011-2021 Twitter, Inc. * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE) * Forked from Normalize.css, licensed MIT (https://github.com/necolas/normalize.css/blob/master/LICENSE.md) */*,::after,::before{box-sizing:border-box}@media (prefers-reduced-motion:no-preference){:root{scroll-behavior:smooth}}body{margin:0;font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans","Liberation Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-size:1rem;font-weight:400;line-height:1.5;color:#212529;background-color:#fff;-webkit-text-size-adjust:100%;-webkit-tap-highlight-color:transparent}hr{margin:1rem 0;color:inherit;background-color:currentColor;border:0;opacity:.25}hr:not([size]){height:1px}h1,h2,h3,h4,h5,h6{margin-top:0;margin-bottom:.5rem;font-weight:500;line-height:1.2}h1{font-size:calc(1.375rem + 1.5vw)}@media (min-width:1200px){h1{font-size:2.5rem}}h2{font-size:calc(1.325rem + .9vw)}@media (min-width:1200px){h2{font-size:2rem}}h3{font-size:calc(1.3rem + .6vw)}@media (min-width:1200px){h3{font-size:1.75rem}}h4{font-size:calc(1.275rem + .3vw)}@media (min-width:1200px){h4{font-size:1.5rem}}h5{font-size:1.25rem}h6{font-size:1rem}p{margin-top:0;margin-bottom:1rem}abbr[data-bs-original-title],abbr[title]{-webkit-text-decoration:underline dotted;text-decoration:underline dotted;cursor:help;-webkit-text-decoration-skip-ink:none;text-decoration-skip-ink:none}address{margin-bottom:1rem;font-style:normal;line-height:inherit}ol,ul{padding-left:2rem}dl,ol,ul{margin-top:0;margin-bottom:1rem}ol ol,ol ul,ul ol,ul ul{margin-bottom:0}dt{font-weight:700}dd{margin-bottom:.5rem;margin-left:0}blockquote{margin:0 0 1rem}b,strong{font-weight:bolder}small{font-size:.875em}mark{padding:.2em;background-color:#fcf8e3}sub,sup{position:relative;font-size:.75em;line-height:0;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}a{color:#0d6efd;text-decoration:underline}a:hover{color:#0a58ca}a:not([href]):not([class]),a:not([href]):not([class]):hover{color:inherit;text-decoration:none}code,kbd,pre,samp{font-family:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;font-size:1em;direction:ltr;unicode-bidi:bidi-override}pre{display:block;margin-top:0;margin-bottom:1rem;overflow:auto;font-size:.875em}pre code{font-size:inherit;color:inherit;word-break:normal}code{font-size:.875em;color:#d63384;word-wrap:break-word}a>code{color:inherit}kbd{padding:.2rem .4rem;font-size:.875em;color:#fff;background-color:#212529;border-radius:.2rem}kbd kbd{padding:0;font-size:1em;font-weight:700}figure{margin:0 0 1rem}img,svg{vertical-align:middle}table{caption-side:bottom;border-collapse:collapse}caption{padding-top:.5rem;padding-bottom:.5rem;color:#6c757d;text-align:left}th{text-align:inherit;text-align:-webkit-match-parent}tbody,td,tfoot,th,thead,tr{border-color:inherit;border-style:solid;border-width:0}label{display:inline-block}button{border-radius:0}button:focus:not(:focus-visible){outline:0}button,input,optgroup,select,textarea{margin:0;font-family:inherit;font-size:inherit;line-height:inherit}button,select{text-transform:none}[role=button]{cursor:pointer}select{word-wrap:normal}select:disabled{opacity:1}[list]::-webkit-calendar-picker-indicator{display:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]:not(:disabled),[type=reset]:not(:disabled),[type=submit]:not(:disabled),button:not(:disabled){cursor:pointer}::-moz-focus-inner{padding:0;border-style:none}textarea{resize:vertical}fieldset{min-width:0;padding:0;margin:0;border:0}legend{float:left;width:100%;padding:0;margin-bottom:.5rem;font-size:calc(1.275rem + .3vw);line-height:inherit}@media (min-width:1200px){legend{font-size:1.5rem}}legend+*{clear:left}::-webkit-datetime-edit-day-field,::-webkit-datetime-edit-fields-wrapper,::-webkit-datetime-edit-hour-field,::-webkit-datetime-edit-minute,::-webkit-datetime-edit-month-field,::-webkit-datetime-edit-text,::-webkit-datetime-edit-year-field{padding:0}::-webkit-inner-spin-button{height:auto}[type=search]{outline-offset:-2px;-webkit-appearance:textfield}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-color-swatch-wrapper{padding:0}::file-selector-button{font:inherit}::-webkit-file-upload-button{font:inherit;-webkit-appearance:button}output{display:inline-block}iframe{border:0}summary{display:list-item;cursor:pointer}progress{vertical-align:baseline}[hidden]{display:none!important}</style>
    <style>/*! syntax-highlighting.css */pre{line-height:125%;}span.linenos{color:inherit; background-color:transparent; padding-left:5px; padding-right:20px;}.pdoc-code .hll{background-color:#ffffcc}.pdoc-code{background:#f8f8f8;}.pdoc-code .c{color:#3D7B7B; font-style:italic}.pdoc-code .err{border:1px solid #FF0000}.pdoc-code .k{color:#008000; font-weight:bold}.pdoc-code .o{color:#666666}.pdoc-code .ch{color:#3D7B7B; font-style:italic}.pdoc-code .cm{color:#3D7B7B; font-style:italic}.pdoc-code .cp{color:#9C6500}.pdoc-code .cpf{color:#3D7B7B; font-style:italic}.pdoc-code .c1{color:#3D7B7B; font-style:italic}.pdoc-code .cs{color:#3D7B7B; font-style:italic}.pdoc-code .gd{color:#A00000}.pdoc-code .ge{font-style:italic}.pdoc-code .gr{color:#E40000}.pdoc-code .gh{color:#000080; font-weight:bold}.pdoc-code .gi{color:#008400}.pdoc-code .go{color:#717171}.pdoc-code .gp{color:#000080; font-weight:bold}.pdoc-code .gs{font-weight:bold}.pdoc-code .gu{color:#800080; font-weight:bold}.pdoc-code .gt{color:#0044DD}.pdoc-code .kc{color:#008000; font-weight:bold}.pdoc-code .kd{color:#008000; font-weight:bold}.pdoc-code .kn{color:#008000; font-weight:bold}.pdoc-code .kp{color:#008000}.pdoc-code .kr{color:#008000; font-weight:bold}.pdoc-code .kt{color:#B00040}.pdoc-code .m{color:#666666}.pdoc-code .s{color:#BA2121}.pdoc-code .na{color:#687822}.pdoc-code .nb{color:#008000}.pdoc-code .nc{color:#0000FF; font-weight:bold}.pdoc-code .no{color:#880000}.pdoc-code .nd{color:#AA22FF}.pdoc-code .ni{color:#717171; font-weight:bold}.pdoc-code .ne{color:#CB3F38; font-weight:bold}.pdoc-code .nf{color:#0000FF}.pdoc-code .nl{color:#767600}.pdoc-code .nn{color:#0000FF; font-weight:bold}.pdoc-code .nt{color:#008000; font-weight:bold}.pdoc-code .nv{color:#19177C}.pdoc-code .ow{color:#AA22FF; font-weight:bold}.pdoc-code .w{color:#bbbbbb}.pdoc-code .mb{color:#666666}.pdoc-code .mf{color:#666666}.pdoc-code .mh{color:#666666}.pdoc-code .mi{color:#666666}.pdoc-code .mo{color:#666666}.pdoc-code .sa{color:#BA2121}.pdoc-code .sb{color:#BA2121}.pdoc-code .sc{color:#BA2121}.pdoc-code .dl{color:#BA2121}.pdoc-code .sd{color:#BA2121; font-style:italic}.pdoc-code .s2{color:#BA2121}.pdoc-code .se{color:#AA5D1F; font-weight:bold}.pdoc-code .sh{color:#BA2121}.pdoc-code .si{color:#A45A77; font-weight:bold}.pdoc-code .sx{color:#008000}.pdoc-code .sr{color:#A45A77}.pdoc-code .s1{color:#BA2121}.pdoc-code .ss{color:#19177C}.pdoc-code .bp{color:#008000}.pdoc-code .fm{color:#0000FF}.pdoc-code .vc{color:#19177C}.pdoc-code .vg{color:#19177C}.pdoc-code .vi{color:#19177C}.pdoc-code .vm{color:#19177C}.pdoc-code .il{color:#666666}</style>
    <style>/*! theme.css */:root{--pdoc-background:#fff;}.pdoc{--text:#212529;--muted:#6c757d;--link:#3660a5;--link-hover:#1659c5;--code:#f8f8f8;--active:#fff598;--accent:#eee;--accent2:#c1c1c1;--nav-hover:rgba(255, 255, 255, 0.5);--name:#0066BB;--def:#008800;--annotation:#007020;}</style>
    <style>/*! layout.css */html, body{width:100%;height:100%;}html, main{scroll-behavior:smooth;}body{background-color:var(--pdoc-background);}@media (max-width:769px){#navtoggle{cursor:pointer;position:absolute;width:50px;height:40px;top:1rem;right:1rem;border-color:var(--text);color:var(--text);display:flex;opacity:0.8;z-index:999;}#navtoggle:hover{opacity:1;}#togglestate + div{display:none;}#togglestate:checked + div{display:inherit;}main, header{padding:2rem 3vw;}header + main{margin-top:-3rem;}.git-button{display:none !important;}nav input[type="search"]{max-width:77%;}nav input[type="search"]:first-child{margin-top:-6px;}nav input[type="search"]:valid ~ *{display:none !important;}}@media (min-width:770px){:root{--sidebar-width:clamp(12.5rem, 28vw, 22rem);}nav{position:fixed;overflow:auto;height:100vh;width:var(--sidebar-width);}main, header{padding:3rem 2rem 3rem calc(var(--sidebar-width) + 3rem);width:calc(54rem + var(--sidebar-width));max-width:100%;}header + main{margin-top:-4rem;}#navtoggle{display:none;}}#togglestate{position:absolute;height:0;opacity:0;}nav.pdoc{--pad:clamp(0.5rem, 2vw, 1.75rem);--indent:1.5rem;background-color:var(--accent);border-right:1px solid var(--accent2);box-shadow:0 0 20px rgba(50, 50, 50, .2) inset;padding:0 0 0 var(--pad);overflow-wrap:anywhere;scrollbar-width:thin; scrollbar-color:var(--accent2) transparent; z-index:1}nav.pdoc::-webkit-scrollbar{width:.4rem; }nav.pdoc::-webkit-scrollbar-thumb{background-color:var(--accent2); }nav.pdoc > div{padding:var(--pad) 0;}nav.pdoc .module-list-button{display:inline-flex;align-items:center;color:var(--text);border-color:var(--muted);margin-bottom:1rem;}nav.pdoc .module-list-button:hover{border-color:var(--text);}nav.pdoc input[type=search]{display:block;outline-offset:0;width:calc(100% - var(--pad));}nav.pdoc .logo{max-width:calc(100% - var(--pad));max-height:35vh;display:block;margin:0 auto 1rem;transform:translate(calc(-.5 * var(--pad)), 0);}nav.pdoc ul{list-style:none;padding-left:0;}nav.pdoc > div > ul{margin-left:calc(0px - var(--pad));}nav.pdoc li a{padding:.2rem 0 .2rem calc(var(--pad) + var(--indent));}nav.pdoc > div > ul > li > a{padding-left:var(--pad);}nav.pdoc li{transition:all 100ms;}nav.pdoc li:hover{background-color:var(--nav-hover);}nav.pdoc a, nav.pdoc a:hover{color:var(--text);}nav.pdoc a{display:block;}nav.pdoc > h2:first-of-type{margin-top:1.5rem;}nav.pdoc .class:before{content:"class ";color:var(--muted);}nav.pdoc .function:after{content:"()";color:var(--muted);}nav.pdoc footer:before{content:"";display:block;width:calc(100% - var(--pad));border-top:solid var(--accent2) 1px;margin-top:1.5rem;padding-top:.5rem;}nav.pdoc footer{font-size:small;}</style>
    <style>/*! content.css */.pdoc{color:var(--text);box-sizing:border-box;line-height:1.5;background:none;}.pdoc .pdoc-button{cursor:pointer;display:inline-block;border:solid black 1px;border-radius:2px;font-size:.75rem;padding:calc(0.5em - 1px) 1em;transition:100ms all;}.pdoc .alert{padding:1rem 1rem 1rem calc(1.5rem + 24px);border:1px solid transparent;border-radius:.25rem;background-repeat:no-repeat;background-position:.75rem center;margin-bottom:1rem;}.pdoc .alert > em{display:none;}.pdoc .alert > *:last-child{margin-bottom:0;}.pdoc .alert.note{color:#084298;background-color:#cfe2ff;border-color:#b6d4fe;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23084298%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8%2016A8%208%200%201%200%208%200a8%208%200%200%200%200%2016zm.93-9.412-1%204.705c-.07.34.029.533.304.533.194%200%20.487-.07.686-.246l-.088.416c-.287.346-.92.598-1.465.598-.703%200-1.002-.422-.808-1.319l.738-3.468c.064-.293.006-.399-.287-.47l-.451-.081.082-.381%202.29-.287zM8%205.5a1%201%200%201%201%200-2%201%201%200%200%201%200%202z%22/%3E%3C/svg%3E");}.pdoc .alert.tip{color:#0a3622;background-color:#d1e7dd;border-color:#a3cfbb;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%230a3622%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M2%206a6%206%200%201%201%2010.174%204.31c-.203.196-.359.4-.453.619l-.762%201.769A.5.5%200%200%201%2010.5%2013a.5.5%200%200%201%200%201%20.5.5%200%200%201%200%201l-.224.447a1%201%200%200%201-.894.553H6.618a1%201%200%200%201-.894-.553L5.5%2015a.5.5%200%200%201%200-1%20.5.5%200%200%201%200-1%20.5.5%200%200%201-.46-.302l-.761-1.77a2%202%200%200%200-.453-.618A5.98%205.98%200%200%201%202%206m6-5a5%205%200%200%200-3.479%208.592c.263.254.514.564.676.941L5.83%2012h4.342l.632-1.467c.162-.377.413-.687.676-.941A5%205%200%200%200%208%201%22/%3E%3C/svg%3E");}.pdoc .alert.important{color:#055160;background-color:#cff4fc;border-color:#9eeaf9;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23055160%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M2%200a2%202%200%200%200-2%202v12a2%202%200%200%200%202%202h12a2%202%200%200%200%202-2V2a2%202%200%200%200-2-2zm6%204c.535%200%20.954.462.9.995l-.35%203.507a.552.552%200%200%201-1.1%200L7.1%204.995A.905.905%200%200%201%208%204m.002%206a1%201%200%201%201%200%202%201%201%200%200%201%200-2%22/%3E%3C/svg%3E");}.pdoc .alert.warning{color:#664d03;background-color:#fff3cd;border-color:#ffecb5;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23664d03%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8.982%201.566a1.13%201.13%200%200%200-1.96%200L.165%2013.233c-.457.778.091%201.767.98%201.767h13.713c.889%200%201.438-.99.98-1.767L8.982%201.566zM8%205c.535%200%20.954.462.9.995l-.35%203.507a.552.552%200%200%201-1.1%200L7.1%205.995A.905.905%200%200%201%208%205zm.002%206a1%201%200%201%201%200%202%201%201%200%200%201%200-2z%22/%3E%3C/svg%3E");}.pdoc .alert.caution{color:#842029;background-color:#f8d7da;border-color:#f5c2c7;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23842029%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M11.46.146A.5.5%200%200%200%2011.107%200H4.893a.5.5%200%200%200-.353.146L.146%204.54A.5.5%200%200%200%200%204.893v6.214a.5.5%200%200%200%20.146.353l4.394%204.394a.5.5%200%200%200%20.353.146h6.214a.5.5%200%200%200%20.353-.146l4.394-4.394a.5.5%200%200%200%20.146-.353V4.893a.5.5%200%200%200-.146-.353zM8%204c.535%200%20.954.462.9.995l-.35%203.507a.552.552%200%200%201-1.1%200L7.1%204.995A.905.905%200%200%201%208%204m.002%206a1%201%200%201%201%200%202%201%201%200%200%201%200-2%22/%3E%3C/svg%3E");}.pdoc .alert.danger{color:#842029;background-color:#f8d7da;border-color:#f5c2c7;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23842029%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M5.52.359A.5.5%200%200%201%206%200h4a.5.5%200%200%201%20.474.658L8.694%206H12.5a.5.5%200%200%201%20.395.807l-7%209a.5.5%200%200%201-.873-.454L6.823%209.5H3.5a.5.5%200%200%201-.48-.641l2.5-8.5z%22/%3E%3C/svg%3E");}.pdoc .visually-hidden{position:absolute !important;width:1px !important;height:1px !important;padding:0 !important;margin:-1px !important;overflow:hidden !important;clip:rect(0, 0, 0, 0) !important;white-space:nowrap !important;border:0 !important;}.pdoc h1, .pdoc h2, .pdoc h3{font-weight:300;margin:.3em 0;padding:.2em 0;}.pdoc > section:not(.module-info) h1{font-size:1.5rem;font-weight:500;}.pdoc > section:not(.module-info) h2{font-size:1.4rem;font-weight:500;}.pdoc > section:not(.module-info) h3{font-size:1.3rem;font-weight:500;}.pdoc > section:not(.module-info) h4{font-size:1.2rem;}.pdoc > section:not(.module-info) h5{font-size:1.1rem;}.pdoc a{text-decoration:none;color:var(--link);}.pdoc a:hover{color:var(--link-hover);}.pdoc blockquote{margin-left:2rem;}.pdoc pre{border-top:1px solid var(--accent2);border-bottom:1px solid var(--accent2);margin-top:0;margin-bottom:1em;padding:.5rem 0 .5rem .5rem;overflow-x:auto;background-color:var(--code);}.pdoc code{color:var(--text);padding:.2em .4em;margin:0;font-size:85%;background-color:var(--accent);border-radius:6px;}.pdoc a > code{color:inherit;}.pdoc pre > code{display:inline-block;font-size:inherit;background:none;border:none;padding:0;}.pdoc > section:not(.module-info){margin-bottom:1.5rem;}.pdoc .modulename{margin-top:0;font-weight:bold;}.pdoc .modulename a{color:var(--link);transition:100ms all;}.pdoc .git-button{float:right;border:solid var(--link) 1px;}.pdoc .git-button:hover{background-color:var(--link);color:var(--pdoc-background);}.view-source-toggle-state,.view-source-toggle-state ~ .pdoc-code{display:none;}.view-source-toggle-state:checked ~ .pdoc-code{display:block;}.view-source-button{display:inline-block;float:right;font-size:.75rem;line-height:1.5rem;color:var(--muted);padding:0 .4rem 0 1.3rem;cursor:pointer;text-indent:-2px;}.view-source-button > span{visibility:hidden;}.module-info .view-source-button{float:none;display:flex;justify-content:flex-end;margin:-1.2rem .4rem -.2rem 0;}.view-source-button::before{position:absolute;content:"View Source";display:list-item;list-style-type:disclosure-closed;}.view-source-toggle-state:checked ~ .attr .view-source-button::before,.view-source-toggle-state:checked ~ .view-source-button::before{list-style-type:disclosure-open;}.pdoc .docstring{margin-bottom:1.5rem;}.pdoc section:not(.module-info) .docstring{margin-left:clamp(0rem, 5vw - 2rem, 1rem);}.pdoc .docstring .pdoc-code{margin-left:1em;margin-right:1em;}.pdoc h1:target,.pdoc h2:target,.pdoc h3:target,.pdoc h4:target,.pdoc h5:target,.pdoc h6:target,.pdoc .pdoc-code > pre > span:target{background-color:var(--active);box-shadow:-1rem 0 0 0 var(--active);}.pdoc .pdoc-code > pre > span:target{display:block;}.pdoc div:target > .attr,.pdoc section:target > .attr,.pdoc dd:target > a{background-color:var(--active);}.pdoc *{scroll-margin:2rem;}.pdoc .pdoc-code .linenos{user-select:none;}.pdoc .attr:hover{filter:contrast(0.95);}.pdoc section, .pdoc .classattr{position:relative;}.pdoc .headerlink{--width:clamp(1rem, 3vw, 2rem);position:absolute;top:0;left:calc(0rem - var(--width));transition:all 100ms ease-in-out;opacity:0;}.pdoc .headerlink::before{content:"#";display:block;text-align:center;width:var(--width);height:2.3rem;line-height:2.3rem;font-size:1.5rem;}.pdoc .attr:hover ~ .headerlink,.pdoc *:target > .headerlink,.pdoc .headerlink:hover{opacity:1;}.pdoc .attr{display:block;margin:.5rem 0 .5rem;padding:.4rem .4rem .4rem 1rem;background-color:var(--accent);overflow-x:auto;}.pdoc .classattr{margin-left:2rem;}.pdoc .decorator-deprecated{color:#842029;}.pdoc .decorator-deprecated ~ span{filter:grayscale(1) opacity(0.8);}.pdoc .name{color:var(--name);font-weight:bold;}.pdoc .def{color:var(--def);font-weight:bold;}.pdoc .signature{background-color:transparent;}.pdoc .param, .pdoc .return-annotation{white-space:pre;}.pdoc .signature.multiline .param{display:block;}.pdoc .signature.condensed .param{display:inline-block;}.pdoc .annotation{color:var(--annotation);}.pdoc .view-value-toggle-state,.pdoc .view-value-toggle-state ~ .default_value{display:none;}.pdoc .view-value-toggle-state:checked ~ .default_value{display:inherit;}.pdoc .view-value-button{font-size:.5rem;vertical-align:middle;border-style:dashed;margin-top:-0.1rem;}.pdoc .view-value-button:hover{background:white;}.pdoc .view-value-button::before{content:"show";text-align:center;width:2.2em;display:inline-block;}.pdoc .view-value-toggle-state:checked ~ .view-value-button::before{content:"hide";}.pdoc .inherited{margin-left:2rem;}.pdoc .inherited dt{font-weight:700;}.pdoc .inherited dt, .pdoc .inherited dd{display:inline;margin-left:0;margin-bottom:.5rem;}.pdoc .inherited dd:not(:last-child):after{content:", ";}.pdoc .inherited .class:before{content:"class ";}.pdoc .inherited .function a:after{content:"()";}.pdoc .search-result .docstring{overflow:auto;max-height:25vh;}.pdoc .search-result.focused > .attr{background-color:var(--active);}.pdoc .attribution{margin-top:2rem;display:block;opacity:0.5;transition:all 200ms;filter:grayscale(100%);}.pdoc .attribution:hover{opacity:1;filter:grayscale(0%);}.pdoc .attribution img{margin-left:5px;height:35px;vertical-align:middle;width:70px;transition:all 200ms;}.pdoc table{display:block;width:max-content;max-width:100%;overflow:auto;margin-bottom:1rem;}.pdoc table th{font-weight:600;}.pdoc table th, .pdoc table td{padding:6px 13px;border:1px solid var(--accent2);}</style>
    <style>/*! custom.css */</style></head>
<body>
    <nav class="pdoc">
        <label id="navtoggle" for="togglestate" class="pdoc-button"><svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'><path stroke-linecap='round' stroke="currentColor" stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/></svg></label>
        <input id="togglestate" type="checkbox" aria-hidden="true" tabindex="-1">
        <div>




            <h2>API Documentation</h2>
                <ul class="memberlist">
            <li>
                    <a class="class" href="#Builder">Builder</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#Builder.__init__">Builder</a>
                        </li>
                        <li>
                                <a class="variable" href="#Builder.prices">prices</a>
                        </li>
                        <li>
                                <a class="variable" href="#Builder.initial_aum">initial_aum</a>
                        </li>
                        <li>
                                <a class="variable" href="#Builder.valid">valid</a>
                        </li>
                        <li>
                                <a class="variable" href="#Builder.intervals">intervals</a>
                        </li>
                        <li>
                                <a class="variable" href="#Builder.index">index</a>
                        </li>
                        <li>
                                <a class="variable" href="#Builder.current_prices">current_prices</a>
                        </li>
                        <li>
                                <a class="variable" href="#Builder.position">position</a>
                        </li>
                        <li>
                                <a class="variable" href="#Builder.cashposition">cashposition</a>
                        </li>
                        <li>
                                <a class="variable" href="#Builder.units">units</a>
                        </li>
                        <li>
                                <a class="function" href="#Builder.build">build</a>
                        </li>
                        <li>
                                <a class="variable" href="#Builder.weights">weights</a>
                        </li>
                        <li>
                                <a class="variable" href="#Builder.aum">aum</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#Portfolio">Portfolio</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#Portfolio.__init__">Portfolio</a>
                        </li>
                        <li>
                                <a class="variable" href="#Portfolio.prices">prices</a>
                        </li>
                        <li>
                                <a class="variable" href="#Portfolio.units">units</a>
                        </li>
                        <li>
                                <a class="variable" href="#Portfolio.aum">aum</a>
                        </li>
                        <li>
                                <a class="variable" href="#Portfolio.index">index</a>
                        </li>
                        <li>
                                <a class="variable" href="#Portfolio.assets">assets</a>
                        </li>
                        <li>
                                <a class="variable" href="#Portfolio.nav">nav</a>
                        </li>
                        <li>
                                <a class="variable" href="#Portfolio.profit">profit</a>
                        </li>
                        <li>
                                <a class="variable" href="#Portfolio.cashposition">cashposition</a>
                        </li>
                        <li>
                                <a class="variable" href="#Portfolio.returns">returns</a>
                        </li>
                        <li>
                                <a class="variable" href="#Portfolio.trades_units">trades_units</a>
                        </li>
                        <li>
                                <a class="variable" href="#Portfolio.trades_currency">trades_currency</a>
                        </li>
                        <li>
                                <a class="variable" href="#Portfolio.turnover_relative">turnover_relative</a>
                        </li>
                        <li>
                                <a class="variable" href="#Portfolio.turnover">turnover</a>
                        </li>
                        <li>
                                <a class="variable" href="#Portfolio.equity">equity</a>
                        </li>
                        <li>
                                <a class="variable" href="#Portfolio.weights">weights</a>
                        </li>
                        <li>
                                <a class="variable" href="#Portfolio.stats">stats</a>
                        </li>
                        <li>
                                <a class="variable" href="#Portfolio.plots">plots</a>
                        </li>
                        <li>
                                <a class="variable" href="#Portfolio.reports">reports</a>
                        </li>
                        <li>
                                <a class="function" href="#Portfolio.sharpe">sharpe</a>
                        </li>
                        <li>
                                <a class="function" href="#Portfolio.from_cashpos_prices">from_cashpos_prices</a>
                        </li>
                        <li>
                                <a class="function" href="#Portfolio.snapshot">snapshot</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#State">State</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#State.__init__">State</a>
                        </li>
                        <li>
                                <a class="variable" href="#State.cash">cash</a>
                        </li>
                        <li>
                                <a class="variable" href="#State.nav">nav</a>
                        </li>
                        <li>
                                <a class="variable" href="#State.value">value</a>
                        </li>
                        <li>
                                <a class="variable" href="#State.cashposition">cashposition</a>
                        </li>
                        <li>
                                <a class="variable" href="#State.position">position</a>
                        </li>
                        <li>
                                <a class="variable" href="#State.gmv">gmv</a>
                        </li>
                        <li>
                                <a class="variable" href="#State.time">time</a>
                        </li>
                        <li>
                                <a class="variable" href="#State.days">days</a>
                        </li>
                        <li>
                                <a class="variable" href="#State.assets">assets</a>
                        </li>
                        <li>
                                <a class="variable" href="#State.trades">trades</a>
                        </li>
                        <li>
                                <a class="variable" href="#State.mask">mask</a>
                        </li>
                        <li>
                                <a class="variable" href="#State.prices">prices</a>
                        </li>
                        <li>
                                <a class="variable" href="#State.profit">profit</a>
                        </li>
                        <li>
                                <a class="variable" href="#State.aum">aum</a>
                        </li>
                        <li>
                                <a class="variable" href="#State.weights">weights</a>
                        </li>
                        <li>
                                <a class="variable" href="#State.leverage">leverage</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="function" href="#interpolate">interpolate</a>
            </li>
            <li>
                    <a class="function" href="#valid">valid</a>
            </li>
    </ul>



        <a class="attribution" title="pdoc: Python API documentation generator" href="https://pdoc.dev" target="_blank">
            built with <span class="visually-hidden">pdoc</span><img
                alt="pdoc logo"
                src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20role%3D%22img%22%20aria-label%3D%22pdoc%20logo%22%20width%3D%22300%22%20height%3D%22150%22%20viewBox%3D%22-1%200%2060%2030%22%3E%3Ctitle%3Epdoc%3C/title%3E%3Cpath%20d%3D%22M29.621%2021.293c-.011-.273-.214-.475-.511-.481a.5.5%200%200%200-.489.503l-.044%201.393c-.097.551-.695%201.215-1.566%201.704-.577.428-1.306.486-2.193.182-1.426-.617-2.467-1.654-3.304-2.487l-.173-.172a3.43%203.43%200%200%200-.365-.306.49.49%200%200%200-.286-.196c-1.718-1.06-4.931-1.47-7.353.191l-.219.15c-1.707%201.187-3.413%202.131-4.328%201.03-.02-.027-.49-.685-.141-1.763.233-.721.546-2.408.772-4.076.042-.09.067-.187.046-.288.166-1.347.277-2.625.241-3.351%201.378-1.008%202.271-2.586%202.271-4.362%200-.976-.272-1.935-.788-2.774-.057-.094-.122-.18-.184-.268.033-.167.052-.339.052-.516%200-1.477-1.202-2.679-2.679-2.679-.791%200-1.496.352-1.987.9a6.3%206.3%200%200%200-1.001.029c-.492-.564-1.207-.929-2.012-.929-1.477%200-2.679%201.202-2.679%202.679A2.65%202.65%200%200%200%20.97%206.554c-.383.747-.595%201.572-.595%202.41%200%202.311%201.507%204.29%203.635%205.107-.037.699-.147%202.27-.423%203.294l-.137.461c-.622%202.042-2.515%208.257%201.727%2010.643%201.614.908%203.06%201.248%204.317%201.248%202.665%200%204.492-1.524%205.322-2.401%201.476-1.559%202.886-1.854%206.491.82%201.877%201.393%203.514%201.753%204.861%201.068%202.223-1.713%202.811-3.867%203.399-6.374.077-.846.056-1.469.054-1.537zm-4.835%204.313c-.054.305-.156.586-.242.629-.034-.007-.131-.022-.307-.157-.145-.111-.314-.478-.456-.908.221.121.432.25.675.355.115.039.219.051.33.081zm-2.251-1.238c-.05.33-.158.648-.252.694-.022.001-.125-.018-.307-.157-.217-.166-.488-.906-.639-1.573.358.344.754.693%201.198%201.036zm-3.887-2.337c-.006-.116-.018-.231-.041-.342.635.145%201.189.368%201.599.625.097.231.166.481.174.642-.03.049-.055.101-.067.158-.046.013-.128.026-.298.004-.278-.037-.901-.57-1.367-1.087zm-1.127-.497c.116.306.176.625.12.71-.019.014-.117.045-.345.016-.206-.027-.604-.332-.986-.695.41-.051.816-.056%201.211-.031zm-4.535%201.535c.209.22.379.47.358.598-.006.041-.088.138-.351.234-.144.055-.539-.063-.979-.259a11.66%2011.66%200%200%200%20.972-.573zm.983-.664c.359-.237.738-.418%201.126-.554.25.237.479.548.457.694-.006.042-.087.138-.351.235-.174.064-.694-.105-1.232-.375zm-3.381%201.794c-.022.145-.061.29-.149.401-.133.166-.358.248-.69.251h-.002c-.133%200-.306-.26-.45-.621.417.091.854.07%201.291-.031zm-2.066-8.077a4.78%204.78%200%200%201-.775-.584c.172-.115.505-.254.88-.378l-.105.962zm-.331%202.302a10.32%2010.32%200%200%201-.828-.502c.202-.143.576-.328.984-.49l-.156.992zm-.45%202.157l-.701-.403c.214-.115.536-.249.891-.376a11.57%2011.57%200%200%201-.19.779zm-.181%201.716c.064.398.194.702.298.893-.194-.051-.435-.162-.736-.398.061-.119.224-.3.438-.495zM8.87%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zm-.735-.389a1.15%201.15%200%200%200-.314.783%201.16%201.16%200%200%200%201.162%201.162c.457%200%20.842-.27%201.032-.653.026.117.042.238.042.362a1.68%201.68%200%200%201-1.679%201.679%201.68%201.68%200%200%201-1.679-1.679c0-.843.626-1.535%201.436-1.654zM5.059%205.406A1.68%201.68%200%200%201%203.38%207.085a1.68%201.68%200%200%201-1.679-1.679c0-.037.009-.072.011-.109.21.3.541.508.935.508a1.16%201.16%200%200%200%201.162-1.162%201.14%201.14%200%200%200-.474-.912c.015%200%20.03-.005.045-.005.926.001%201.679.754%201.679%201.68zM3.198%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zM1.375%208.964c0-.52.103-1.035.288-1.52.466.394%201.06.64%201.717.64%201.144%200%202.116-.725%202.499-1.738.383%201.012%201.355%201.738%202.499%201.738.867%200%201.631-.421%202.121-1.062.307.605.478%201.267.478%201.942%200%202.486-2.153%204.51-4.801%204.51s-4.801-2.023-4.801-4.51zm24.342%2019.349c-.985.498-2.267.168-3.813-.979-3.073-2.281-5.453-3.199-7.813-.705-1.315%201.391-4.163%203.365-8.423.97-3.174-1.786-2.239-6.266-1.261-9.479l.146-.492c.276-1.02.395-2.457.444-3.268a6.11%206.11%200%200%200%201.18.115%206.01%206.01%200%200%200%202.536-.562l-.006.175c-.802.215-1.848.612-2.021%201.25-.079.295.021.601.274.837.219.203.415.364.598.501-.667.304-1.243.698-1.311%201.179-.02.144-.022.507.393.787.213.144.395.26.564.365-1.285.521-1.361.96-1.381%201.126-.018.142-.011.496.427.746l.854.489c-.473.389-.971.914-.999%201.429-.018.278.095.532.316.713.675.556%201.231.721%201.653.721.059%200%20.104-.014.158-.02.207.707.641%201.64%201.513%201.64h.013c.8-.008%201.236-.345%201.462-.626.173-.216.268-.457.325-.692.424.195.93.374%201.372.374.151%200%20.294-.021.423-.068.732-.27.944-.704.993-1.021.009-.061.003-.119.002-.179.266.086.538.147.789.147.15%200%20.294-.021.423-.069.542-.2.797-.489.914-.754.237.147.478.258.704.288.106.014.205.021.296.021.356%200%20.595-.101.767-.229.438.435%201.094.992%201.656%201.067.106.014.205.021.296.021a1.56%201.56%200%200%200%20.323-.035c.17.575.453%201.289.866%201.605.358.273.665.362.914.362a.99.99%200%200%200%20.421-.093%201.03%201.03%200%200%200%20.245-.164c.168.428.39.846.68%201.068.358.273.665.362.913.362a.99.99%200%200%200%20.421-.093c.317-.148.512-.448.639-.762.251.157.495.257.726.257.127%200%20.25-.024.37-.071.427-.17.706-.617.841-1.314.022-.015.047-.022.068-.038.067-.051.133-.104.196-.159-.443%201.486-1.107%202.761-2.086%203.257zM8.66%209.925a.5.5%200%201%200-1%200c0%20.653-.818%201.205-1.787%201.205s-1.787-.552-1.787-1.205a.5.5%200%201%200-1%200c0%201.216%201.25%202.205%202.787%202.205s2.787-.989%202.787-2.205zm4.4%2015.965l-.208.097c-2.661%201.258-4.708%201.436-6.086.527-1.542-1.017-1.88-3.19-1.844-4.198a.4.4%200%200%200-.385-.414c-.242-.029-.406.164-.414.385-.046%201.249.367%203.686%202.202%204.896.708.467%201.547.7%202.51.7%201.248%200%202.706-.392%204.362-1.174l.185-.086a.4.4%200%200%200%20.205-.527c-.089-.204-.326-.291-.527-.206zM9.547%202.292c.093.077.205.114.317.114a.5.5%200%200%200%20.318-.886L8.817.397a.5.5%200%200%200-.703.068.5.5%200%200%200%20.069.703l1.364%201.124zm-7.661-.065c.086%200%20.173-.022.253-.068l1.523-.893a.5.5%200%200%200-.506-.863l-1.523.892a.5.5%200%200%200-.179.685c.094.158.261.247.432.247z%22%20transform%3D%22matrix%28-1%200%200%201%2058%200%29%22%20fill%3D%22%233bb300%22/%3E%3Cpath%20d%3D%22M.3%2021.86V10.18q0-.46.02-.68.04-.22.18-.5.28-.54%201.34-.54%201.06%200%201.42.28.38.26.44.78.76-1.04%202.38-1.04%201.64%200%203.1%201.54%201.46%201.54%201.46%203.58%200%202.04-1.46%203.58-1.44%201.54-3.08%201.54-1.64%200-2.38-.92v4.04q0%20.46-.04.68-.02.22-.18.5-.14.3-.5.42-.36.12-.98.12-.62%200-1-.12-.36-.12-.52-.4-.14-.28-.18-.5-.02-.22-.02-.68zm3.96-9.42q-.46.54-.46%201.18%200%20.64.46%201.18.48.52%201.2.52.74%200%201.24-.52.52-.52.52-1.18%200-.66-.48-1.18-.48-.54-1.26-.54-.76%200-1.22.54zm14.741-8.36q.16-.3.54-.42.38-.12%201-.12.64%200%201.02.12.38.12.52.42.16.3.18.54.04.22.04.68v11.94q0%20.46-.04.7-.02.22-.18.5-.3.54-1.7.54-1.38%200-1.54-.98-.84.96-2.34.96-1.8%200-3.28-1.56-1.48-1.58-1.48-3.66%200-2.1%201.48-3.68%201.5-1.58%203.28-1.58%201.48%200%202.3%201v-4.2q0-.46.02-.68.04-.24.18-.52zm-3.24%2010.86q.52.54%201.26.54.74%200%201.22-.54.5-.54.5-1.18%200-.66-.48-1.22-.46-.56-1.26-.56-.8%200-1.28.56-.48.54-.48%201.2%200%20.66.52%201.2zm7.833-1.2q0-2.4%201.68-3.96%201.68-1.56%203.84-1.56%202.16%200%203.82%201.56%201.66%201.54%201.66%203.94%200%201.66-.86%202.96-.86%201.28-2.1%201.9-1.22.6-2.54.6-1.32%200-2.56-.64-1.24-.66-2.1-1.92-.84-1.28-.84-2.88zm4.18%201.44q.64.48%201.3.48.66%200%201.32-.5.66-.5.66-1.48%200-.98-.62-1.46-.62-.48-1.34-.48-.72%200-1.34.5-.62.5-.62%201.48%200%20.96.64%201.46zm11.412-1.44q0%20.84.56%201.32.56.46%201.18.46.64%200%201.18-.36.56-.38.9-.38.6%200%201.46%201.06.46.58.46%201.04%200%20.76-1.1%201.42-1.14.8-2.8.8-1.86%200-3.58-1.34-.82-.64-1.34-1.7-.52-1.08-.52-2.36%200-1.3.52-2.34.52-1.06%201.34-1.7%201.66-1.32%203.54-1.32.76%200%201.48.22.72.2%201.06.4l.32.2q.36.24.56.38.52.4.52.92%200%20.5-.42%201.14-.72%201.1-1.38%201.1-.38%200-1.08-.44-.36-.34-1.04-.34-.66%200-1.24.48-.58.48-.58%201.34z%22%20fill%3D%22green%22/%3E%3C/svg%3E"/>
        </a>
</div>
    </nav>
    <main class="pdoc">
            <section class="module-info">
                    <h1 class="modulename">
src<wbr>.cvxsimulator    </h1>

                
                        <input id="mod-cvxsimulator-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">

                        <label class="view-source-button" for="mod-cvxsimulator-view-source"><span>View Source</span></label>

                        <div class="pdoc-code codehilite"><pre><span></span><span id="L-1"><a href="#L-1"><span class="linenos"> 1</span></a><span class="kn">import</span><span class="w"> </span><span class="nn">importlib.metadata</span>
</span><span id="L-2"><a href="#L-2"><span class="linenos"> 2</span></a><span class="n">__version__</span> <span class="o">=</span> <span class="n">importlib</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">version</span><span class="p">(</span><span class="s2">&quot;cvxsimulator&quot;</span><span class="p">)</span>
</span><span id="L-3"><a href="#L-3"><span class="linenos"> 3</span></a>
</span><span id="L-4"><a href="#L-4"><span class="linenos"> 4</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">.builder</span><span class="w"> </span><span class="kn">import</span> <span class="n">Builder</span>
</span><span id="L-5"><a href="#L-5"><span class="linenos"> 5</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">.portfolio</span><span class="w"> </span><span class="kn">import</span> <span class="n">Portfolio</span>
</span><span id="L-6"><a href="#L-6"><span class="linenos"> 6</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">.state</span><span class="w"> </span><span class="kn">import</span> <span class="n">State</span>
</span><span id="L-7"><a href="#L-7"><span class="linenos"> 7</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">.utils.interpolation</span><span class="w"> </span><span class="kn">import</span> <span class="n">interpolate</span><span class="p">,</span> <span class="n">valid</span>
</span><span id="L-8"><a href="#L-8"><span class="linenos"> 8</span></a>
</span><span id="L-9"><a href="#L-9"><span class="linenos"> 9</span></a><span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="L-10"><a href="#L-10"><span class="linenos">10</span></a>    <span class="s2">&quot;Builder&quot;</span><span class="p">,</span>
</span><span id="L-11"><a href="#L-11"><span class="linenos">11</span></a>    <span class="s2">&quot;Portfolio&quot;</span><span class="p">,</span>
</span><span id="L-12"><a href="#L-12"><span class="linenos">12</span></a>    <span class="s2">&quot;State&quot;</span><span class="p">,</span>
</span><span id="L-13"><a href="#L-13"><span class="linenos">13</span></a>    <span class="s2">&quot;interpolate&quot;</span><span class="p">,</span>
</span><span id="L-14"><a href="#L-14"><span class="linenos">14</span></a>    <span class="s2">&quot;valid&quot;</span>
</span><span id="L-15"><a href="#L-15"><span class="linenos">15</span></a><span class="p">]</span>
</span></pre></div>


            </section>
                <section id="Builder">
                            <input id="Builder-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
                    <div class="decorator decorator-dataclass">@dataclass</div>

    <span class="def">class</span>
    <span class="name">Builder</span>:

                <label class="view-source-button" for="Builder-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Builder"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Builder-50"><a href="#Builder-50"><span class="linenos"> 50</span></a><span class="nd">@dataclass</span>
</span><span id="Builder-51"><a href="#Builder-51"><span class="linenos"> 51</span></a><span class="k">class</span><span class="w"> </span><span class="nc">Builder</span><span class="p">:</span>
</span><span id="Builder-52"><a href="#Builder-52"><span class="linenos"> 52</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;The Builder is an auxiliary class used to build portfolios.</span>
</span><span id="Builder-53"><a href="#Builder-53"><span class="linenos"> 53</span></a>
</span><span id="Builder-54"><a href="#Builder-54"><span class="linenos"> 54</span></a><span class="sd">    It overloads the __iter__ method to allow the class to iterate over</span>
</span><span id="Builder-55"><a href="#Builder-55"><span class="linenos"> 55</span></a><span class="sd">    the timestamps for which the portfolio data is available.</span>
</span><span id="Builder-56"><a href="#Builder-56"><span class="linenos"> 56</span></a>
</span><span id="Builder-57"><a href="#Builder-57"><span class="linenos"> 57</span></a><span class="sd">    In each iteration we can update the portfolio by setting either</span>
</span><span id="Builder-58"><a href="#Builder-58"><span class="linenos"> 58</span></a><span class="sd">    the weights, the position or the cash position.</span>
</span><span id="Builder-59"><a href="#Builder-59"><span class="linenos"> 59</span></a>
</span><span id="Builder-60"><a href="#Builder-60"><span class="linenos"> 60</span></a><span class="sd">    After the iteration has been completed we build a Portfolio object</span>
</span><span id="Builder-61"><a href="#Builder-61"><span class="linenos"> 61</span></a><span class="sd">    by calling the build method.</span>
</span><span id="Builder-62"><a href="#Builder-62"><span class="linenos"> 62</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Builder-63"><a href="#Builder-63"><span class="linenos"> 63</span></a>
</span><span id="Builder-64"><a href="#Builder-64"><span class="linenos"> 64</span></a>    <span class="n">prices</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span>
</span><span id="Builder-65"><a href="#Builder-65"><span class="linenos"> 65</span></a>
</span><span id="Builder-66"><a href="#Builder-66"><span class="linenos"> 66</span></a>    <span class="n">_state</span><span class="p">:</span> <span class="n">State</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Builder-67"><a href="#Builder-67"><span class="linenos"> 67</span></a>    <span class="n">_units</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Builder-68"><a href="#Builder-68"><span class="linenos"> 68</span></a>    <span class="n">_aum</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Builder-69"><a href="#Builder-69"><span class="linenos"> 69</span></a>    <span class="n">initial_aum</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1e6</span>
</span><span id="Builder-70"><a href="#Builder-70"><span class="linenos"> 70</span></a>
</span><span id="Builder-71"><a href="#Builder-71"><span class="linenos"> 71</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">__post_init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Builder-72"><a href="#Builder-72"><span class="linenos"> 72</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize the Builder instance after creation.</span>
</span><span id="Builder-73"><a href="#Builder-73"><span class="linenos"> 73</span></a>
</span><span id="Builder-74"><a href="#Builder-74"><span class="linenos"> 74</span></a><span class="sd">        This method is automatically called after the object is initialized.</span>
</span><span id="Builder-75"><a href="#Builder-75"><span class="linenos"> 75</span></a><span class="sd">        It sets up the internal state, creates empty DataFrames for units and AUM,</span>
</span><span id="Builder-76"><a href="#Builder-76"><span class="linenos"> 76</span></a><span class="sd">        and initializes the AUM with the provided initial_aum value.</span>
</span><span id="Builder-77"><a href="#Builder-77"><span class="linenos"> 77</span></a>
</span><span id="Builder-78"><a href="#Builder-78"><span class="linenos"> 78</span></a><span class="sd">        The method performs several validations on the prices DataFrame:</span>
</span><span id="Builder-79"><a href="#Builder-79"><span class="linenos"> 79</span></a><span class="sd">        - Checks that the index is monotonically increasing</span>
</span><span id="Builder-80"><a href="#Builder-80"><span class="linenos"> 80</span></a><span class="sd">        - Checks that the index has unique values</span>
</span><span id="Builder-81"><a href="#Builder-81"><span class="linenos"> 81</span></a>
</span><span id="Builder-82"><a href="#Builder-82"><span class="linenos"> 82</span></a><span class="sd">        Returns</span>
</span><span id="Builder-83"><a href="#Builder-83"><span class="linenos"> 83</span></a><span class="sd">        -------</span>
</span><span id="Builder-84"><a href="#Builder-84"><span class="linenos"> 84</span></a><span class="sd">        None</span>
</span><span id="Builder-85"><a href="#Builder-85"><span class="linenos"> 85</span></a>
</span><span id="Builder-86"><a href="#Builder-86"><span class="linenos"> 86</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Builder-87"><a href="#Builder-87"><span class="linenos"> 87</span></a>        <span class="c1"># assert isinstance(self.prices, pd.DataFrame)</span>
</span><span id="Builder-88"><a href="#Builder-88"><span class="linenos"> 88</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">prices</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">is_monotonic_increasing</span><span class="p">:</span>
</span><span id="Builder-89"><a href="#Builder-89"><span class="linenos"> 89</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Index must be monotonically increasing&quot;</span><span class="p">)</span>
</span><span id="Builder-90"><a href="#Builder-90"><span class="linenos"> 90</span></a>
</span><span id="Builder-91"><a href="#Builder-91"><span class="linenos"> 91</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">prices</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">is_unique</span><span class="p">:</span>
</span><span id="Builder-92"><a href="#Builder-92"><span class="linenos"> 92</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Index must have unique values&quot;</span><span class="p">)</span>
</span><span id="Builder-93"><a href="#Builder-93"><span class="linenos"> 93</span></a>
</span><span id="Builder-94"><a href="#Builder-94"><span class="linenos"> 94</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_state</span> <span class="o">=</span> <span class="n">State</span><span class="p">()</span>
</span><span id="Builder-95"><a href="#Builder-95"><span class="linenos"> 95</span></a>
</span><span id="Builder-96"><a href="#Builder-96"><span class="linenos"> 96</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_units</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
</span><span id="Builder-97"><a href="#Builder-97"><span class="linenos"> 97</span></a>            <span class="n">index</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">prices</span><span class="o">.</span><span class="n">index</span><span class="p">,</span>
</span><span id="Builder-98"><a href="#Builder-98"><span class="linenos"> 98</span></a>            <span class="n">columns</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">prices</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span>
</span><span id="Builder-99"><a href="#Builder-99"><span class="linenos"> 99</span></a>            <span class="n">data</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span>
</span><span id="Builder-100"><a href="#Builder-100"><span class="linenos">100</span></a>            <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">,</span>
</span><span id="Builder-101"><a href="#Builder-101"><span class="linenos">101</span></a>        <span class="p">)</span>
</span><span id="Builder-102"><a href="#Builder-102"><span class="linenos">102</span></a>
</span><span id="Builder-103"><a href="#Builder-103"><span class="linenos">103</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_aum</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">prices</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
</span><span id="Builder-104"><a href="#Builder-104"><span class="linenos">104</span></a>
</span><span id="Builder-105"><a href="#Builder-105"><span class="linenos">105</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_state</span><span class="o">.</span><span class="n">aum</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">initial_aum</span>
</span><span id="Builder-106"><a href="#Builder-106"><span class="linenos">106</span></a>
</span><span id="Builder-107"><a href="#Builder-107"><span class="linenos">107</span></a>    <span class="nd">@property</span>
</span><span id="Builder-108"><a href="#Builder-108"><span class="linenos">108</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">valid</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Builder-109"><a href="#Builder-109"><span class="linenos">109</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Check the validity of price data for each asset.</span>
</span><span id="Builder-110"><a href="#Builder-110"><span class="linenos">110</span></a>
</span><span id="Builder-111"><a href="#Builder-111"><span class="linenos">111</span></a><span class="sd">        This property analyzes each column of the prices DataFrame to determine</span>
</span><span id="Builder-112"><a href="#Builder-112"><span class="linenos">112</span></a><span class="sd">        if there are any missing values between the first and last valid data points.</span>
</span><span id="Builder-113"><a href="#Builder-113"><span class="linenos">113</span></a>
</span><span id="Builder-114"><a href="#Builder-114"><span class="linenos">114</span></a><span class="sd">        Returns</span>
</span><span id="Builder-115"><a href="#Builder-115"><span class="linenos">115</span></a><span class="sd">        -------</span>
</span><span id="Builder-116"><a href="#Builder-116"><span class="linenos">116</span></a><span class="sd">        pd.DataFrame</span>
</span><span id="Builder-117"><a href="#Builder-117"><span class="linenos">117</span></a><span class="sd">            A DataFrame with the same columns as prices, containing boolean values</span>
</span><span id="Builder-118"><a href="#Builder-118"><span class="linenos">118</span></a><span class="sd">            indicating whether each asset&#39;s price series is valid (True) or has</span>
</span><span id="Builder-119"><a href="#Builder-119"><span class="linenos">119</span></a><span class="sd">            missing values in the middle (False)</span>
</span><span id="Builder-120"><a href="#Builder-120"><span class="linenos">120</span></a>
</span><span id="Builder-121"><a href="#Builder-121"><span class="linenos">121</span></a><span class="sd">        Notes</span>
</span><span id="Builder-122"><a href="#Builder-122"><span class="linenos">122</span></a><span class="sd">        -----</span>
</span><span id="Builder-123"><a href="#Builder-123"><span class="linenos">123</span></a><span class="sd">        A valid price series can have missing values at the beginning or end,</span>
</span><span id="Builder-124"><a href="#Builder-124"><span class="linenos">124</span></a><span class="sd">        but not in the middle between the first and last valid data points.</span>
</span><span id="Builder-125"><a href="#Builder-125"><span class="linenos">125</span></a>
</span><span id="Builder-126"><a href="#Builder-126"><span class="linenos">126</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Builder-127"><a href="#Builder-127"><span class="linenos">127</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">prices</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">valid</span><span class="p">)</span>
</span><span id="Builder-128"><a href="#Builder-128"><span class="linenos">128</span></a>
</span><span id="Builder-129"><a href="#Builder-129"><span class="linenos">129</span></a>    <span class="nd">@property</span>
</span><span id="Builder-130"><a href="#Builder-130"><span class="linenos">130</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">intervals</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Builder-131"><a href="#Builder-131"><span class="linenos">131</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the first and last valid index for each asset&#39;s price series.</span>
</span><span id="Builder-132"><a href="#Builder-132"><span class="linenos">132</span></a>
</span><span id="Builder-133"><a href="#Builder-133"><span class="linenos">133</span></a><span class="sd">        This property identifies the time range for which each asset has valid price data.</span>
</span><span id="Builder-134"><a href="#Builder-134"><span class="linenos">134</span></a>
</span><span id="Builder-135"><a href="#Builder-135"><span class="linenos">135</span></a><span class="sd">        Returns</span>
</span><span id="Builder-136"><a href="#Builder-136"><span class="linenos">136</span></a><span class="sd">        -------</span>
</span><span id="Builder-137"><a href="#Builder-137"><span class="linenos">137</span></a><span class="sd">        pd.DataFrame</span>
</span><span id="Builder-138"><a href="#Builder-138"><span class="linenos">138</span></a><span class="sd">            A DataFrame with assets as rows and two columns:</span>
</span><span id="Builder-139"><a href="#Builder-139"><span class="linenos">139</span></a><span class="sd">            - &#39;first&#39;: The first valid index (timestamp) for each asset</span>
</span><span id="Builder-140"><a href="#Builder-140"><span class="linenos">140</span></a><span class="sd">            - &#39;last&#39;: The last valid index (timestamp) for each asset</span>
</span><span id="Builder-141"><a href="#Builder-141"><span class="linenos">141</span></a>
</span><span id="Builder-142"><a href="#Builder-142"><span class="linenos">142</span></a><span class="sd">        Notes</span>
</span><span id="Builder-143"><a href="#Builder-143"><span class="linenos">143</span></a><span class="sd">        -----</span>
</span><span id="Builder-144"><a href="#Builder-144"><span class="linenos">144</span></a><span class="sd">        This is useful for determining the valid trading period for each asset,</span>
</span><span id="Builder-145"><a href="#Builder-145"><span class="linenos">145</span></a><span class="sd">        especially when different assets have different data availability periods.</span>
</span><span id="Builder-146"><a href="#Builder-146"><span class="linenos">146</span></a>
</span><span id="Builder-147"><a href="#Builder-147"><span class="linenos">147</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Builder-148"><a href="#Builder-148"><span class="linenos">148</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">prices</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
</span><span id="Builder-149"><a href="#Builder-149"><span class="linenos">149</span></a>            <span class="k">lambda</span> <span class="n">ts</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">({</span><span class="s2">&quot;first&quot;</span><span class="p">:</span> <span class="n">ts</span><span class="o">.</span><span class="n">first_valid_index</span><span class="p">(),</span> <span class="s2">&quot;last&quot;</span><span class="p">:</span> <span class="n">ts</span><span class="o">.</span><span class="n">last_valid_index</span><span class="p">()})</span>
</span><span id="Builder-150"><a href="#Builder-150"><span class="linenos">150</span></a>        <span class="p">)</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
</span><span id="Builder-151"><a href="#Builder-151"><span class="linenos">151</span></a>
</span><span id="Builder-152"><a href="#Builder-152"><span class="linenos">152</span></a>    <span class="nd">@property</span>
</span><span id="Builder-153"><a href="#Builder-153"><span class="linenos">153</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">index</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DatetimeIndex</span><span class="p">:</span>
</span><span id="Builder-154"><a href="#Builder-154"><span class="linenos">154</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The index of the portfolio.</span>
</span><span id="Builder-155"><a href="#Builder-155"><span class="linenos">155</span></a>
</span><span id="Builder-156"><a href="#Builder-156"><span class="linenos">156</span></a><span class="sd">        Returns: pd.Index: A pandas index representing the</span>
</span><span id="Builder-157"><a href="#Builder-157"><span class="linenos">157</span></a><span class="sd">        time period for which the portfolio data is available.</span>
</span><span id="Builder-158"><a href="#Builder-158"><span class="linenos">158</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Builder-159"><a href="#Builder-159"><span class="linenos">159</span></a>        <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DatetimeIndex</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">prices</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
</span><span id="Builder-160"><a href="#Builder-160"><span class="linenos">160</span></a>
</span><span id="Builder-161"><a href="#Builder-161"><span class="linenos">161</span></a>    <span class="nd">@property</span>
</span><span id="Builder-162"><a href="#Builder-162"><span class="linenos">162</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">current_prices</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
</span><span id="Builder-163"><a href="#Builder-163"><span class="linenos">163</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the current prices for all assets in the portfolio.</span>
</span><span id="Builder-164"><a href="#Builder-164"><span class="linenos">164</span></a>
</span><span id="Builder-165"><a href="#Builder-165"><span class="linenos">165</span></a><span class="sd">        This property retrieves the current prices from the internal state</span>
</span><span id="Builder-166"><a href="#Builder-166"><span class="linenos">166</span></a><span class="sd">        for all assets that are currently in the portfolio.</span>
</span><span id="Builder-167"><a href="#Builder-167"><span class="linenos">167</span></a>
</span><span id="Builder-168"><a href="#Builder-168"><span class="linenos">168</span></a><span class="sd">        Returns</span>
</span><span id="Builder-169"><a href="#Builder-169"><span class="linenos">169</span></a><span class="sd">        -------</span>
</span><span id="Builder-170"><a href="#Builder-170"><span class="linenos">170</span></a><span class="sd">        np.array</span>
</span><span id="Builder-171"><a href="#Builder-171"><span class="linenos">171</span></a><span class="sd">            An array of current prices for all assets in the portfolio</span>
</span><span id="Builder-172"><a href="#Builder-172"><span class="linenos">172</span></a>
</span><span id="Builder-173"><a href="#Builder-173"><span class="linenos">173</span></a><span class="sd">        Notes</span>
</span><span id="Builder-174"><a href="#Builder-174"><span class="linenos">174</span></a><span class="sd">        -----</span>
</span><span id="Builder-175"><a href="#Builder-175"><span class="linenos">175</span></a><span class="sd">        The prices are retrieved from the internal state, which is updated</span>
</span><span id="Builder-176"><a href="#Builder-176"><span class="linenos">176</span></a><span class="sd">        during iteration through the portfolio&#39;s time index.</span>
</span><span id="Builder-177"><a href="#Builder-177"><span class="linenos">177</span></a>
</span><span id="Builder-178"><a href="#Builder-178"><span class="linenos">178</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Builder-179"><a href="#Builder-179"><span class="linenos">179</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_state</span><span class="o">.</span><span class="n">prices</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_state</span><span class="o">.</span><span class="n">assets</span><span class="p">]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
</span><span id="Builder-180"><a href="#Builder-180"><span class="linenos">180</span></a>
</span><span id="Builder-181"><a href="#Builder-181"><span class="linenos">181</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Generator</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DatetimeIndex</span><span class="p">,</span> <span class="n">State</span><span class="p">]]:</span>
</span><span id="Builder-182"><a href="#Builder-182"><span class="linenos">182</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Iterate over object in a for loop.</span>
</span><span id="Builder-183"><a href="#Builder-183"><span class="linenos">183</span></a>
</span><span id="Builder-184"><a href="#Builder-184"><span class="linenos">184</span></a><span class="sd">        The method yields a list of dates seen so far and returns a tuple</span>
</span><span id="Builder-185"><a href="#Builder-185"><span class="linenos">185</span></a><span class="sd">        containing the list of dates and the current portfolio state.</span>
</span><span id="Builder-186"><a href="#Builder-186"><span class="linenos">186</span></a>
</span><span id="Builder-187"><a href="#Builder-187"><span class="linenos">187</span></a><span class="sd">        Yield:</span>
</span><span id="Builder-188"><a href="#Builder-188"><span class="linenos">188</span></a><span class="sd">        time: a pandas DatetimeIndex object containing the dates seen so far.</span>
</span><span id="Builder-189"><a href="#Builder-189"><span class="linenos">189</span></a><span class="sd">        state: the current state of the portfolio,</span>
</span><span id="Builder-190"><a href="#Builder-190"><span class="linenos">190</span></a>
</span><span id="Builder-191"><a href="#Builder-191"><span class="linenos">191</span></a><span class="sd">        taking into account the stock prices at each interval.</span>
</span><span id="Builder-192"><a href="#Builder-192"><span class="linenos">192</span></a>
</span><span id="Builder-193"><a href="#Builder-193"><span class="linenos">193</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Builder-194"><a href="#Builder-194"><span class="linenos">194</span></a>        <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">:</span>
</span><span id="Builder-195"><a href="#Builder-195"><span class="linenos">195</span></a>            <span class="c1"># update the current prices for the portfolio</span>
</span><span id="Builder-196"><a href="#Builder-196"><span class="linenos">196</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_state</span><span class="o">.</span><span class="n">prices</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">prices</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">t</span><span class="p">]</span>
</span><span id="Builder-197"><a href="#Builder-197"><span class="linenos">197</span></a>
</span><span id="Builder-198"><a href="#Builder-198"><span class="linenos">198</span></a>            <span class="c1"># update the current time for the state</span>
</span><span id="Builder-199"><a href="#Builder-199"><span class="linenos">199</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_state</span><span class="o">.</span><span class="n">time</span> <span class="o">=</span> <span class="n">t</span>
</span><span id="Builder-200"><a href="#Builder-200"><span class="linenos">200</span></a>
</span><span id="Builder-201"><a href="#Builder-201"><span class="linenos">201</span></a>            <span class="c1"># yield the vector of times seen so far and the current state</span>
</span><span id="Builder-202"><a href="#Builder-202"><span class="linenos">202</span></a>            <span class="k">yield</span> <span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">index</span> <span class="o">&lt;=</span> <span class="n">t</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">_state</span>
</span><span id="Builder-203"><a href="#Builder-203"><span class="linenos">203</span></a>
</span><span id="Builder-204"><a href="#Builder-204"><span class="linenos">204</span></a>    <span class="nd">@property</span>
</span><span id="Builder-205"><a href="#Builder-205"><span class="linenos">205</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">position</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">:</span>
</span><span id="Builder-206"><a href="#Builder-206"><span class="linenos">206</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The position property returns the current position of the portfolio.</span>
</span><span id="Builder-207"><a href="#Builder-207"><span class="linenos">207</span></a>
</span><span id="Builder-208"><a href="#Builder-208"><span class="linenos">208</span></a><span class="sd">        It returns a pandas Series object containing the current position of the portfolio.</span>
</span><span id="Builder-209"><a href="#Builder-209"><span class="linenos">209</span></a>
</span><span id="Builder-210"><a href="#Builder-210"><span class="linenos">210</span></a><span class="sd">        Returns: pd.Series: a pandas Series object containing the current position of the portfolio.</span>
</span><span id="Builder-211"><a href="#Builder-211"><span class="linenos">211</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Builder-212"><a href="#Builder-212"><span class="linenos">212</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_units</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_state</span><span class="o">.</span><span class="n">time</span><span class="p">]</span>
</span><span id="Builder-213"><a href="#Builder-213"><span class="linenos">213</span></a>
</span><span id="Builder-214"><a href="#Builder-214"><span class="linenos">214</span></a>    <span class="nd">@position</span><span class="o">.</span><span class="n">setter</span>
</span><span id="Builder-215"><a href="#Builder-215"><span class="linenos">215</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">position</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">position</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Builder-216"><a href="#Builder-216"><span class="linenos">216</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Set the current position of the portfolio.</span>
</span><span id="Builder-217"><a href="#Builder-217"><span class="linenos">217</span></a>
</span><span id="Builder-218"><a href="#Builder-218"><span class="linenos">218</span></a><span class="sd">        This setter updates the position (number of units) for each asset in the portfolio</span>
</span><span id="Builder-219"><a href="#Builder-219"><span class="linenos">219</span></a><span class="sd">        at the current time point. It also updates the internal state&#39;s position.</span>
</span><span id="Builder-220"><a href="#Builder-220"><span class="linenos">220</span></a>
</span><span id="Builder-221"><a href="#Builder-221"><span class="linenos">221</span></a><span class="sd">        Parameters</span>
</span><span id="Builder-222"><a href="#Builder-222"><span class="linenos">222</span></a><span class="sd">        ----------</span>
</span><span id="Builder-223"><a href="#Builder-223"><span class="linenos">223</span></a><span class="sd">        position : pd.Series</span>
</span><span id="Builder-224"><a href="#Builder-224"><span class="linenos">224</span></a><span class="sd">            A pandas Series containing the new position (number of units) for each asset</span>
</span><span id="Builder-225"><a href="#Builder-225"><span class="linenos">225</span></a>
</span><span id="Builder-226"><a href="#Builder-226"><span class="linenos">226</span></a><span class="sd">        Returns</span>
</span><span id="Builder-227"><a href="#Builder-227"><span class="linenos">227</span></a><span class="sd">        -------</span>
</span><span id="Builder-228"><a href="#Builder-228"><span class="linenos">228</span></a><span class="sd">        None</span>
</span><span id="Builder-229"><a href="#Builder-229"><span class="linenos">229</span></a>
</span><span id="Builder-230"><a href="#Builder-230"><span class="linenos">230</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Builder-231"><a href="#Builder-231"><span class="linenos">231</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_units</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_state</span><span class="o">.</span><span class="n">time</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_state</span><span class="o">.</span><span class="n">assets</span><span class="p">]</span> <span class="o">=</span> <span class="n">position</span>
</span><span id="Builder-232"><a href="#Builder-232"><span class="linenos">232</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_state</span><span class="o">.</span><span class="n">position</span> <span class="o">=</span> <span class="n">position</span>
</span><span id="Builder-233"><a href="#Builder-233"><span class="linenos">233</span></a>
</span><span id="Builder-234"><a href="#Builder-234"><span class="linenos">234</span></a>    <span class="nd">@property</span>
</span><span id="Builder-235"><a href="#Builder-235"><span class="linenos">235</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">cashposition</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Builder-236"><a href="#Builder-236"><span class="linenos">236</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the current cash value of each position in the portfolio.</span>
</span><span id="Builder-237"><a href="#Builder-237"><span class="linenos">237</span></a>
</span><span id="Builder-238"><a href="#Builder-238"><span class="linenos">238</span></a><span class="sd">        This property calculates the cash value of each position by multiplying</span>
</span><span id="Builder-239"><a href="#Builder-239"><span class="linenos">239</span></a><span class="sd">        the number of units by the current price for each asset.</span>
</span><span id="Builder-240"><a href="#Builder-240"><span class="linenos">240</span></a>
</span><span id="Builder-241"><a href="#Builder-241"><span class="linenos">241</span></a><span class="sd">        Returns</span>
</span><span id="Builder-242"><a href="#Builder-242"><span class="linenos">242</span></a><span class="sd">        -------</span>
</span><span id="Builder-243"><a href="#Builder-243"><span class="linenos">243</span></a><span class="sd">        pd.Series</span>
</span><span id="Builder-244"><a href="#Builder-244"><span class="linenos">244</span></a><span class="sd">            A pandas Series containing the cash value of each position,</span>
</span><span id="Builder-245"><a href="#Builder-245"><span class="linenos">245</span></a><span class="sd">            indexed by asset</span>
</span><span id="Builder-246"><a href="#Builder-246"><span class="linenos">246</span></a>
</span><span id="Builder-247"><a href="#Builder-247"><span class="linenos">247</span></a><span class="sd">        Notes</span>
</span><span id="Builder-248"><a href="#Builder-248"><span class="linenos">248</span></a><span class="sd">        -----</span>
</span><span id="Builder-249"><a href="#Builder-249"><span class="linenos">249</span></a><span class="sd">        This is different from the &#39;cash&#39; property, which represents</span>
</span><span id="Builder-250"><a href="#Builder-250"><span class="linenos">250</span></a><span class="sd">        uninvested money. This property represents the market value</span>
</span><span id="Builder-251"><a href="#Builder-251"><span class="linenos">251</span></a><span class="sd">        of each invested position.</span>
</span><span id="Builder-252"><a href="#Builder-252"><span class="linenos">252</span></a>
</span><span id="Builder-253"><a href="#Builder-253"><span class="linenos">253</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Builder-254"><a href="#Builder-254"><span class="linenos">254</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">position</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_prices</span>
</span><span id="Builder-255"><a href="#Builder-255"><span class="linenos">255</span></a>
</span><span id="Builder-256"><a href="#Builder-256"><span class="linenos">256</span></a>    <span class="nd">@property</span>
</span><span id="Builder-257"><a href="#Builder-257"><span class="linenos">257</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">units</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Builder-258"><a href="#Builder-258"><span class="linenos">258</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the complete history of portfolio holdings.</span>
</span><span id="Builder-259"><a href="#Builder-259"><span class="linenos">259</span></a>
</span><span id="Builder-260"><a href="#Builder-260"><span class="linenos">260</span></a><span class="sd">        This property returns the entire DataFrame of holdings (units) for all</span>
</span><span id="Builder-261"><a href="#Builder-261"><span class="linenos">261</span></a><span class="sd">        assets over all time points in the portfolio.</span>
</span><span id="Builder-262"><a href="#Builder-262"><span class="linenos">262</span></a>
</span><span id="Builder-263"><a href="#Builder-263"><span class="linenos">263</span></a><span class="sd">        Returns</span>
</span><span id="Builder-264"><a href="#Builder-264"><span class="linenos">264</span></a><span class="sd">        -------</span>
</span><span id="Builder-265"><a href="#Builder-265"><span class="linenos">265</span></a><span class="sd">        pd.DataFrame</span>
</span><span id="Builder-266"><a href="#Builder-266"><span class="linenos">266</span></a><span class="sd">            A DataFrame containing the number of units held for each asset over time,</span>
</span><span id="Builder-267"><a href="#Builder-267"><span class="linenos">267</span></a><span class="sd">            with dates as index and assets as columns</span>
</span><span id="Builder-268"><a href="#Builder-268"><span class="linenos">268</span></a>
</span><span id="Builder-269"><a href="#Builder-269"><span class="linenos">269</span></a><span class="sd">        Notes</span>
</span><span id="Builder-270"><a href="#Builder-270"><span class="linenos">270</span></a><span class="sd">        -----</span>
</span><span id="Builder-271"><a href="#Builder-271"><span class="linenos">271</span></a><span class="sd">        This property is particularly useful for testing and for building</span>
</span><span id="Builder-272"><a href="#Builder-272"><span class="linenos">272</span></a><span class="sd">        the final Portfolio object via the build() method.</span>
</span><span id="Builder-273"><a href="#Builder-273"><span class="linenos">273</span></a>
</span><span id="Builder-274"><a href="#Builder-274"><span class="linenos">274</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Builder-275"><a href="#Builder-275"><span class="linenos">275</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_units</span>
</span><span id="Builder-276"><a href="#Builder-276"><span class="linenos">276</span></a>
</span><span id="Builder-277"><a href="#Builder-277"><span class="linenos">277</span></a>    <span class="nd">@cashposition</span><span class="o">.</span><span class="n">setter</span>
</span><span id="Builder-278"><a href="#Builder-278"><span class="linenos">278</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">cashposition</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cashposition</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Builder-279"><a href="#Builder-279"><span class="linenos">279</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Set the current cash value of each position in the portfolio.</span>
</span><span id="Builder-280"><a href="#Builder-280"><span class="linenos">280</span></a>
</span><span id="Builder-281"><a href="#Builder-281"><span class="linenos">281</span></a><span class="sd">        This setter updates the cash value of each position and automatically</span>
</span><span id="Builder-282"><a href="#Builder-282"><span class="linenos">282</span></a><span class="sd">        converts the cash values to positions (units) using the current prices.</span>
</span><span id="Builder-283"><a href="#Builder-283"><span class="linenos">283</span></a>
</span><span id="Builder-284"><a href="#Builder-284"><span class="linenos">284</span></a><span class="sd">        Parameters</span>
</span><span id="Builder-285"><a href="#Builder-285"><span class="linenos">285</span></a><span class="sd">        ----------</span>
</span><span id="Builder-286"><a href="#Builder-286"><span class="linenos">286</span></a><span class="sd">        cashposition : pd.Series</span>
</span><span id="Builder-287"><a href="#Builder-287"><span class="linenos">287</span></a><span class="sd">            A pandas Series containing the new cash value for each position,</span>
</span><span id="Builder-288"><a href="#Builder-288"><span class="linenos">288</span></a><span class="sd">            indexed by asset</span>
</span><span id="Builder-289"><a href="#Builder-289"><span class="linenos">289</span></a>
</span><span id="Builder-290"><a href="#Builder-290"><span class="linenos">290</span></a><span class="sd">        Returns</span>
</span><span id="Builder-291"><a href="#Builder-291"><span class="linenos">291</span></a><span class="sd">        -------</span>
</span><span id="Builder-292"><a href="#Builder-292"><span class="linenos">292</span></a><span class="sd">        None</span>
</span><span id="Builder-293"><a href="#Builder-293"><span class="linenos">293</span></a>
</span><span id="Builder-294"><a href="#Builder-294"><span class="linenos">294</span></a><span class="sd">        Notes</span>
</span><span id="Builder-295"><a href="#Builder-295"><span class="linenos">295</span></a><span class="sd">        -----</span>
</span><span id="Builder-296"><a href="#Builder-296"><span class="linenos">296</span></a><span class="sd">        This is a convenient way to specify positions in terms of currency</span>
</span><span id="Builder-297"><a href="#Builder-297"><span class="linenos">297</span></a><span class="sd">        amounts rather than number of units. The conversion formula is:</span>
</span><span id="Builder-298"><a href="#Builder-298"><span class="linenos">298</span></a><span class="sd">        position = cashposition / prices</span>
</span><span id="Builder-299"><a href="#Builder-299"><span class="linenos">299</span></a>
</span><span id="Builder-300"><a href="#Builder-300"><span class="linenos">300</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Builder-301"><a href="#Builder-301"><span class="linenos">301</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">position</span> <span class="o">=</span> <span class="n">cashposition</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_prices</span>
</span><span id="Builder-302"><a href="#Builder-302"><span class="linenos">302</span></a>
</span><span id="Builder-303"><a href="#Builder-303"><span class="linenos">303</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">build</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Builder-304"><a href="#Builder-304"><span class="linenos">304</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a new Portfolio instance from the current builder state.</span>
</span><span id="Builder-305"><a href="#Builder-305"><span class="linenos">305</span></a>
</span><span id="Builder-306"><a href="#Builder-306"><span class="linenos">306</span></a><span class="sd">        This method creates a new immutable Portfolio object based on the</span>
</span><span id="Builder-307"><a href="#Builder-307"><span class="linenos">307</span></a><span class="sd">        current state of the Builder, which can be used for analysis and reporting.</span>
</span><span id="Builder-308"><a href="#Builder-308"><span class="linenos">308</span></a>
</span><span id="Builder-309"><a href="#Builder-309"><span class="linenos">309</span></a><span class="sd">        Returns</span>
</span><span id="Builder-310"><a href="#Builder-310"><span class="linenos">310</span></a><span class="sd">        -------</span>
</span><span id="Builder-311"><a href="#Builder-311"><span class="linenos">311</span></a><span class="sd">        Portfolio</span>
</span><span id="Builder-312"><a href="#Builder-312"><span class="linenos">312</span></a><span class="sd">            A new instance of the Portfolio class with the attributes</span>
</span><span id="Builder-313"><a href="#Builder-313"><span class="linenos">313</span></a><span class="sd">            (prices, units, aum) as specified in the Builder</span>
</span><span id="Builder-314"><a href="#Builder-314"><span class="linenos">314</span></a>
</span><span id="Builder-315"><a href="#Builder-315"><span class="linenos">315</span></a><span class="sd">        Notes</span>
</span><span id="Builder-316"><a href="#Builder-316"><span class="linenos">316</span></a><span class="sd">        -----</span>
</span><span id="Builder-317"><a href="#Builder-317"><span class="linenos">317</span></a><span class="sd">        The resulting Portfolio object will be immutable (frozen) and will</span>
</span><span id="Builder-318"><a href="#Builder-318"><span class="linenos">318</span></a><span class="sd">        have the same data as the Builder from which it was built, but</span>
</span><span id="Builder-319"><a href="#Builder-319"><span class="linenos">319</span></a><span class="sd">        with a different interface focused on analysis rather than construction.</span>
</span><span id="Builder-320"><a href="#Builder-320"><span class="linenos">320</span></a>
</span><span id="Builder-321"><a href="#Builder-321"><span class="linenos">321</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Builder-322"><a href="#Builder-322"><span class="linenos">322</span></a>        <span class="k">return</span> <span class="n">Portfolio</span><span class="p">(</span><span class="n">prices</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">prices</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">units</span><span class="p">,</span> <span class="n">aum</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">aum</span><span class="p">)</span>
</span><span id="Builder-323"><a href="#Builder-323"><span class="linenos">323</span></a>
</span><span id="Builder-324"><a href="#Builder-324"><span class="linenos">324</span></a>    <span class="nd">@property</span>
</span><span id="Builder-325"><a href="#Builder-325"><span class="linenos">325</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">weights</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
</span><span id="Builder-326"><a href="#Builder-326"><span class="linenos">326</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the current portfolio weights for each asset.</span>
</span><span id="Builder-327"><a href="#Builder-327"><span class="linenos">327</span></a>
</span><span id="Builder-328"><a href="#Builder-328"><span class="linenos">328</span></a><span class="sd">        This property retrieves the weight of each asset in the portfolio</span>
</span><span id="Builder-329"><a href="#Builder-329"><span class="linenos">329</span></a><span class="sd">        from the internal state. Weights represent the proportion of the</span>
</span><span id="Builder-330"><a href="#Builder-330"><span class="linenos">330</span></a><span class="sd">        portfolio&#39;s value invested in each asset.</span>
</span><span id="Builder-331"><a href="#Builder-331"><span class="linenos">331</span></a>
</span><span id="Builder-332"><a href="#Builder-332"><span class="linenos">332</span></a><span class="sd">        Returns</span>
</span><span id="Builder-333"><a href="#Builder-333"><span class="linenos">333</span></a><span class="sd">        -------</span>
</span><span id="Builder-334"><a href="#Builder-334"><span class="linenos">334</span></a><span class="sd">        np.array</span>
</span><span id="Builder-335"><a href="#Builder-335"><span class="linenos">335</span></a><span class="sd">            An array of weights for each asset in the portfolio</span>
</span><span id="Builder-336"><a href="#Builder-336"><span class="linenos">336</span></a>
</span><span id="Builder-337"><a href="#Builder-337"><span class="linenos">337</span></a><span class="sd">        Notes</span>
</span><span id="Builder-338"><a href="#Builder-338"><span class="linenos">338</span></a><span class="sd">        -----</span>
</span><span id="Builder-339"><a href="#Builder-339"><span class="linenos">339</span></a><span class="sd">        Weights sum to 1.0 for a fully invested portfolio with no leverage.</span>
</span><span id="Builder-340"><a href="#Builder-340"><span class="linenos">340</span></a><span class="sd">        Negative weights represent short positions.</span>
</span><span id="Builder-341"><a href="#Builder-341"><span class="linenos">341</span></a>
</span><span id="Builder-342"><a href="#Builder-342"><span class="linenos">342</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Builder-343"><a href="#Builder-343"><span class="linenos">343</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_state</span><span class="o">.</span><span class="n">weights</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_state</span><span class="o">.</span><span class="n">assets</span><span class="p">]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
</span><span id="Builder-344"><a href="#Builder-344"><span class="linenos">344</span></a>
</span><span id="Builder-345"><a href="#Builder-345"><span class="linenos">345</span></a>    <span class="nd">@weights</span><span class="o">.</span><span class="n">setter</span>
</span><span id="Builder-346"><a href="#Builder-346"><span class="linenos">346</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">weights</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">weights</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Builder-347"><a href="#Builder-347"><span class="linenos">347</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Set the current portfolio weights for each asset.</span>
</span><span id="Builder-348"><a href="#Builder-348"><span class="linenos">348</span></a>
</span><span id="Builder-349"><a href="#Builder-349"><span class="linenos">349</span></a><span class="sd">        This setter updates the portfolio weights and automatically converts</span>
</span><span id="Builder-350"><a href="#Builder-350"><span class="linenos">350</span></a><span class="sd">        the weights to positions (units) using the current prices and NAV.</span>
</span><span id="Builder-351"><a href="#Builder-351"><span class="linenos">351</span></a>
</span><span id="Builder-352"><a href="#Builder-352"><span class="linenos">352</span></a><span class="sd">        Parameters</span>
</span><span id="Builder-353"><a href="#Builder-353"><span class="linenos">353</span></a><span class="sd">        ----------</span>
</span><span id="Builder-354"><a href="#Builder-354"><span class="linenos">354</span></a><span class="sd">        weights : np.array</span>
</span><span id="Builder-355"><a href="#Builder-355"><span class="linenos">355</span></a><span class="sd">            An array of weights for each asset in the portfolio</span>
</span><span id="Builder-356"><a href="#Builder-356"><span class="linenos">356</span></a>
</span><span id="Builder-357"><a href="#Builder-357"><span class="linenos">357</span></a><span class="sd">        Returns</span>
</span><span id="Builder-358"><a href="#Builder-358"><span class="linenos">358</span></a><span class="sd">        -------</span>
</span><span id="Builder-359"><a href="#Builder-359"><span class="linenos">359</span></a><span class="sd">        None</span>
</span><span id="Builder-360"><a href="#Builder-360"><span class="linenos">360</span></a>
</span><span id="Builder-361"><a href="#Builder-361"><span class="linenos">361</span></a><span class="sd">        Notes</span>
</span><span id="Builder-362"><a href="#Builder-362"><span class="linenos">362</span></a><span class="sd">        -----</span>
</span><span id="Builder-363"><a href="#Builder-363"><span class="linenos">363</span></a><span class="sd">        This is a convenient way to rebalance the portfolio by specifying</span>
</span><span id="Builder-364"><a href="#Builder-364"><span class="linenos">364</span></a><span class="sd">        the desired allocation as weights rather than exact positions.</span>
</span><span id="Builder-365"><a href="#Builder-365"><span class="linenos">365</span></a><span class="sd">        The conversion formula is: position = NAV * weights / prices</span>
</span><span id="Builder-366"><a href="#Builder-366"><span class="linenos">366</span></a>
</span><span id="Builder-367"><a href="#Builder-367"><span class="linenos">367</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Builder-368"><a href="#Builder-368"><span class="linenos">368</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">position</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_state</span><span class="o">.</span><span class="n">nav</span> <span class="o">*</span> <span class="n">weights</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_prices</span>
</span><span id="Builder-369"><a href="#Builder-369"><span class="linenos">369</span></a>
</span><span id="Builder-370"><a href="#Builder-370"><span class="linenos">370</span></a>    <span class="nd">@property</span>
</span><span id="Builder-371"><a href="#Builder-371"><span class="linenos">371</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">aum</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Builder-372"><a href="#Builder-372"><span class="linenos">372</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the assets under management (AUM) history of the portfolio.</span>
</span><span id="Builder-373"><a href="#Builder-373"><span class="linenos">373</span></a>
</span><span id="Builder-374"><a href="#Builder-374"><span class="linenos">374</span></a><span class="sd">        This property returns the entire series of AUM values over time,</span>
</span><span id="Builder-375"><a href="#Builder-375"><span class="linenos">375</span></a><span class="sd">        representing the total value of the portfolio at each time point.</span>
</span><span id="Builder-376"><a href="#Builder-376"><span class="linenos">376</span></a>
</span><span id="Builder-377"><a href="#Builder-377"><span class="linenos">377</span></a><span class="sd">        Returns</span>
</span><span id="Builder-378"><a href="#Builder-378"><span class="linenos">378</span></a><span class="sd">        -------</span>
</span><span id="Builder-379"><a href="#Builder-379"><span class="linenos">379</span></a><span class="sd">        pd.Series</span>
</span><span id="Builder-380"><a href="#Builder-380"><span class="linenos">380</span></a><span class="sd">            A Series containing the AUM values over time, with dates as index</span>
</span><span id="Builder-381"><a href="#Builder-381"><span class="linenos">381</span></a>
</span><span id="Builder-382"><a href="#Builder-382"><span class="linenos">382</span></a><span class="sd">        Notes</span>
</span><span id="Builder-383"><a href="#Builder-383"><span class="linenos">383</span></a><span class="sd">        -----</span>
</span><span id="Builder-384"><a href="#Builder-384"><span class="linenos">384</span></a><span class="sd">        AUM (assets under management) represents the total value of the portfolio,</span>
</span><span id="Builder-385"><a href="#Builder-385"><span class="linenos">385</span></a><span class="sd">        including both invested positions and uninvested cash.</span>
</span><span id="Builder-386"><a href="#Builder-386"><span class="linenos">386</span></a>
</span><span id="Builder-387"><a href="#Builder-387"><span class="linenos">387</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Builder-388"><a href="#Builder-388"><span class="linenos">388</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_aum</span>
</span><span id="Builder-389"><a href="#Builder-389"><span class="linenos">389</span></a>
</span><span id="Builder-390"><a href="#Builder-390"><span class="linenos">390</span></a>    <span class="nd">@aum</span><span class="o">.</span><span class="n">setter</span>
</span><span id="Builder-391"><a href="#Builder-391"><span class="linenos">391</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">aum</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">aum</span><span class="p">):</span>
</span><span id="Builder-392"><a href="#Builder-392"><span class="linenos">392</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Set the current assets under management (AUM) of the portfolio.</span>
</span><span id="Builder-393"><a href="#Builder-393"><span class="linenos">393</span></a>
</span><span id="Builder-394"><a href="#Builder-394"><span class="linenos">394</span></a><span class="sd">        This setter updates the AUM value at the current time point and</span>
</span><span id="Builder-395"><a href="#Builder-395"><span class="linenos">395</span></a><span class="sd">        also updates the internal state&#39;s AUM.</span>
</span><span id="Builder-396"><a href="#Builder-396"><span class="linenos">396</span></a>
</span><span id="Builder-397"><a href="#Builder-397"><span class="linenos">397</span></a><span class="sd">        Parameters</span>
</span><span id="Builder-398"><a href="#Builder-398"><span class="linenos">398</span></a><span class="sd">        ----------</span>
</span><span id="Builder-399"><a href="#Builder-399"><span class="linenos">399</span></a><span class="sd">        aum : float</span>
</span><span id="Builder-400"><a href="#Builder-400"><span class="linenos">400</span></a><span class="sd">            The new AUM value to set</span>
</span><span id="Builder-401"><a href="#Builder-401"><span class="linenos">401</span></a>
</span><span id="Builder-402"><a href="#Builder-402"><span class="linenos">402</span></a><span class="sd">        Returns</span>
</span><span id="Builder-403"><a href="#Builder-403"><span class="linenos">403</span></a><span class="sd">        -------</span>
</span><span id="Builder-404"><a href="#Builder-404"><span class="linenos">404</span></a><span class="sd">        None</span>
</span><span id="Builder-405"><a href="#Builder-405"><span class="linenos">405</span></a>
</span><span id="Builder-406"><a href="#Builder-406"><span class="linenos">406</span></a><span class="sd">        Notes</span>
</span><span id="Builder-407"><a href="#Builder-407"><span class="linenos">407</span></a><span class="sd">        -----</span>
</span><span id="Builder-408"><a href="#Builder-408"><span class="linenos">408</span></a><span class="sd">        Changing the AUM affects the portfolio&#39;s ability to take positions,</span>
</span><span id="Builder-409"><a href="#Builder-409"><span class="linenos">409</span></a><span class="sd">        as position sizes are often calculated as a fraction of AUM.</span>
</span><span id="Builder-410"><a href="#Builder-410"><span class="linenos">410</span></a>
</span><span id="Builder-411"><a href="#Builder-411"><span class="linenos">411</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Builder-412"><a href="#Builder-412"><span class="linenos">412</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_aum</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_state</span><span class="o">.</span><span class="n">time</span><span class="p">]</span> <span class="o">=</span> <span class="n">aum</span>
</span><span id="Builder-413"><a href="#Builder-413"><span class="linenos">413</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_state</span><span class="o">.</span><span class="n">aum</span> <span class="o">=</span> <span class="n">aum</span>
</span></pre></div>


            <div class="docstring"><p>The Builder is an auxiliary class used to build portfolios.</p>

<p>It overloads the __iter__ method to allow the class to iterate over
the timestamps for which the portfolio data is available.</p>

<p>In each iteration we can update the portfolio by setting either
the weights, the position or the cash position.</p>

<p>After the iteration has been completed we build a Portfolio object
by calling the build method.</p>
</div>


                            <div id="Builder.__init__" class="classattr">
                                <div class="attr function">
            
        <span class="name">Builder</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">prices</span><span class="p">:</span> <span class="n">pandas</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">DataFrame</span>,</span><span class="param">	<span class="n">_state</span><span class="p">:</span> <span class="n"><a href="#State">State</a></span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">_units</span><span class="p">:</span> <span class="n">pandas</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">_aum</span><span class="p">:</span> <span class="n">pandas</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">series</span><span class="o">.</span><span class="n">Series</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">initial_aum</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1000000.0</span></span>)</span>

        
    </div>
    <a class="headerlink" href="#Builder.__init__"></a>
    
    

                            </div>
                            <div id="Builder.prices" class="classattr">
                                <div class="attr variable">
            <span class="name">prices</span><span class="annotation">: pandas.core.frame.DataFrame</span>

        
    </div>
    <a class="headerlink" href="#Builder.prices"></a>
    
    

                            </div>
                            <div id="Builder.initial_aum" class="classattr">
                                <div class="attr variable">
            <span class="name">initial_aum</span><span class="annotation">: float</span>        =
<span class="default_value">1000000.0</span>

        
    </div>
    <a class="headerlink" href="#Builder.initial_aum"></a>
    
    

                            </div>
                            <div id="Builder.valid" class="classattr">
                                        <input id="Builder.valid-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">valid</span>

                <label class="view-source-button" for="Builder.valid-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Builder.valid"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Builder.valid-107"><a href="#Builder.valid-107"><span class="linenos">107</span></a>    <span class="nd">@property</span>
</span><span id="Builder.valid-108"><a href="#Builder.valid-108"><span class="linenos">108</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">valid</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Builder.valid-109"><a href="#Builder.valid-109"><span class="linenos">109</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Check the validity of price data for each asset.</span>
</span><span id="Builder.valid-110"><a href="#Builder.valid-110"><span class="linenos">110</span></a>
</span><span id="Builder.valid-111"><a href="#Builder.valid-111"><span class="linenos">111</span></a><span class="sd">        This property analyzes each column of the prices DataFrame to determine</span>
</span><span id="Builder.valid-112"><a href="#Builder.valid-112"><span class="linenos">112</span></a><span class="sd">        if there are any missing values between the first and last valid data points.</span>
</span><span id="Builder.valid-113"><a href="#Builder.valid-113"><span class="linenos">113</span></a>
</span><span id="Builder.valid-114"><a href="#Builder.valid-114"><span class="linenos">114</span></a><span class="sd">        Returns</span>
</span><span id="Builder.valid-115"><a href="#Builder.valid-115"><span class="linenos">115</span></a><span class="sd">        -------</span>
</span><span id="Builder.valid-116"><a href="#Builder.valid-116"><span class="linenos">116</span></a><span class="sd">        pd.DataFrame</span>
</span><span id="Builder.valid-117"><a href="#Builder.valid-117"><span class="linenos">117</span></a><span class="sd">            A DataFrame with the same columns as prices, containing boolean values</span>
</span><span id="Builder.valid-118"><a href="#Builder.valid-118"><span class="linenos">118</span></a><span class="sd">            indicating whether each asset&#39;s price series is valid (True) or has</span>
</span><span id="Builder.valid-119"><a href="#Builder.valid-119"><span class="linenos">119</span></a><span class="sd">            missing values in the middle (False)</span>
</span><span id="Builder.valid-120"><a href="#Builder.valid-120"><span class="linenos">120</span></a>
</span><span id="Builder.valid-121"><a href="#Builder.valid-121"><span class="linenos">121</span></a><span class="sd">        Notes</span>
</span><span id="Builder.valid-122"><a href="#Builder.valid-122"><span class="linenos">122</span></a><span class="sd">        -----</span>
</span><span id="Builder.valid-123"><a href="#Builder.valid-123"><span class="linenos">123</span></a><span class="sd">        A valid price series can have missing values at the beginning or end,</span>
</span><span id="Builder.valid-124"><a href="#Builder.valid-124"><span class="linenos">124</span></a><span class="sd">        but not in the middle between the first and last valid data points.</span>
</span><span id="Builder.valid-125"><a href="#Builder.valid-125"><span class="linenos">125</span></a>
</span><span id="Builder.valid-126"><a href="#Builder.valid-126"><span class="linenos">126</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Builder.valid-127"><a href="#Builder.valid-127"><span class="linenos">127</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">prices</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">valid</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Check the validity of price data for each asset.</p>

<p>This property analyzes each column of the prices DataFrame to determine
if there are any missing values between the first and last valid data points.</p>

<h2 id="returns">Returns</h2>

<p>pd.DataFrame
    A DataFrame with the same columns as prices, containing boolean values
    indicating whether each asset's price series is valid (True) or has
    missing values in the middle (False)</p>

<h2 id="notes">Notes</h2>

<p>A valid price series can have missing values at the beginning or end,
but not in the middle between the first and last valid data points.</p>
</div>


                            </div>
                            <div id="Builder.intervals" class="classattr">
                                        <input id="Builder.intervals-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">intervals</span>

                <label class="view-source-button" for="Builder.intervals-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Builder.intervals"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Builder.intervals-129"><a href="#Builder.intervals-129"><span class="linenos">129</span></a>    <span class="nd">@property</span>
</span><span id="Builder.intervals-130"><a href="#Builder.intervals-130"><span class="linenos">130</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">intervals</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Builder.intervals-131"><a href="#Builder.intervals-131"><span class="linenos">131</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the first and last valid index for each asset&#39;s price series.</span>
</span><span id="Builder.intervals-132"><a href="#Builder.intervals-132"><span class="linenos">132</span></a>
</span><span id="Builder.intervals-133"><a href="#Builder.intervals-133"><span class="linenos">133</span></a><span class="sd">        This property identifies the time range for which each asset has valid price data.</span>
</span><span id="Builder.intervals-134"><a href="#Builder.intervals-134"><span class="linenos">134</span></a>
</span><span id="Builder.intervals-135"><a href="#Builder.intervals-135"><span class="linenos">135</span></a><span class="sd">        Returns</span>
</span><span id="Builder.intervals-136"><a href="#Builder.intervals-136"><span class="linenos">136</span></a><span class="sd">        -------</span>
</span><span id="Builder.intervals-137"><a href="#Builder.intervals-137"><span class="linenos">137</span></a><span class="sd">        pd.DataFrame</span>
</span><span id="Builder.intervals-138"><a href="#Builder.intervals-138"><span class="linenos">138</span></a><span class="sd">            A DataFrame with assets as rows and two columns:</span>
</span><span id="Builder.intervals-139"><a href="#Builder.intervals-139"><span class="linenos">139</span></a><span class="sd">            - &#39;first&#39;: The first valid index (timestamp) for each asset</span>
</span><span id="Builder.intervals-140"><a href="#Builder.intervals-140"><span class="linenos">140</span></a><span class="sd">            - &#39;last&#39;: The last valid index (timestamp) for each asset</span>
</span><span id="Builder.intervals-141"><a href="#Builder.intervals-141"><span class="linenos">141</span></a>
</span><span id="Builder.intervals-142"><a href="#Builder.intervals-142"><span class="linenos">142</span></a><span class="sd">        Notes</span>
</span><span id="Builder.intervals-143"><a href="#Builder.intervals-143"><span class="linenos">143</span></a><span class="sd">        -----</span>
</span><span id="Builder.intervals-144"><a href="#Builder.intervals-144"><span class="linenos">144</span></a><span class="sd">        This is useful for determining the valid trading period for each asset,</span>
</span><span id="Builder.intervals-145"><a href="#Builder.intervals-145"><span class="linenos">145</span></a><span class="sd">        especially when different assets have different data availability periods.</span>
</span><span id="Builder.intervals-146"><a href="#Builder.intervals-146"><span class="linenos">146</span></a>
</span><span id="Builder.intervals-147"><a href="#Builder.intervals-147"><span class="linenos">147</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Builder.intervals-148"><a href="#Builder.intervals-148"><span class="linenos">148</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">prices</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
</span><span id="Builder.intervals-149"><a href="#Builder.intervals-149"><span class="linenos">149</span></a>            <span class="k">lambda</span> <span class="n">ts</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">({</span><span class="s2">&quot;first&quot;</span><span class="p">:</span> <span class="n">ts</span><span class="o">.</span><span class="n">first_valid_index</span><span class="p">(),</span> <span class="s2">&quot;last&quot;</span><span class="p">:</span> <span class="n">ts</span><span class="o">.</span><span class="n">last_valid_index</span><span class="p">()})</span>
</span><span id="Builder.intervals-150"><a href="#Builder.intervals-150"><span class="linenos">150</span></a>        <span class="p">)</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>Get the first and last valid index for each asset's price series.</p>

<p>This property identifies the time range for which each asset has valid price data.</p>

<h2 id="returns">Returns</h2>

<p>pd.DataFrame
    A DataFrame with assets as rows and two columns:
    - 'first': The first valid index (timestamp) for each asset
    - 'last': The last valid index (timestamp) for each asset</p>

<h2 id="notes">Notes</h2>

<p>This is useful for determining the valid trading period for each asset,
especially when different assets have different data availability periods.</p>
</div>


                            </div>
                            <div id="Builder.index" class="classattr">
                                        <input id="Builder.index-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">index</span><span class="annotation">: pandas.core.indexes.datetimes.DatetimeIndex</span>

                <label class="view-source-button" for="Builder.index-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Builder.index"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Builder.index-152"><a href="#Builder.index-152"><span class="linenos">152</span></a>    <span class="nd">@property</span>
</span><span id="Builder.index-153"><a href="#Builder.index-153"><span class="linenos">153</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">index</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DatetimeIndex</span><span class="p">:</span>
</span><span id="Builder.index-154"><a href="#Builder.index-154"><span class="linenos">154</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The index of the portfolio.</span>
</span><span id="Builder.index-155"><a href="#Builder.index-155"><span class="linenos">155</span></a>
</span><span id="Builder.index-156"><a href="#Builder.index-156"><span class="linenos">156</span></a><span class="sd">        Returns: pd.Index: A pandas index representing the</span>
</span><span id="Builder.index-157"><a href="#Builder.index-157"><span class="linenos">157</span></a><span class="sd">        time period for which the portfolio data is available.</span>
</span><span id="Builder.index-158"><a href="#Builder.index-158"><span class="linenos">158</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Builder.index-159"><a href="#Builder.index-159"><span class="linenos">159</span></a>        <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DatetimeIndex</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">prices</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>The index of the portfolio.</p>

<p>Returns: pd.Index: A pandas index representing the
time period for which the portfolio data is available.</p>
</div>


                            </div>
                            <div id="Builder.current_prices" class="classattr">
                                        <input id="Builder.current_prices-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">current_prices</span><span class="annotation">: numpy.ndarray</span>

                <label class="view-source-button" for="Builder.current_prices-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Builder.current_prices"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Builder.current_prices-161"><a href="#Builder.current_prices-161"><span class="linenos">161</span></a>    <span class="nd">@property</span>
</span><span id="Builder.current_prices-162"><a href="#Builder.current_prices-162"><span class="linenos">162</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">current_prices</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
</span><span id="Builder.current_prices-163"><a href="#Builder.current_prices-163"><span class="linenos">163</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the current prices for all assets in the portfolio.</span>
</span><span id="Builder.current_prices-164"><a href="#Builder.current_prices-164"><span class="linenos">164</span></a>
</span><span id="Builder.current_prices-165"><a href="#Builder.current_prices-165"><span class="linenos">165</span></a><span class="sd">        This property retrieves the current prices from the internal state</span>
</span><span id="Builder.current_prices-166"><a href="#Builder.current_prices-166"><span class="linenos">166</span></a><span class="sd">        for all assets that are currently in the portfolio.</span>
</span><span id="Builder.current_prices-167"><a href="#Builder.current_prices-167"><span class="linenos">167</span></a>
</span><span id="Builder.current_prices-168"><a href="#Builder.current_prices-168"><span class="linenos">168</span></a><span class="sd">        Returns</span>
</span><span id="Builder.current_prices-169"><a href="#Builder.current_prices-169"><span class="linenos">169</span></a><span class="sd">        -------</span>
</span><span id="Builder.current_prices-170"><a href="#Builder.current_prices-170"><span class="linenos">170</span></a><span class="sd">        np.array</span>
</span><span id="Builder.current_prices-171"><a href="#Builder.current_prices-171"><span class="linenos">171</span></a><span class="sd">            An array of current prices for all assets in the portfolio</span>
</span><span id="Builder.current_prices-172"><a href="#Builder.current_prices-172"><span class="linenos">172</span></a>
</span><span id="Builder.current_prices-173"><a href="#Builder.current_prices-173"><span class="linenos">173</span></a><span class="sd">        Notes</span>
</span><span id="Builder.current_prices-174"><a href="#Builder.current_prices-174"><span class="linenos">174</span></a><span class="sd">        -----</span>
</span><span id="Builder.current_prices-175"><a href="#Builder.current_prices-175"><span class="linenos">175</span></a><span class="sd">        The prices are retrieved from the internal state, which is updated</span>
</span><span id="Builder.current_prices-176"><a href="#Builder.current_prices-176"><span class="linenos">176</span></a><span class="sd">        during iteration through the portfolio&#39;s time index.</span>
</span><span id="Builder.current_prices-177"><a href="#Builder.current_prices-177"><span class="linenos">177</span></a>
</span><span id="Builder.current_prices-178"><a href="#Builder.current_prices-178"><span class="linenos">178</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Builder.current_prices-179"><a href="#Builder.current_prices-179"><span class="linenos">179</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_state</span><span class="o">.</span><span class="n">prices</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_state</span><span class="o">.</span><span class="n">assets</span><span class="p">]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>Get the current prices for all assets in the portfolio.</p>

<p>This property retrieves the current prices from the internal state
for all assets that are currently in the portfolio.</p>

<h2 id="returns">Returns</h2>

<p>np.array
    An array of current prices for all assets in the portfolio</p>

<h2 id="notes">Notes</h2>

<p>The prices are retrieved from the internal state, which is updated
during iteration through the portfolio's time index.</p>
</div>


                            </div>
                            <div id="Builder.position" class="classattr">
                                        <input id="Builder.position-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">position</span><span class="annotation">: pandas.core.series.Series</span>

                <label class="view-source-button" for="Builder.position-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Builder.position"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Builder.position-204"><a href="#Builder.position-204"><span class="linenos">204</span></a>    <span class="nd">@property</span>
</span><span id="Builder.position-205"><a href="#Builder.position-205"><span class="linenos">205</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">position</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">:</span>
</span><span id="Builder.position-206"><a href="#Builder.position-206"><span class="linenos">206</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The position property returns the current position of the portfolio.</span>
</span><span id="Builder.position-207"><a href="#Builder.position-207"><span class="linenos">207</span></a>
</span><span id="Builder.position-208"><a href="#Builder.position-208"><span class="linenos">208</span></a><span class="sd">        It returns a pandas Series object containing the current position of the portfolio.</span>
</span><span id="Builder.position-209"><a href="#Builder.position-209"><span class="linenos">209</span></a>
</span><span id="Builder.position-210"><a href="#Builder.position-210"><span class="linenos">210</span></a><span class="sd">        Returns: pd.Series: a pandas Series object containing the current position of the portfolio.</span>
</span><span id="Builder.position-211"><a href="#Builder.position-211"><span class="linenos">211</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Builder.position-212"><a href="#Builder.position-212"><span class="linenos">212</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_units</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_state</span><span class="o">.</span><span class="n">time</span><span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>The position property returns the current position of the portfolio.</p>

<p>It returns a pandas Series object containing the current position of the portfolio.</p>

<p>Returns: pd.Series: a pandas Series object containing the current position of the portfolio.</p>
</div>


                            </div>
                            <div id="Builder.cashposition" class="classattr">
                                        <input id="Builder.cashposition-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">cashposition</span>

                <label class="view-source-button" for="Builder.cashposition-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Builder.cashposition"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Builder.cashposition-234"><a href="#Builder.cashposition-234"><span class="linenos">234</span></a>    <span class="nd">@property</span>
</span><span id="Builder.cashposition-235"><a href="#Builder.cashposition-235"><span class="linenos">235</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">cashposition</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Builder.cashposition-236"><a href="#Builder.cashposition-236"><span class="linenos">236</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the current cash value of each position in the portfolio.</span>
</span><span id="Builder.cashposition-237"><a href="#Builder.cashposition-237"><span class="linenos">237</span></a>
</span><span id="Builder.cashposition-238"><a href="#Builder.cashposition-238"><span class="linenos">238</span></a><span class="sd">        This property calculates the cash value of each position by multiplying</span>
</span><span id="Builder.cashposition-239"><a href="#Builder.cashposition-239"><span class="linenos">239</span></a><span class="sd">        the number of units by the current price for each asset.</span>
</span><span id="Builder.cashposition-240"><a href="#Builder.cashposition-240"><span class="linenos">240</span></a>
</span><span id="Builder.cashposition-241"><a href="#Builder.cashposition-241"><span class="linenos">241</span></a><span class="sd">        Returns</span>
</span><span id="Builder.cashposition-242"><a href="#Builder.cashposition-242"><span class="linenos">242</span></a><span class="sd">        -------</span>
</span><span id="Builder.cashposition-243"><a href="#Builder.cashposition-243"><span class="linenos">243</span></a><span class="sd">        pd.Series</span>
</span><span id="Builder.cashposition-244"><a href="#Builder.cashposition-244"><span class="linenos">244</span></a><span class="sd">            A pandas Series containing the cash value of each position,</span>
</span><span id="Builder.cashposition-245"><a href="#Builder.cashposition-245"><span class="linenos">245</span></a><span class="sd">            indexed by asset</span>
</span><span id="Builder.cashposition-246"><a href="#Builder.cashposition-246"><span class="linenos">246</span></a>
</span><span id="Builder.cashposition-247"><a href="#Builder.cashposition-247"><span class="linenos">247</span></a><span class="sd">        Notes</span>
</span><span id="Builder.cashposition-248"><a href="#Builder.cashposition-248"><span class="linenos">248</span></a><span class="sd">        -----</span>
</span><span id="Builder.cashposition-249"><a href="#Builder.cashposition-249"><span class="linenos">249</span></a><span class="sd">        This is different from the &#39;cash&#39; property, which represents</span>
</span><span id="Builder.cashposition-250"><a href="#Builder.cashposition-250"><span class="linenos">250</span></a><span class="sd">        uninvested money. This property represents the market value</span>
</span><span id="Builder.cashposition-251"><a href="#Builder.cashposition-251"><span class="linenos">251</span></a><span class="sd">        of each invested position.</span>
</span><span id="Builder.cashposition-252"><a href="#Builder.cashposition-252"><span class="linenos">252</span></a>
</span><span id="Builder.cashposition-253"><a href="#Builder.cashposition-253"><span class="linenos">253</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Builder.cashposition-254"><a href="#Builder.cashposition-254"><span class="linenos">254</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">position</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_prices</span>
</span></pre></div>


            <div class="docstring"><p>Get the current cash value of each position in the portfolio.</p>

<p>This property calculates the cash value of each position by multiplying
the number of units by the current price for each asset.</p>

<h2 id="returns">Returns</h2>

<p>pd.Series
    A pandas Series containing the cash value of each position,
    indexed by asset</p>

<h2 id="notes">Notes</h2>

<p>This is different from the 'cash' property, which represents
uninvested money. This property represents the market value
of each invested position.</p>
</div>


                            </div>
                            <div id="Builder.units" class="classattr">
                                        <input id="Builder.units-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">units</span>

                <label class="view-source-button" for="Builder.units-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Builder.units"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Builder.units-256"><a href="#Builder.units-256"><span class="linenos">256</span></a>    <span class="nd">@property</span>
</span><span id="Builder.units-257"><a href="#Builder.units-257"><span class="linenos">257</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">units</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Builder.units-258"><a href="#Builder.units-258"><span class="linenos">258</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the complete history of portfolio holdings.</span>
</span><span id="Builder.units-259"><a href="#Builder.units-259"><span class="linenos">259</span></a>
</span><span id="Builder.units-260"><a href="#Builder.units-260"><span class="linenos">260</span></a><span class="sd">        This property returns the entire DataFrame of holdings (units) for all</span>
</span><span id="Builder.units-261"><a href="#Builder.units-261"><span class="linenos">261</span></a><span class="sd">        assets over all time points in the portfolio.</span>
</span><span id="Builder.units-262"><a href="#Builder.units-262"><span class="linenos">262</span></a>
</span><span id="Builder.units-263"><a href="#Builder.units-263"><span class="linenos">263</span></a><span class="sd">        Returns</span>
</span><span id="Builder.units-264"><a href="#Builder.units-264"><span class="linenos">264</span></a><span class="sd">        -------</span>
</span><span id="Builder.units-265"><a href="#Builder.units-265"><span class="linenos">265</span></a><span class="sd">        pd.DataFrame</span>
</span><span id="Builder.units-266"><a href="#Builder.units-266"><span class="linenos">266</span></a><span class="sd">            A DataFrame containing the number of units held for each asset over time,</span>
</span><span id="Builder.units-267"><a href="#Builder.units-267"><span class="linenos">267</span></a><span class="sd">            with dates as index and assets as columns</span>
</span><span id="Builder.units-268"><a href="#Builder.units-268"><span class="linenos">268</span></a>
</span><span id="Builder.units-269"><a href="#Builder.units-269"><span class="linenos">269</span></a><span class="sd">        Notes</span>
</span><span id="Builder.units-270"><a href="#Builder.units-270"><span class="linenos">270</span></a><span class="sd">        -----</span>
</span><span id="Builder.units-271"><a href="#Builder.units-271"><span class="linenos">271</span></a><span class="sd">        This property is particularly useful for testing and for building</span>
</span><span id="Builder.units-272"><a href="#Builder.units-272"><span class="linenos">272</span></a><span class="sd">        the final Portfolio object via the build() method.</span>
</span><span id="Builder.units-273"><a href="#Builder.units-273"><span class="linenos">273</span></a>
</span><span id="Builder.units-274"><a href="#Builder.units-274"><span class="linenos">274</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Builder.units-275"><a href="#Builder.units-275"><span class="linenos">275</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_units</span>
</span></pre></div>


            <div class="docstring"><p>Get the complete history of portfolio holdings.</p>

<p>This property returns the entire DataFrame of holdings (units) for all
assets over all time points in the portfolio.</p>

<h2 id="returns">Returns</h2>

<p>pd.DataFrame
    A DataFrame containing the number of units held for each asset over time,
    with dates as index and assets as columns</p>

<h2 id="notes">Notes</h2>

<p>This property is particularly useful for testing and for building
the final Portfolio object via the build() method.</p>
</div>


                            </div>
                            <div id="Builder.build" class="classattr">
                                        <input id="Builder.build-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">build</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Builder.build-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Builder.build"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Builder.build-303"><a href="#Builder.build-303"><span class="linenos">303</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">build</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Builder.build-304"><a href="#Builder.build-304"><span class="linenos">304</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a new Portfolio instance from the current builder state.</span>
</span><span id="Builder.build-305"><a href="#Builder.build-305"><span class="linenos">305</span></a>
</span><span id="Builder.build-306"><a href="#Builder.build-306"><span class="linenos">306</span></a><span class="sd">        This method creates a new immutable Portfolio object based on the</span>
</span><span id="Builder.build-307"><a href="#Builder.build-307"><span class="linenos">307</span></a><span class="sd">        current state of the Builder, which can be used for analysis and reporting.</span>
</span><span id="Builder.build-308"><a href="#Builder.build-308"><span class="linenos">308</span></a>
</span><span id="Builder.build-309"><a href="#Builder.build-309"><span class="linenos">309</span></a><span class="sd">        Returns</span>
</span><span id="Builder.build-310"><a href="#Builder.build-310"><span class="linenos">310</span></a><span class="sd">        -------</span>
</span><span id="Builder.build-311"><a href="#Builder.build-311"><span class="linenos">311</span></a><span class="sd">        Portfolio</span>
</span><span id="Builder.build-312"><a href="#Builder.build-312"><span class="linenos">312</span></a><span class="sd">            A new instance of the Portfolio class with the attributes</span>
</span><span id="Builder.build-313"><a href="#Builder.build-313"><span class="linenos">313</span></a><span class="sd">            (prices, units, aum) as specified in the Builder</span>
</span><span id="Builder.build-314"><a href="#Builder.build-314"><span class="linenos">314</span></a>
</span><span id="Builder.build-315"><a href="#Builder.build-315"><span class="linenos">315</span></a><span class="sd">        Notes</span>
</span><span id="Builder.build-316"><a href="#Builder.build-316"><span class="linenos">316</span></a><span class="sd">        -----</span>
</span><span id="Builder.build-317"><a href="#Builder.build-317"><span class="linenos">317</span></a><span class="sd">        The resulting Portfolio object will be immutable (frozen) and will</span>
</span><span id="Builder.build-318"><a href="#Builder.build-318"><span class="linenos">318</span></a><span class="sd">        have the same data as the Builder from which it was built, but</span>
</span><span id="Builder.build-319"><a href="#Builder.build-319"><span class="linenos">319</span></a><span class="sd">        with a different interface focused on analysis rather than construction.</span>
</span><span id="Builder.build-320"><a href="#Builder.build-320"><span class="linenos">320</span></a>
</span><span id="Builder.build-321"><a href="#Builder.build-321"><span class="linenos">321</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Builder.build-322"><a href="#Builder.build-322"><span class="linenos">322</span></a>        <span class="k">return</span> <span class="n">Portfolio</span><span class="p">(</span><span class="n">prices</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">prices</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">units</span><span class="p">,</span> <span class="n">aum</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">aum</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Create a new Portfolio instance from the current builder state.</p>

<p>This method creates a new immutable Portfolio object based on the
current state of the Builder, which can be used for analysis and reporting.</p>

<h2 id="returns">Returns</h2>

<p>Portfolio
    A new instance of the Portfolio class with the attributes
    (prices, units, aum) as specified in the Builder</p>

<h2 id="notes">Notes</h2>

<p>The resulting Portfolio object will be immutable (frozen) and will
have the same data as the Builder from which it was built, but
with a different interface focused on analysis rather than construction.</p>
</div>


                            </div>
                            <div id="Builder.weights" class="classattr">
                                        <input id="Builder.weights-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">weights</span><span class="annotation">: numpy.ndarray</span>

                <label class="view-source-button" for="Builder.weights-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Builder.weights"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Builder.weights-324"><a href="#Builder.weights-324"><span class="linenos">324</span></a>    <span class="nd">@property</span>
</span><span id="Builder.weights-325"><a href="#Builder.weights-325"><span class="linenos">325</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">weights</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
</span><span id="Builder.weights-326"><a href="#Builder.weights-326"><span class="linenos">326</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the current portfolio weights for each asset.</span>
</span><span id="Builder.weights-327"><a href="#Builder.weights-327"><span class="linenos">327</span></a>
</span><span id="Builder.weights-328"><a href="#Builder.weights-328"><span class="linenos">328</span></a><span class="sd">        This property retrieves the weight of each asset in the portfolio</span>
</span><span id="Builder.weights-329"><a href="#Builder.weights-329"><span class="linenos">329</span></a><span class="sd">        from the internal state. Weights represent the proportion of the</span>
</span><span id="Builder.weights-330"><a href="#Builder.weights-330"><span class="linenos">330</span></a><span class="sd">        portfolio&#39;s value invested in each asset.</span>
</span><span id="Builder.weights-331"><a href="#Builder.weights-331"><span class="linenos">331</span></a>
</span><span id="Builder.weights-332"><a href="#Builder.weights-332"><span class="linenos">332</span></a><span class="sd">        Returns</span>
</span><span id="Builder.weights-333"><a href="#Builder.weights-333"><span class="linenos">333</span></a><span class="sd">        -------</span>
</span><span id="Builder.weights-334"><a href="#Builder.weights-334"><span class="linenos">334</span></a><span class="sd">        np.array</span>
</span><span id="Builder.weights-335"><a href="#Builder.weights-335"><span class="linenos">335</span></a><span class="sd">            An array of weights for each asset in the portfolio</span>
</span><span id="Builder.weights-336"><a href="#Builder.weights-336"><span class="linenos">336</span></a>
</span><span id="Builder.weights-337"><a href="#Builder.weights-337"><span class="linenos">337</span></a><span class="sd">        Notes</span>
</span><span id="Builder.weights-338"><a href="#Builder.weights-338"><span class="linenos">338</span></a><span class="sd">        -----</span>
</span><span id="Builder.weights-339"><a href="#Builder.weights-339"><span class="linenos">339</span></a><span class="sd">        Weights sum to 1.0 for a fully invested portfolio with no leverage.</span>
</span><span id="Builder.weights-340"><a href="#Builder.weights-340"><span class="linenos">340</span></a><span class="sd">        Negative weights represent short positions.</span>
</span><span id="Builder.weights-341"><a href="#Builder.weights-341"><span class="linenos">341</span></a>
</span><span id="Builder.weights-342"><a href="#Builder.weights-342"><span class="linenos">342</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Builder.weights-343"><a href="#Builder.weights-343"><span class="linenos">343</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_state</span><span class="o">.</span><span class="n">weights</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_state</span><span class="o">.</span><span class="n">assets</span><span class="p">]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>Get the current portfolio weights for each asset.</p>

<p>This property retrieves the weight of each asset in the portfolio
from the internal state. Weights represent the proportion of the
portfolio's value invested in each asset.</p>

<h2 id="returns">Returns</h2>

<p>np.array
    An array of weights for each asset in the portfolio</p>

<h2 id="notes">Notes</h2>

<p>Weights sum to 1.0 for a fully invested portfolio with no leverage.
Negative weights represent short positions.</p>
</div>


                            </div>
                            <div id="Builder.aum" class="classattr">
                                        <input id="Builder.aum-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">aum</span>

                <label class="view-source-button" for="Builder.aum-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Builder.aum"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Builder.aum-370"><a href="#Builder.aum-370"><span class="linenos">370</span></a>    <span class="nd">@property</span>
</span><span id="Builder.aum-371"><a href="#Builder.aum-371"><span class="linenos">371</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">aum</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Builder.aum-372"><a href="#Builder.aum-372"><span class="linenos">372</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the assets under management (AUM) history of the portfolio.</span>
</span><span id="Builder.aum-373"><a href="#Builder.aum-373"><span class="linenos">373</span></a>
</span><span id="Builder.aum-374"><a href="#Builder.aum-374"><span class="linenos">374</span></a><span class="sd">        This property returns the entire series of AUM values over time,</span>
</span><span id="Builder.aum-375"><a href="#Builder.aum-375"><span class="linenos">375</span></a><span class="sd">        representing the total value of the portfolio at each time point.</span>
</span><span id="Builder.aum-376"><a href="#Builder.aum-376"><span class="linenos">376</span></a>
</span><span id="Builder.aum-377"><a href="#Builder.aum-377"><span class="linenos">377</span></a><span class="sd">        Returns</span>
</span><span id="Builder.aum-378"><a href="#Builder.aum-378"><span class="linenos">378</span></a><span class="sd">        -------</span>
</span><span id="Builder.aum-379"><a href="#Builder.aum-379"><span class="linenos">379</span></a><span class="sd">        pd.Series</span>
</span><span id="Builder.aum-380"><a href="#Builder.aum-380"><span class="linenos">380</span></a><span class="sd">            A Series containing the AUM values over time, with dates as index</span>
</span><span id="Builder.aum-381"><a href="#Builder.aum-381"><span class="linenos">381</span></a>
</span><span id="Builder.aum-382"><a href="#Builder.aum-382"><span class="linenos">382</span></a><span class="sd">        Notes</span>
</span><span id="Builder.aum-383"><a href="#Builder.aum-383"><span class="linenos">383</span></a><span class="sd">        -----</span>
</span><span id="Builder.aum-384"><a href="#Builder.aum-384"><span class="linenos">384</span></a><span class="sd">        AUM (assets under management) represents the total value of the portfolio,</span>
</span><span id="Builder.aum-385"><a href="#Builder.aum-385"><span class="linenos">385</span></a><span class="sd">        including both invested positions and uninvested cash.</span>
</span><span id="Builder.aum-386"><a href="#Builder.aum-386"><span class="linenos">386</span></a>
</span><span id="Builder.aum-387"><a href="#Builder.aum-387"><span class="linenos">387</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Builder.aum-388"><a href="#Builder.aum-388"><span class="linenos">388</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_aum</span>
</span></pre></div>


            <div class="docstring"><p>Get the assets under management (AUM) history of the portfolio.</p>

<p>This property returns the entire series of AUM values over time,
representing the total value of the portfolio at each time point.</p>

<h2 id="returns">Returns</h2>

<p>pd.Series
    A Series containing the AUM values over time, with dates as index</p>

<h2 id="notes">Notes</h2>

<p>AUM (assets under management) represents the total value of the portfolio,
including both invested positions and uninvested cash.</p>
</div>


                            </div>
                </section>
                <section id="Portfolio">
                            <input id="Portfolio-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
                    <div class="decorator decorator-dataclass">@dataclass(frozen=True)</div>

    <span class="def">class</span>
    <span class="name">Portfolio</span>:

                <label class="view-source-button" for="Portfolio-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Portfolio"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Portfolio-33"><a href="#Portfolio-33"><span class="linenos"> 33</span></a><span class="nd">@dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="Portfolio-34"><a href="#Portfolio-34"><span class="linenos"> 34</span></a><span class="k">class</span><span class="w"> </span><span class="nc">Portfolio</span><span class="p">:</span>
</span><span id="Portfolio-35"><a href="#Portfolio-35"><span class="linenos"> 35</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Represents a portfolio of assets with methods for analysis and visualization.</span>
</span><span id="Portfolio-36"><a href="#Portfolio-36"><span class="linenos"> 36</span></a>
</span><span id="Portfolio-37"><a href="#Portfolio-37"><span class="linenos"> 37</span></a><span class="sd">    The Portfolio class is a frozen dataclass (immutable) that represents a portfolio</span>
</span><span id="Portfolio-38"><a href="#Portfolio-38"><span class="linenos"> 38</span></a><span class="sd">    of assets with their prices and positions (units). It provides methods for</span>
</span><span id="Portfolio-39"><a href="#Portfolio-39"><span class="linenos"> 39</span></a><span class="sd">    calculating various metrics like NAV, profit, drawdown, and for visualizing</span>
</span><span id="Portfolio-40"><a href="#Portfolio-40"><span class="linenos"> 40</span></a><span class="sd">    the portfolio&#39;s performance.</span>
</span><span id="Portfolio-41"><a href="#Portfolio-41"><span class="linenos"> 41</span></a>
</span><span id="Portfolio-42"><a href="#Portfolio-42"><span class="linenos"> 42</span></a><span class="sd">    Attributes</span>
</span><span id="Portfolio-43"><a href="#Portfolio-43"><span class="linenos"> 43</span></a><span class="sd">    ----------</span>
</span><span id="Portfolio-44"><a href="#Portfolio-44"><span class="linenos"> 44</span></a><span class="sd">    prices : pd.DataFrame</span>
</span><span id="Portfolio-45"><a href="#Portfolio-45"><span class="linenos"> 45</span></a><span class="sd">        DataFrame of asset prices over time, with dates as index and assets as columns</span>
</span><span id="Portfolio-46"><a href="#Portfolio-46"><span class="linenos"> 46</span></a><span class="sd">    units : pd.DataFrame</span>
</span><span id="Portfolio-47"><a href="#Portfolio-47"><span class="linenos"> 47</span></a><span class="sd">        DataFrame of asset positions (units) over time, with dates as index and assets as columns</span>
</span><span id="Portfolio-48"><a href="#Portfolio-48"><span class="linenos"> 48</span></a><span class="sd">    aum : Union[float, pd.Series]</span>
</span><span id="Portfolio-49"><a href="#Portfolio-49"><span class="linenos"> 49</span></a><span class="sd">        Assets under management, either as a constant float or as a Series over time</span>
</span><span id="Portfolio-50"><a href="#Portfolio-50"><span class="linenos"> 50</span></a>
</span><span id="Portfolio-51"><a href="#Portfolio-51"><span class="linenos"> 51</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Portfolio-52"><a href="#Portfolio-52"><span class="linenos"> 52</span></a>
</span><span id="Portfolio-53"><a href="#Portfolio-53"><span class="linenos"> 53</span></a>    <span class="n">prices</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span>
</span><span id="Portfolio-54"><a href="#Portfolio-54"><span class="linenos"> 54</span></a>    <span class="n">units</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span>
</span><span id="Portfolio-55"><a href="#Portfolio-55"><span class="linenos"> 55</span></a>    <span class="n">aum</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span>
</span><span id="Portfolio-56"><a href="#Portfolio-56"><span class="linenos"> 56</span></a>    <span class="n">_data</span><span class="p">:</span> <span class="n">Data</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">init</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="Portfolio-57"><a href="#Portfolio-57"><span class="linenos"> 57</span></a>
</span><span id="Portfolio-58"><a href="#Portfolio-58"><span class="linenos"> 58</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">__post_init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Portfolio-59"><a href="#Portfolio-59"><span class="linenos"> 59</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Validate the portfolio data after initialization.</span>
</span><span id="Portfolio-60"><a href="#Portfolio-60"><span class="linenos"> 60</span></a>
</span><span id="Portfolio-61"><a href="#Portfolio-61"><span class="linenos"> 61</span></a><span class="sd">        This method is automatically called after an instance of the Portfolio</span>
</span><span id="Portfolio-62"><a href="#Portfolio-62"><span class="linenos"> 62</span></a><span class="sd">        class has been initialized. It performs a series of validation checks</span>
</span><span id="Portfolio-63"><a href="#Portfolio-63"><span class="linenos"> 63</span></a><span class="sd">        to ensure that the prices and units dataframes are in the expected format</span>
</span><span id="Portfolio-64"><a href="#Portfolio-64"><span class="linenos"> 64</span></a><span class="sd">        with no duplicates or missing data.</span>
</span><span id="Portfolio-65"><a href="#Portfolio-65"><span class="linenos"> 65</span></a>
</span><span id="Portfolio-66"><a href="#Portfolio-66"><span class="linenos"> 66</span></a><span class="sd">        The method checks that:</span>
</span><span id="Portfolio-67"><a href="#Portfolio-67"><span class="linenos"> 67</span></a><span class="sd">        - Both prices and units dataframes have monotonic increasing indices</span>
</span><span id="Portfolio-68"><a href="#Portfolio-68"><span class="linenos"> 68</span></a><span class="sd">        - Both prices and units dataframes have unique indices</span>
</span><span id="Portfolio-69"><a href="#Portfolio-69"><span class="linenos"> 69</span></a><span class="sd">        - The index of units is a subset of the index of prices</span>
</span><span id="Portfolio-70"><a href="#Portfolio-70"><span class="linenos"> 70</span></a><span class="sd">        - The columns of units is a subset of the columns of prices</span>
</span><span id="Portfolio-71"><a href="#Portfolio-71"><span class="linenos"> 71</span></a>
</span><span id="Portfolio-72"><a href="#Portfolio-72"><span class="linenos"> 72</span></a><span class="sd">        Raises</span>
</span><span id="Portfolio-73"><a href="#Portfolio-73"><span class="linenos"> 73</span></a><span class="sd">        ------</span>
</span><span id="Portfolio-74"><a href="#Portfolio-74"><span class="linenos"> 74</span></a><span class="sd">        AssertionError</span>
</span><span id="Portfolio-75"><a href="#Portfolio-75"><span class="linenos"> 75</span></a><span class="sd">            If any of the validation checks fail</span>
</span><span id="Portfolio-76"><a href="#Portfolio-76"><span class="linenos"> 76</span></a>
</span><span id="Portfolio-77"><a href="#Portfolio-77"><span class="linenos"> 77</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Portfolio-78"><a href="#Portfolio-78"><span class="linenos"> 78</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">prices</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">is_monotonic_increasing</span><span class="p">:</span>
</span><span id="Portfolio-79"><a href="#Portfolio-79"><span class="linenos"> 79</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;`prices` index must be monotonic increasing.&quot;</span><span class="p">)</span>
</span><span id="Portfolio-80"><a href="#Portfolio-80"><span class="linenos"> 80</span></a>
</span><span id="Portfolio-81"><a href="#Portfolio-81"><span class="linenos"> 81</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">prices</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">is_unique</span><span class="p">:</span>
</span><span id="Portfolio-82"><a href="#Portfolio-82"><span class="linenos"> 82</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;`prices` index must be unique.&quot;</span><span class="p">)</span>
</span><span id="Portfolio-83"><a href="#Portfolio-83"><span class="linenos"> 83</span></a>
</span><span id="Portfolio-84"><a href="#Portfolio-84"><span class="linenos"> 84</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">is_monotonic_increasing</span><span class="p">:</span>
</span><span id="Portfolio-85"><a href="#Portfolio-85"><span class="linenos"> 85</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;`units` index must be monotonic increasing.&quot;</span><span class="p">)</span>
</span><span id="Portfolio-86"><a href="#Portfolio-86"><span class="linenos"> 86</span></a>
</span><span id="Portfolio-87"><a href="#Portfolio-87"><span class="linenos"> 87</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">is_unique</span><span class="p">:</span>
</span><span id="Portfolio-88"><a href="#Portfolio-88"><span class="linenos"> 88</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;`units` index must be unique.&quot;</span><span class="p">)</span>
</span><span id="Portfolio-89"><a href="#Portfolio-89"><span class="linenos"> 89</span></a>
</span><span id="Portfolio-90"><a href="#Portfolio-90"><span class="linenos"> 90</span></a>        <span class="n">missing_dates</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">difference</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">prices</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
</span><span id="Portfolio-91"><a href="#Portfolio-91"><span class="linenos"> 91</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">missing_dates</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
</span><span id="Portfolio-92"><a href="#Portfolio-92"><span class="linenos"> 92</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;`units` index contains dates not present in `prices`: </span><span class="si">{</span><span class="n">missing_dates</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="Portfolio-93"><a href="#Portfolio-93"><span class="linenos"> 93</span></a>
</span><span id="Portfolio-94"><a href="#Portfolio-94"><span class="linenos"> 94</span></a>        <span class="n">missing_assets</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">difference</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">prices</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
</span><span id="Portfolio-95"><a href="#Portfolio-95"><span class="linenos"> 95</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">missing_assets</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
</span><span id="Portfolio-96"><a href="#Portfolio-96"><span class="linenos"> 96</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;`units` contains assets not present in `prices`: </span><span class="si">{</span><span class="n">missing_assets</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="Portfolio-97"><a href="#Portfolio-97"><span class="linenos"> 97</span></a>
</span><span id="Portfolio-98"><a href="#Portfolio-98"><span class="linenos"> 98</span></a>        <span class="n">frame</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nav</span><span class="o">.</span><span class="n">pct_change</span><span class="p">()</span><span class="o">.</span><span class="n">to_frame</span><span class="p">()</span>
</span><span id="Portfolio-99"><a href="#Portfolio-99"><span class="linenos"> 99</span></a>        <span class="n">frame</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;Date&quot;</span>
</span><span id="Portfolio-100"><a href="#Portfolio-100"><span class="linenos">100</span></a>        <span class="n">d</span> <span class="o">=</span> <span class="n">build_data</span><span class="p">(</span><span class="n">returns</span><span class="o">=</span><span class="n">frame</span><span class="p">)</span>
</span><span id="Portfolio-101"><a href="#Portfolio-101"><span class="linenos">101</span></a>
</span><span id="Portfolio-102"><a href="#Portfolio-102"><span class="linenos">102</span></a>        <span class="nb">object</span><span class="o">.</span><span class="fm">__setattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;_data&quot;</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span>
</span><span id="Portfolio-103"><a href="#Portfolio-103"><span class="linenos">103</span></a>
</span><span id="Portfolio-104"><a href="#Portfolio-104"><span class="linenos">104</span></a>    <span class="nd">@property</span>
</span><span id="Portfolio-105"><a href="#Portfolio-105"><span class="linenos">105</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">index</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">datetime</span><span class="p">]:</span>
</span><span id="Portfolio-106"><a href="#Portfolio-106"><span class="linenos">106</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the time index of the portfolio.</span>
</span><span id="Portfolio-107"><a href="#Portfolio-107"><span class="linenos">107</span></a>
</span><span id="Portfolio-108"><a href="#Portfolio-108"><span class="linenos">108</span></a><span class="sd">        Returns</span>
</span><span id="Portfolio-109"><a href="#Portfolio-109"><span class="linenos">109</span></a><span class="sd">        -------</span>
</span><span id="Portfolio-110"><a href="#Portfolio-110"><span class="linenos">110</span></a><span class="sd">        pd.DatetimeIndex</span>
</span><span id="Portfolio-111"><a href="#Portfolio-111"><span class="linenos">111</span></a><span class="sd">            A DatetimeIndex representing the time period for which portfolio</span>
</span><span id="Portfolio-112"><a href="#Portfolio-112"><span class="linenos">112</span></a><span class="sd">            data is available</span>
</span><span id="Portfolio-113"><a href="#Portfolio-113"><span class="linenos">113</span></a>
</span><span id="Portfolio-114"><a href="#Portfolio-114"><span class="linenos">114</span></a><span class="sd">        Notes</span>
</span><span id="Portfolio-115"><a href="#Portfolio-115"><span class="linenos">115</span></a><span class="sd">        -----</span>
</span><span id="Portfolio-116"><a href="#Portfolio-116"><span class="linenos">116</span></a><span class="sd">        This property extracts the index from the prices DataFrame, which</span>
</span><span id="Portfolio-117"><a href="#Portfolio-117"><span class="linenos">117</span></a><span class="sd">        represents all time points in the portfolio history.</span>
</span><span id="Portfolio-118"><a href="#Portfolio-118"><span class="linenos">118</span></a>
</span><span id="Portfolio-119"><a href="#Portfolio-119"><span class="linenos">119</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Portfolio-120"><a href="#Portfolio-120"><span class="linenos">120</span></a>        <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DatetimeIndex</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">prices</span><span class="o">.</span><span class="n">index</span><span class="p">)</span><span class="o">.</span><span class="n">to_list</span><span class="p">()</span>
</span><span id="Portfolio-121"><a href="#Portfolio-121"><span class="linenos">121</span></a>
</span><span id="Portfolio-122"><a href="#Portfolio-122"><span class="linenos">122</span></a>    <span class="nd">@property</span>
</span><span id="Portfolio-123"><a href="#Portfolio-123"><span class="linenos">123</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">assets</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="Portfolio-124"><a href="#Portfolio-124"><span class="linenos">124</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the list of assets in the portfolio.</span>
</span><span id="Portfolio-125"><a href="#Portfolio-125"><span class="linenos">125</span></a>
</span><span id="Portfolio-126"><a href="#Portfolio-126"><span class="linenos">126</span></a><span class="sd">        Returns</span>
</span><span id="Portfolio-127"><a href="#Portfolio-127"><span class="linenos">127</span></a><span class="sd">        -------</span>
</span><span id="Portfolio-128"><a href="#Portfolio-128"><span class="linenos">128</span></a><span class="sd">        pd.Index</span>
</span><span id="Portfolio-129"><a href="#Portfolio-129"><span class="linenos">129</span></a><span class="sd">            An Index containing the names of all assets in the portfolio</span>
</span><span id="Portfolio-130"><a href="#Portfolio-130"><span class="linenos">130</span></a>
</span><span id="Portfolio-131"><a href="#Portfolio-131"><span class="linenos">131</span></a><span class="sd">        Notes</span>
</span><span id="Portfolio-132"><a href="#Portfolio-132"><span class="linenos">132</span></a><span class="sd">        -----</span>
</span><span id="Portfolio-133"><a href="#Portfolio-133"><span class="linenos">133</span></a><span class="sd">        This property extracts the column names from the prices DataFrame,</span>
</span><span id="Portfolio-134"><a href="#Portfolio-134"><span class="linenos">134</span></a><span class="sd">        which correspond to all assets for which price data is available.</span>
</span><span id="Portfolio-135"><a href="#Portfolio-135"><span class="linenos">135</span></a>
</span><span id="Portfolio-136"><a href="#Portfolio-136"><span class="linenos">136</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Portfolio-137"><a href="#Portfolio-137"><span class="linenos">137</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">prices</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">to_list</span><span class="p">()</span>
</span><span id="Portfolio-138"><a href="#Portfolio-138"><span class="linenos">138</span></a>
</span><span id="Portfolio-139"><a href="#Portfolio-139"><span class="linenos">139</span></a>    <span class="nd">@property</span>
</span><span id="Portfolio-140"><a href="#Portfolio-140"><span class="linenos">140</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">nav</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">:</span>
</span><span id="Portfolio-141"><a href="#Portfolio-141"><span class="linenos">141</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the net asset value (NAV) of the portfolio over time.</span>
</span><span id="Portfolio-142"><a href="#Portfolio-142"><span class="linenos">142</span></a>
</span><span id="Portfolio-143"><a href="#Portfolio-143"><span class="linenos">143</span></a><span class="sd">        The NAV represents the total value of the portfolio at each point in time.</span>
</span><span id="Portfolio-144"><a href="#Portfolio-144"><span class="linenos">144</span></a><span class="sd">        If aum is provided as a Series, it is used directly. Otherwise, the NAV</span>
</span><span id="Portfolio-145"><a href="#Portfolio-145"><span class="linenos">145</span></a><span class="sd">        is calculated from the cumulative profit plus the initial aum.</span>
</span><span id="Portfolio-146"><a href="#Portfolio-146"><span class="linenos">146</span></a>
</span><span id="Portfolio-147"><a href="#Portfolio-147"><span class="linenos">147</span></a><span class="sd">        Returns</span>
</span><span id="Portfolio-148"><a href="#Portfolio-148"><span class="linenos">148</span></a><span class="sd">        -------</span>
</span><span id="Portfolio-149"><a href="#Portfolio-149"><span class="linenos">149</span></a><span class="sd">        pd.Series</span>
</span><span id="Portfolio-150"><a href="#Portfolio-150"><span class="linenos">150</span></a><span class="sd">            Series representing the NAV of the portfolio over time</span>
</span><span id="Portfolio-151"><a href="#Portfolio-151"><span class="linenos">151</span></a>
</span><span id="Portfolio-152"><a href="#Portfolio-152"><span class="linenos">152</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Portfolio-153"><a href="#Portfolio-153"><span class="linenos">153</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">aum</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">):</span>
</span><span id="Portfolio-154"><a href="#Portfolio-154"><span class="linenos">154</span></a>            <span class="n">series</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">aum</span>
</span><span id="Portfolio-155"><a href="#Portfolio-155"><span class="linenos">155</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Portfolio-156"><a href="#Portfolio-156"><span class="linenos">156</span></a>            <span class="n">profit</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cashposition</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">returns</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mf">0.0</span><span class="p">))</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="Portfolio-157"><a href="#Portfolio-157"><span class="linenos">157</span></a>            <span class="n">series</span> <span class="o">=</span> <span class="n">profit</span><span class="o">.</span><span class="n">cumsum</span><span class="p">()</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">aum</span>
</span><span id="Portfolio-158"><a href="#Portfolio-158"><span class="linenos">158</span></a>
</span><span id="Portfolio-159"><a href="#Portfolio-159"><span class="linenos">159</span></a>        <span class="n">series</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;NAV&quot;</span>
</span><span id="Portfolio-160"><a href="#Portfolio-160"><span class="linenos">160</span></a>        <span class="k">return</span> <span class="n">series</span>
</span><span id="Portfolio-161"><a href="#Portfolio-161"><span class="linenos">161</span></a>
</span><span id="Portfolio-162"><a href="#Portfolio-162"><span class="linenos">162</span></a>    <span class="nd">@property</span>
</span><span id="Portfolio-163"><a href="#Portfolio-163"><span class="linenos">163</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">profit</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">:</span>
</span><span id="Portfolio-164"><a href="#Portfolio-164"><span class="linenos">164</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the profit/loss of the portfolio at each time point.</span>
</span><span id="Portfolio-165"><a href="#Portfolio-165"><span class="linenos">165</span></a>
</span><span id="Portfolio-166"><a href="#Portfolio-166"><span class="linenos">166</span></a><span class="sd">        This calculates the profit or loss at each time point based on the</span>
</span><span id="Portfolio-167"><a href="#Portfolio-167"><span class="linenos">167</span></a><span class="sd">        previous positions and the returns of each asset.</span>
</span><span id="Portfolio-168"><a href="#Portfolio-168"><span class="linenos">168</span></a>
</span><span id="Portfolio-169"><a href="#Portfolio-169"><span class="linenos">169</span></a><span class="sd">        Returns</span>
</span><span id="Portfolio-170"><a href="#Portfolio-170"><span class="linenos">170</span></a><span class="sd">        -------</span>
</span><span id="Portfolio-171"><a href="#Portfolio-171"><span class="linenos">171</span></a><span class="sd">        pd.Series</span>
</span><span id="Portfolio-172"><a href="#Portfolio-172"><span class="linenos">172</span></a><span class="sd">            Series representing the profit/loss at each time point</span>
</span><span id="Portfolio-173"><a href="#Portfolio-173"><span class="linenos">173</span></a>
</span><span id="Portfolio-174"><a href="#Portfolio-174"><span class="linenos">174</span></a><span class="sd">        Notes</span>
</span><span id="Portfolio-175"><a href="#Portfolio-175"><span class="linenos">175</span></a><span class="sd">        -----</span>
</span><span id="Portfolio-176"><a href="#Portfolio-176"><span class="linenos">176</span></a><span class="sd">        The profit is calculated by multiplying the previous day&#39;s positions</span>
</span><span id="Portfolio-177"><a href="#Portfolio-177"><span class="linenos">177</span></a><span class="sd">        (in currency terms) by the returns of each asset, and then summing</span>
</span><span id="Portfolio-178"><a href="#Portfolio-178"><span class="linenos">178</span></a><span class="sd">        across all assets.</span>
</span><span id="Portfolio-179"><a href="#Portfolio-179"><span class="linenos">179</span></a>
</span><span id="Portfolio-180"><a href="#Portfolio-180"><span class="linenos">180</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Portfolio-181"><a href="#Portfolio-181"><span class="linenos">181</span></a>        <span class="n">series</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cashposition</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">returns</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mf">0.0</span><span class="p">))</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="Portfolio-182"><a href="#Portfolio-182"><span class="linenos">182</span></a>        <span class="n">series</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;Profit&quot;</span>
</span><span id="Portfolio-183"><a href="#Portfolio-183"><span class="linenos">183</span></a>        <span class="k">return</span> <span class="n">series</span>
</span><span id="Portfolio-184"><a href="#Portfolio-184"><span class="linenos">184</span></a>
</span><span id="Portfolio-185"><a href="#Portfolio-185"><span class="linenos">185</span></a>    <span class="nd">@property</span>
</span><span id="Portfolio-186"><a href="#Portfolio-186"><span class="linenos">186</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">cashposition</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
</span><span id="Portfolio-187"><a href="#Portfolio-187"><span class="linenos">187</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the cash value of each position over time.</span>
</span><span id="Portfolio-188"><a href="#Portfolio-188"><span class="linenos">188</span></a>
</span><span id="Portfolio-189"><a href="#Portfolio-189"><span class="linenos">189</span></a><span class="sd">        This calculates the cash value of each position by multiplying</span>
</span><span id="Portfolio-190"><a href="#Portfolio-190"><span class="linenos">190</span></a><span class="sd">        the number of units by the price for each asset at each time point.</span>
</span><span id="Portfolio-191"><a href="#Portfolio-191"><span class="linenos">191</span></a>
</span><span id="Portfolio-192"><a href="#Portfolio-192"><span class="linenos">192</span></a><span class="sd">        Returns</span>
</span><span id="Portfolio-193"><a href="#Portfolio-193"><span class="linenos">193</span></a><span class="sd">        -------</span>
</span><span id="Portfolio-194"><a href="#Portfolio-194"><span class="linenos">194</span></a><span class="sd">        pd.DataFrame</span>
</span><span id="Portfolio-195"><a href="#Portfolio-195"><span class="linenos">195</span></a><span class="sd">            DataFrame with the cash value of each position over time,</span>
</span><span id="Portfolio-196"><a href="#Portfolio-196"><span class="linenos">196</span></a><span class="sd">            with dates as index and assets as columns</span>
</span><span id="Portfolio-197"><a href="#Portfolio-197"><span class="linenos">197</span></a>
</span><span id="Portfolio-198"><a href="#Portfolio-198"><span class="linenos">198</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Portfolio-199"><a href="#Portfolio-199"><span class="linenos">199</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">prices</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">units</span>
</span><span id="Portfolio-200"><a href="#Portfolio-200"><span class="linenos">200</span></a>
</span><span id="Portfolio-201"><a href="#Portfolio-201"><span class="linenos">201</span></a>    <span class="nd">@property</span>
</span><span id="Portfolio-202"><a href="#Portfolio-202"><span class="linenos">202</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">returns</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
</span><span id="Portfolio-203"><a href="#Portfolio-203"><span class="linenos">203</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the returns of individual assets over time.</span>
</span><span id="Portfolio-204"><a href="#Portfolio-204"><span class="linenos">204</span></a>
</span><span id="Portfolio-205"><a href="#Portfolio-205"><span class="linenos">205</span></a><span class="sd">        This calculates the percentage change in price for each asset</span>
</span><span id="Portfolio-206"><a href="#Portfolio-206"><span class="linenos">206</span></a><span class="sd">        from one time point to the next.</span>
</span><span id="Portfolio-207"><a href="#Portfolio-207"><span class="linenos">207</span></a>
</span><span id="Portfolio-208"><a href="#Portfolio-208"><span class="linenos">208</span></a><span class="sd">        Returns</span>
</span><span id="Portfolio-209"><a href="#Portfolio-209"><span class="linenos">209</span></a><span class="sd">        -------</span>
</span><span id="Portfolio-210"><a href="#Portfolio-210"><span class="linenos">210</span></a><span class="sd">        pd.DataFrame</span>
</span><span id="Portfolio-211"><a href="#Portfolio-211"><span class="linenos">211</span></a><span class="sd">            DataFrame with the returns of each asset over time,</span>
</span><span id="Portfolio-212"><a href="#Portfolio-212"><span class="linenos">212</span></a><span class="sd">            with dates as index and assets as columns</span>
</span><span id="Portfolio-213"><a href="#Portfolio-213"><span class="linenos">213</span></a>
</span><span id="Portfolio-214"><a href="#Portfolio-214"><span class="linenos">214</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Portfolio-215"><a href="#Portfolio-215"><span class="linenos">215</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">prices</span><span class="o">.</span><span class="n">pct_change</span><span class="p">()</span>
</span><span id="Portfolio-216"><a href="#Portfolio-216"><span class="linenos">216</span></a>
</span><span id="Portfolio-217"><a href="#Portfolio-217"><span class="linenos">217</span></a>    <span class="nd">@property</span>
</span><span id="Portfolio-218"><a href="#Portfolio-218"><span class="linenos">218</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">trades_units</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
</span><span id="Portfolio-219"><a href="#Portfolio-219"><span class="linenos">219</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the trades made in the portfolio in terms of units.</span>
</span><span id="Portfolio-220"><a href="#Portfolio-220"><span class="linenos">220</span></a>
</span><span id="Portfolio-221"><a href="#Portfolio-221"><span class="linenos">221</span></a><span class="sd">        This calculates the changes in position (units) from one time point</span>
</span><span id="Portfolio-222"><a href="#Portfolio-222"><span class="linenos">222</span></a><span class="sd">        to the next for each asset.</span>
</span><span id="Portfolio-223"><a href="#Portfolio-223"><span class="linenos">223</span></a>
</span><span id="Portfolio-224"><a href="#Portfolio-224"><span class="linenos">224</span></a><span class="sd">        Returns</span>
</span><span id="Portfolio-225"><a href="#Portfolio-225"><span class="linenos">225</span></a><span class="sd">        -------</span>
</span><span id="Portfolio-226"><a href="#Portfolio-226"><span class="linenos">226</span></a><span class="sd">        pd.DataFrame</span>
</span><span id="Portfolio-227"><a href="#Portfolio-227"><span class="linenos">227</span></a><span class="sd">            DataFrame with the trades (changes in units) for each asset over time,</span>
</span><span id="Portfolio-228"><a href="#Portfolio-228"><span class="linenos">228</span></a><span class="sd">            with dates as index and assets as columns</span>
</span><span id="Portfolio-229"><a href="#Portfolio-229"><span class="linenos">229</span></a>
</span><span id="Portfolio-230"><a href="#Portfolio-230"><span class="linenos">230</span></a><span class="sd">        Notes</span>
</span><span id="Portfolio-231"><a href="#Portfolio-231"><span class="linenos">231</span></a><span class="sd">        -----</span>
</span><span id="Portfolio-232"><a href="#Portfolio-232"><span class="linenos">232</span></a><span class="sd">        Calculated as the difference between consecutive position values.</span>
</span><span id="Portfolio-233"><a href="#Portfolio-233"><span class="linenos">233</span></a><span class="sd">        Positive values represent buys, negative values represent sells.</span>
</span><span id="Portfolio-234"><a href="#Portfolio-234"><span class="linenos">234</span></a><span class="sd">        The first row contains the initial positions, as there are no previous</span>
</span><span id="Portfolio-235"><a href="#Portfolio-235"><span class="linenos">235</span></a><span class="sd">        positions to compare with.</span>
</span><span id="Portfolio-236"><a href="#Portfolio-236"><span class="linenos">236</span></a>
</span><span id="Portfolio-237"><a href="#Portfolio-237"><span class="linenos">237</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Portfolio-238"><a href="#Portfolio-238"><span class="linenos">238</span></a>        <span class="n">t</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span>
</span><span id="Portfolio-239"><a href="#Portfolio-239"><span class="linenos">239</span></a>        <span class="n">t</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
</span><span id="Portfolio-240"><a href="#Portfolio-240"><span class="linenos">240</span></a>        <span class="k">return</span> <span class="n">t</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
</span><span id="Portfolio-241"><a href="#Portfolio-241"><span class="linenos">241</span></a>
</span><span id="Portfolio-242"><a href="#Portfolio-242"><span class="linenos">242</span></a>    <span class="nd">@property</span>
</span><span id="Portfolio-243"><a href="#Portfolio-243"><span class="linenos">243</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">trades_currency</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
</span><span id="Portfolio-244"><a href="#Portfolio-244"><span class="linenos">244</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the trades made in the portfolio in terms of currency.</span>
</span><span id="Portfolio-245"><a href="#Portfolio-245"><span class="linenos">245</span></a>
</span><span id="Portfolio-246"><a href="#Portfolio-246"><span class="linenos">246</span></a><span class="sd">        This calculates the cash value of trades by multiplying the changes</span>
</span><span id="Portfolio-247"><a href="#Portfolio-247"><span class="linenos">247</span></a><span class="sd">        in position (units) by the current prices.</span>
</span><span id="Portfolio-248"><a href="#Portfolio-248"><span class="linenos">248</span></a>
</span><span id="Portfolio-249"><a href="#Portfolio-249"><span class="linenos">249</span></a><span class="sd">        Returns</span>
</span><span id="Portfolio-250"><a href="#Portfolio-250"><span class="linenos">250</span></a><span class="sd">        -------</span>
</span><span id="Portfolio-251"><a href="#Portfolio-251"><span class="linenos">251</span></a><span class="sd">        pd.DataFrame</span>
</span><span id="Portfolio-252"><a href="#Portfolio-252"><span class="linenos">252</span></a><span class="sd">            DataFrame with the cash value of trades for each asset over time,</span>
</span><span id="Portfolio-253"><a href="#Portfolio-253"><span class="linenos">253</span></a><span class="sd">            with dates as index and assets as columns</span>
</span><span id="Portfolio-254"><a href="#Portfolio-254"><span class="linenos">254</span></a>
</span><span id="Portfolio-255"><a href="#Portfolio-255"><span class="linenos">255</span></a><span class="sd">        Notes</span>
</span><span id="Portfolio-256"><a href="#Portfolio-256"><span class="linenos">256</span></a><span class="sd">        -----</span>
</span><span id="Portfolio-257"><a href="#Portfolio-257"><span class="linenos">257</span></a><span class="sd">        Calculated by multiplying trades_units by prices.</span>
</span><span id="Portfolio-258"><a href="#Portfolio-258"><span class="linenos">258</span></a><span class="sd">        Positive values represent buys (cash outflows),</span>
</span><span id="Portfolio-259"><a href="#Portfolio-259"><span class="linenos">259</span></a><span class="sd">        negative values represent sells (cash inflows).</span>
</span><span id="Portfolio-260"><a href="#Portfolio-260"><span class="linenos">260</span></a>
</span><span id="Portfolio-261"><a href="#Portfolio-261"><span class="linenos">261</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Portfolio-262"><a href="#Portfolio-262"><span class="linenos">262</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">trades_units</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">prices</span>
</span><span id="Portfolio-263"><a href="#Portfolio-263"><span class="linenos">263</span></a>
</span><span id="Portfolio-264"><a href="#Portfolio-264"><span class="linenos">264</span></a>    <span class="nd">@property</span>
</span><span id="Portfolio-265"><a href="#Portfolio-265"><span class="linenos">265</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">turnover_relative</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
</span><span id="Portfolio-266"><a href="#Portfolio-266"><span class="linenos">266</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the turnover relative to the portfolio NAV.</span>
</span><span id="Portfolio-267"><a href="#Portfolio-267"><span class="linenos">267</span></a>
</span><span id="Portfolio-268"><a href="#Portfolio-268"><span class="linenos">268</span></a><span class="sd">        This calculates the trades as a percentage of the portfolio NAV,</span>
</span><span id="Portfolio-269"><a href="#Portfolio-269"><span class="linenos">269</span></a><span class="sd">        which provides a measure of trading activity relative to portfolio size.</span>
</span><span id="Portfolio-270"><a href="#Portfolio-270"><span class="linenos">270</span></a>
</span><span id="Portfolio-271"><a href="#Portfolio-271"><span class="linenos">271</span></a><span class="sd">        Returns</span>
</span><span id="Portfolio-272"><a href="#Portfolio-272"><span class="linenos">272</span></a><span class="sd">        -------</span>
</span><span id="Portfolio-273"><a href="#Portfolio-273"><span class="linenos">273</span></a><span class="sd">        pd.DataFrame</span>
</span><span id="Portfolio-274"><a href="#Portfolio-274"><span class="linenos">274</span></a><span class="sd">            DataFrame with the relative turnover for each asset over time,</span>
</span><span id="Portfolio-275"><a href="#Portfolio-275"><span class="linenos">275</span></a><span class="sd">            with dates as index and assets as columns</span>
</span><span id="Portfolio-276"><a href="#Portfolio-276"><span class="linenos">276</span></a>
</span><span id="Portfolio-277"><a href="#Portfolio-277"><span class="linenos">277</span></a><span class="sd">        Notes</span>
</span><span id="Portfolio-278"><a href="#Portfolio-278"><span class="linenos">278</span></a><span class="sd">        -----</span>
</span><span id="Portfolio-279"><a href="#Portfolio-279"><span class="linenos">279</span></a><span class="sd">        Calculated by dividing trades_currency by NAV.</span>
</span><span id="Portfolio-280"><a href="#Portfolio-280"><span class="linenos">280</span></a><span class="sd">        Positive values represent buys, negative values represent sells.</span>
</span><span id="Portfolio-281"><a href="#Portfolio-281"><span class="linenos">281</span></a><span class="sd">        A value of 0.05 means a buy equal to 5% of the portfolio NAV.</span>
</span><span id="Portfolio-282"><a href="#Portfolio-282"><span class="linenos">282</span></a>
</span><span id="Portfolio-283"><a href="#Portfolio-283"><span class="linenos">283</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Portfolio-284"><a href="#Portfolio-284"><span class="linenos">284</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">trades_currency</span><span class="o">.</span><span class="n">div</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nav</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="Portfolio-285"><a href="#Portfolio-285"><span class="linenos">285</span></a>
</span><span id="Portfolio-286"><a href="#Portfolio-286"><span class="linenos">286</span></a>    <span class="nd">@property</span>
</span><span id="Portfolio-287"><a href="#Portfolio-287"><span class="linenos">287</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">turnover</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
</span><span id="Portfolio-288"><a href="#Portfolio-288"><span class="linenos">288</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the absolute turnover in the portfolio.</span>
</span><span id="Portfolio-289"><a href="#Portfolio-289"><span class="linenos">289</span></a>
</span><span id="Portfolio-290"><a href="#Portfolio-290"><span class="linenos">290</span></a><span class="sd">        This calculates the absolute value of trades in currency terms,</span>
</span><span id="Portfolio-291"><a href="#Portfolio-291"><span class="linenos">291</span></a><span class="sd">        which provides a measure of total trading activity regardless of</span>
</span><span id="Portfolio-292"><a href="#Portfolio-292"><span class="linenos">292</span></a><span class="sd">        direction (buy or sell).</span>
</span><span id="Portfolio-293"><a href="#Portfolio-293"><span class="linenos">293</span></a>
</span><span id="Portfolio-294"><a href="#Portfolio-294"><span class="linenos">294</span></a><span class="sd">        Returns</span>
</span><span id="Portfolio-295"><a href="#Portfolio-295"><span class="linenos">295</span></a><span class="sd">        -------</span>
</span><span id="Portfolio-296"><a href="#Portfolio-296"><span class="linenos">296</span></a><span class="sd">        pd.DataFrame</span>
</span><span id="Portfolio-297"><a href="#Portfolio-297"><span class="linenos">297</span></a><span class="sd">            DataFrame with the absolute turnover for each asset over time,</span>
</span><span id="Portfolio-298"><a href="#Portfolio-298"><span class="linenos">298</span></a><span class="sd">            with dates as index and assets as columns</span>
</span><span id="Portfolio-299"><a href="#Portfolio-299"><span class="linenos">299</span></a>
</span><span id="Portfolio-300"><a href="#Portfolio-300"><span class="linenos">300</span></a><span class="sd">        Notes</span>
</span><span id="Portfolio-301"><a href="#Portfolio-301"><span class="linenos">301</span></a><span class="sd">        -----</span>
</span><span id="Portfolio-302"><a href="#Portfolio-302"><span class="linenos">302</span></a><span class="sd">        Calculated as the absolute value of trades_currency.</span>
</span><span id="Portfolio-303"><a href="#Portfolio-303"><span class="linenos">303</span></a><span class="sd">        This is useful for calculating trading costs that apply equally</span>
</span><span id="Portfolio-304"><a href="#Portfolio-304"><span class="linenos">304</span></a><span class="sd">        to buys and sells.</span>
</span><span id="Portfolio-305"><a href="#Portfolio-305"><span class="linenos">305</span></a>
</span><span id="Portfolio-306"><a href="#Portfolio-306"><span class="linenos">306</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Portfolio-307"><a href="#Portfolio-307"><span class="linenos">307</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">trades_currency</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span>
</span><span id="Portfolio-308"><a href="#Portfolio-308"><span class="linenos">308</span></a>
</span><span id="Portfolio-309"><a href="#Portfolio-309"><span class="linenos">309</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">time</span><span class="p">:</span> <span class="n">datetime</span> <span class="o">|</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">:</span>
</span><span id="Portfolio-310"><a href="#Portfolio-310"><span class="linenos">310</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the portfolio positions (units) at a specific time.</span>
</span><span id="Portfolio-311"><a href="#Portfolio-311"><span class="linenos">311</span></a>
</span><span id="Portfolio-312"><a href="#Portfolio-312"><span class="linenos">312</span></a><span class="sd">        This method allows for dictionary-like access to the portfolio positions</span>
</span><span id="Portfolio-313"><a href="#Portfolio-313"><span class="linenos">313</span></a><span class="sd">        at a specific time point using the syntax: portfolio[time].</span>
</span><span id="Portfolio-314"><a href="#Portfolio-314"><span class="linenos">314</span></a>
</span><span id="Portfolio-315"><a href="#Portfolio-315"><span class="linenos">315</span></a><span class="sd">        Parameters</span>
</span><span id="Portfolio-316"><a href="#Portfolio-316"><span class="linenos">316</span></a><span class="sd">        ----------</span>
</span><span id="Portfolio-317"><a href="#Portfolio-317"><span class="linenos">317</span></a><span class="sd">        time : Union[datetime, str, pd.Timestamp]</span>
</span><span id="Portfolio-318"><a href="#Portfolio-318"><span class="linenos">318</span></a><span class="sd">            The time index for which to retrieve the positions</span>
</span><span id="Portfolio-319"><a href="#Portfolio-319"><span class="linenos">319</span></a>
</span><span id="Portfolio-320"><a href="#Portfolio-320"><span class="linenos">320</span></a><span class="sd">        Returns</span>
</span><span id="Portfolio-321"><a href="#Portfolio-321"><span class="linenos">321</span></a><span class="sd">        -------</span>
</span><span id="Portfolio-322"><a href="#Portfolio-322"><span class="linenos">322</span></a><span class="sd">        pd.Series</span>
</span><span id="Portfolio-323"><a href="#Portfolio-323"><span class="linenos">323</span></a><span class="sd">            Series containing the positions (units) for each asset at the specified time</span>
</span><span id="Portfolio-324"><a href="#Portfolio-324"><span class="linenos">324</span></a>
</span><span id="Portfolio-325"><a href="#Portfolio-325"><span class="linenos">325</span></a><span class="sd">        Raises</span>
</span><span id="Portfolio-326"><a href="#Portfolio-326"><span class="linenos">326</span></a><span class="sd">        ------</span>
</span><span id="Portfolio-327"><a href="#Portfolio-327"><span class="linenos">327</span></a><span class="sd">        KeyError</span>
</span><span id="Portfolio-328"><a href="#Portfolio-328"><span class="linenos">328</span></a><span class="sd">            If the specified time is not in the portfolio&#39;s index</span>
</span><span id="Portfolio-329"><a href="#Portfolio-329"><span class="linenos">329</span></a>
</span><span id="Portfolio-330"><a href="#Portfolio-330"><span class="linenos">330</span></a><span class="sd">        Examples</span>
</span><span id="Portfolio-331"><a href="#Portfolio-331"><span class="linenos">331</span></a><span class="sd">        --------</span>
</span><span id="Portfolio-332"><a href="#Portfolio-332"><span class="linenos">332</span></a><span class="sd">        ```</span>
</span><span id="Portfolio-333"><a href="#Portfolio-333"><span class="linenos">333</span></a><span class="sd">        portfolio[&#39;2023-01-01&#39;]  # Get positions on January 1, 2023</span>
</span><span id="Portfolio-334"><a href="#Portfolio-334"><span class="linenos">334</span></a><span class="sd">        portfolio[pd.Timestamp(&#39;2023-01-01&#39;)]  # Same as above</span>
</span><span id="Portfolio-335"><a href="#Portfolio-335"><span class="linenos">335</span></a><span class="sd">        ```</span>
</span><span id="Portfolio-336"><a href="#Portfolio-336"><span class="linenos">336</span></a>
</span><span id="Portfolio-337"><a href="#Portfolio-337"><span class="linenos">337</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Portfolio-338"><a href="#Portfolio-338"><span class="linenos">338</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">time</span><span class="p">]</span>
</span><span id="Portfolio-339"><a href="#Portfolio-339"><span class="linenos">339</span></a>
</span><span id="Portfolio-340"><a href="#Portfolio-340"><span class="linenos">340</span></a>    <span class="nd">@property</span>
</span><span id="Portfolio-341"><a href="#Portfolio-341"><span class="linenos">341</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">equity</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
</span><span id="Portfolio-342"><a href="#Portfolio-342"><span class="linenos">342</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the equity (cash value) of each position over time.</span>
</span><span id="Portfolio-343"><a href="#Portfolio-343"><span class="linenos">343</span></a>
</span><span id="Portfolio-344"><a href="#Portfolio-344"><span class="linenos">344</span></a><span class="sd">        This property returns the cash value of each position in the portfolio,</span>
</span><span id="Portfolio-345"><a href="#Portfolio-345"><span class="linenos">345</span></a><span class="sd">        calculated by multiplying the number of units by the price for each asset.</span>
</span><span id="Portfolio-346"><a href="#Portfolio-346"><span class="linenos">346</span></a>
</span><span id="Portfolio-347"><a href="#Portfolio-347"><span class="linenos">347</span></a><span class="sd">        Returns</span>
</span><span id="Portfolio-348"><a href="#Portfolio-348"><span class="linenos">348</span></a><span class="sd">        -------</span>
</span><span id="Portfolio-349"><a href="#Portfolio-349"><span class="linenos">349</span></a><span class="sd">        pd.DataFrame</span>
</span><span id="Portfolio-350"><a href="#Portfolio-350"><span class="linenos">350</span></a><span class="sd">            DataFrame with the cash value of each position over time,</span>
</span><span id="Portfolio-351"><a href="#Portfolio-351"><span class="linenos">351</span></a><span class="sd">            with dates as index and assets as columns</span>
</span><span id="Portfolio-352"><a href="#Portfolio-352"><span class="linenos">352</span></a>
</span><span id="Portfolio-353"><a href="#Portfolio-353"><span class="linenos">353</span></a><span class="sd">        Notes</span>
</span><span id="Portfolio-354"><a href="#Portfolio-354"><span class="linenos">354</span></a><span class="sd">        -----</span>
</span><span id="Portfolio-355"><a href="#Portfolio-355"><span class="linenos">355</span></a><span class="sd">        This is an alias for the cashposition property and returns the same values.</span>
</span><span id="Portfolio-356"><a href="#Portfolio-356"><span class="linenos">356</span></a><span class="sd">        The term &quot;equity&quot; is used in the context of the cash value of positions,</span>
</span><span id="Portfolio-357"><a href="#Portfolio-357"><span class="linenos">357</span></a><span class="sd">        not to be confused with the equity asset class.</span>
</span><span id="Portfolio-358"><a href="#Portfolio-358"><span class="linenos">358</span></a>
</span><span id="Portfolio-359"><a href="#Portfolio-359"><span class="linenos">359</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Portfolio-360"><a href="#Portfolio-360"><span class="linenos">360</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">cashposition</span>
</span><span id="Portfolio-361"><a href="#Portfolio-361"><span class="linenos">361</span></a>
</span><span id="Portfolio-362"><a href="#Portfolio-362"><span class="linenos">362</span></a>    <span class="nd">@property</span>
</span><span id="Portfolio-363"><a href="#Portfolio-363"><span class="linenos">363</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">weights</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
</span><span id="Portfolio-364"><a href="#Portfolio-364"><span class="linenos">364</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the weight of each asset in the portfolio over time.</span>
</span><span id="Portfolio-365"><a href="#Portfolio-365"><span class="linenos">365</span></a>
</span><span id="Portfolio-366"><a href="#Portfolio-366"><span class="linenos">366</span></a><span class="sd">        This calculates the relative weight of each asset in the portfolio</span>
</span><span id="Portfolio-367"><a href="#Portfolio-367"><span class="linenos">367</span></a><span class="sd">        by dividing the cash value of each position by the total portfolio</span>
</span><span id="Portfolio-368"><a href="#Portfolio-368"><span class="linenos">368</span></a><span class="sd">        value (NAV) at each time point.</span>
</span><span id="Portfolio-369"><a href="#Portfolio-369"><span class="linenos">369</span></a>
</span><span id="Portfolio-370"><a href="#Portfolio-370"><span class="linenos">370</span></a><span class="sd">        Returns</span>
</span><span id="Portfolio-371"><a href="#Portfolio-371"><span class="linenos">371</span></a><span class="sd">        -------</span>
</span><span id="Portfolio-372"><a href="#Portfolio-372"><span class="linenos">372</span></a><span class="sd">        pd.DataFrame</span>
</span><span id="Portfolio-373"><a href="#Portfolio-373"><span class="linenos">373</span></a><span class="sd">            DataFrame with the weight of each asset over time,</span>
</span><span id="Portfolio-374"><a href="#Portfolio-374"><span class="linenos">374</span></a><span class="sd">            with dates as index and assets as columns</span>
</span><span id="Portfolio-375"><a href="#Portfolio-375"><span class="linenos">375</span></a>
</span><span id="Portfolio-376"><a href="#Portfolio-376"><span class="linenos">376</span></a><span class="sd">        Notes</span>
</span><span id="Portfolio-377"><a href="#Portfolio-377"><span class="linenos">377</span></a><span class="sd">        -----</span>
</span><span id="Portfolio-378"><a href="#Portfolio-378"><span class="linenos">378</span></a><span class="sd">        The sum of weights across all assets at any given time should equal 1.0</span>
</span><span id="Portfolio-379"><a href="#Portfolio-379"><span class="linenos">379</span></a><span class="sd">        for a fully invested portfolio with no leverage. Weights can be negative</span>
</span><span id="Portfolio-380"><a href="#Portfolio-380"><span class="linenos">380</span></a><span class="sd">        for short positions.</span>
</span><span id="Portfolio-381"><a href="#Portfolio-381"><span class="linenos">381</span></a>
</span><span id="Portfolio-382"><a href="#Portfolio-382"><span class="linenos">382</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Portfolio-383"><a href="#Portfolio-383"><span class="linenos">383</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">equity</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">nav</span><span class="p">)</span>
</span><span id="Portfolio-384"><a href="#Portfolio-384"><span class="linenos">384</span></a>
</span><span id="Portfolio-385"><a href="#Portfolio-385"><span class="linenos">385</span></a>    <span class="nd">@property</span>
</span><span id="Portfolio-386"><a href="#Portfolio-386"><span class="linenos">386</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">stats</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Portfolio-387"><a href="#Portfolio-387"><span class="linenos">387</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get statistical analysis data for the portfolio.</span>
</span><span id="Portfolio-388"><a href="#Portfolio-388"><span class="linenos">388</span></a>
</span><span id="Portfolio-389"><a href="#Portfolio-389"><span class="linenos">389</span></a><span class="sd">        This property provides access to various statistical metrics calculated</span>
</span><span id="Portfolio-390"><a href="#Portfolio-390"><span class="linenos">390</span></a><span class="sd">        for the portfolio, such as Sharpe ratio, volatility, drawdowns, etc.</span>
</span><span id="Portfolio-391"><a href="#Portfolio-391"><span class="linenos">391</span></a>
</span><span id="Portfolio-392"><a href="#Portfolio-392"><span class="linenos">392</span></a><span class="sd">        Returns</span>
</span><span id="Portfolio-393"><a href="#Portfolio-393"><span class="linenos">393</span></a><span class="sd">        -------</span>
</span><span id="Portfolio-394"><a href="#Portfolio-394"><span class="linenos">394</span></a><span class="sd">        object</span>
</span><span id="Portfolio-395"><a href="#Portfolio-395"><span class="linenos">395</span></a><span class="sd">            An object containing various statistical metrics for the portfolio</span>
</span><span id="Portfolio-396"><a href="#Portfolio-396"><span class="linenos">396</span></a>
</span><span id="Portfolio-397"><a href="#Portfolio-397"><span class="linenos">397</span></a><span class="sd">        Notes</span>
</span><span id="Portfolio-398"><a href="#Portfolio-398"><span class="linenos">398</span></a><span class="sd">        -----</span>
</span><span id="Portfolio-399"><a href="#Portfolio-399"><span class="linenos">399</span></a><span class="sd">        The statistics are calculated by the underlying jquantstats library</span>
</span><span id="Portfolio-400"><a href="#Portfolio-400"><span class="linenos">400</span></a><span class="sd">        and are based on the portfolio&#39;s NAV time series.</span>
</span><span id="Portfolio-401"><a href="#Portfolio-401"><span class="linenos">401</span></a>
</span><span id="Portfolio-402"><a href="#Portfolio-402"><span class="linenos">402</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Portfolio-403"><a href="#Portfolio-403"><span class="linenos">403</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="o">.</span><span class="n">stats</span>
</span><span id="Portfolio-404"><a href="#Portfolio-404"><span class="linenos">404</span></a>
</span><span id="Portfolio-405"><a href="#Portfolio-405"><span class="linenos">405</span></a>    <span class="nd">@property</span>
</span><span id="Portfolio-406"><a href="#Portfolio-406"><span class="linenos">406</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">plots</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Portfolio-407"><a href="#Portfolio-407"><span class="linenos">407</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get visualization tools for the portfolio.</span>
</span><span id="Portfolio-408"><a href="#Portfolio-408"><span class="linenos">408</span></a>
</span><span id="Portfolio-409"><a href="#Portfolio-409"><span class="linenos">409</span></a><span class="sd">        This property provides access to various plotting functions for visualizing</span>
</span><span id="Portfolio-410"><a href="#Portfolio-410"><span class="linenos">410</span></a><span class="sd">        the portfolio&#39;s performance, returns, drawdowns, etc.</span>
</span><span id="Portfolio-411"><a href="#Portfolio-411"><span class="linenos">411</span></a>
</span><span id="Portfolio-412"><a href="#Portfolio-412"><span class="linenos">412</span></a><span class="sd">        Returns</span>
</span><span id="Portfolio-413"><a href="#Portfolio-413"><span class="linenos">413</span></a><span class="sd">        -------</span>
</span><span id="Portfolio-414"><a href="#Portfolio-414"><span class="linenos">414</span></a><span class="sd">        object</span>
</span><span id="Portfolio-415"><a href="#Portfolio-415"><span class="linenos">415</span></a><span class="sd">            An object containing various plotting methods for the portfolio</span>
</span><span id="Portfolio-416"><a href="#Portfolio-416"><span class="linenos">416</span></a>
</span><span id="Portfolio-417"><a href="#Portfolio-417"><span class="linenos">417</span></a><span class="sd">        Notes</span>
</span><span id="Portfolio-418"><a href="#Portfolio-418"><span class="linenos">418</span></a><span class="sd">        -----</span>
</span><span id="Portfolio-419"><a href="#Portfolio-419"><span class="linenos">419</span></a><span class="sd">        The plotting functions are provided by the underlying jquantstats library</span>
</span><span id="Portfolio-420"><a href="#Portfolio-420"><span class="linenos">420</span></a><span class="sd">        and operate on the portfolio&#39;s NAV time series.</span>
</span><span id="Portfolio-421"><a href="#Portfolio-421"><span class="linenos">421</span></a>
</span><span id="Portfolio-422"><a href="#Portfolio-422"><span class="linenos">422</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Portfolio-423"><a href="#Portfolio-423"><span class="linenos">423</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="o">.</span><span class="n">plots</span>
</span><span id="Portfolio-424"><a href="#Portfolio-424"><span class="linenos">424</span></a>
</span><span id="Portfolio-425"><a href="#Portfolio-425"><span class="linenos">425</span></a>    <span class="nd">@property</span>
</span><span id="Portfolio-426"><a href="#Portfolio-426"><span class="linenos">426</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">reports</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Portfolio-427"><a href="#Portfolio-427"><span class="linenos">427</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get reporting tools for the portfolio.</span>
</span><span id="Portfolio-428"><a href="#Portfolio-428"><span class="linenos">428</span></a>
</span><span id="Portfolio-429"><a href="#Portfolio-429"><span class="linenos">429</span></a><span class="sd">        This property provides access to various reporting functions for generating</span>
</span><span id="Portfolio-430"><a href="#Portfolio-430"><span class="linenos">430</span></a><span class="sd">        performance reports, risk metrics, and other analytics for the portfolio.</span>
</span><span id="Portfolio-431"><a href="#Portfolio-431"><span class="linenos">431</span></a>
</span><span id="Portfolio-432"><a href="#Portfolio-432"><span class="linenos">432</span></a><span class="sd">        Returns</span>
</span><span id="Portfolio-433"><a href="#Portfolio-433"><span class="linenos">433</span></a><span class="sd">        -------</span>
</span><span id="Portfolio-434"><a href="#Portfolio-434"><span class="linenos">434</span></a><span class="sd">        object</span>
</span><span id="Portfolio-435"><a href="#Portfolio-435"><span class="linenos">435</span></a><span class="sd">            An object containing various reporting methods for the portfolio</span>
</span><span id="Portfolio-436"><a href="#Portfolio-436"><span class="linenos">436</span></a>
</span><span id="Portfolio-437"><a href="#Portfolio-437"><span class="linenos">437</span></a><span class="sd">        Notes</span>
</span><span id="Portfolio-438"><a href="#Portfolio-438"><span class="linenos">438</span></a><span class="sd">        -----</span>
</span><span id="Portfolio-439"><a href="#Portfolio-439"><span class="linenos">439</span></a><span class="sd">        The reporting functions are provided by the underlying jquantstats library</span>
</span><span id="Portfolio-440"><a href="#Portfolio-440"><span class="linenos">440</span></a><span class="sd">        and operate on the portfolio&#39;s NAV time series.</span>
</span><span id="Portfolio-441"><a href="#Portfolio-441"><span class="linenos">441</span></a>
</span><span id="Portfolio-442"><a href="#Portfolio-442"><span class="linenos">442</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Portfolio-443"><a href="#Portfolio-443"><span class="linenos">443</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="o">.</span><span class="n">reports</span>
</span><span id="Portfolio-444"><a href="#Portfolio-444"><span class="linenos">444</span></a>
</span><span id="Portfolio-445"><a href="#Portfolio-445"><span class="linenos">445</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">sharpe</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="Portfolio-446"><a href="#Portfolio-446"><span class="linenos">446</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Calculate the Sharpe ratio for the portfolio.</span>
</span><span id="Portfolio-447"><a href="#Portfolio-447"><span class="linenos">447</span></a>
</span><span id="Portfolio-448"><a href="#Portfolio-448"><span class="linenos">448</span></a><span class="sd">        The Sharpe ratio is a measure of risk-adjusted return, calculated as</span>
</span><span id="Portfolio-449"><a href="#Portfolio-449"><span class="linenos">449</span></a><span class="sd">        the portfolio&#39;s excess return divided by its volatility.</span>
</span><span id="Portfolio-450"><a href="#Portfolio-450"><span class="linenos">450</span></a>
</span><span id="Portfolio-451"><a href="#Portfolio-451"><span class="linenos">451</span></a><span class="sd">        Parameters</span>
</span><span id="Portfolio-452"><a href="#Portfolio-452"><span class="linenos">452</span></a><span class="sd">        ----------</span>
</span><span id="Portfolio-453"><a href="#Portfolio-453"><span class="linenos">453</span></a><span class="sd">        periods : int, optional</span>
</span><span id="Portfolio-454"><a href="#Portfolio-454"><span class="linenos">454</span></a><span class="sd">            The number of periods per year for annualization.</span>
</span><span id="Portfolio-455"><a href="#Portfolio-455"><span class="linenos">455</span></a><span class="sd">            For daily data, use 252; for weekly data, use 52; for monthly data, use 12.</span>
</span><span id="Portfolio-456"><a href="#Portfolio-456"><span class="linenos">456</span></a><span class="sd">            If None, no annualization is performed.</span>
</span><span id="Portfolio-457"><a href="#Portfolio-457"><span class="linenos">457</span></a>
</span><span id="Portfolio-458"><a href="#Portfolio-458"><span class="linenos">458</span></a><span class="sd">        Returns</span>
</span><span id="Portfolio-459"><a href="#Portfolio-459"><span class="linenos">459</span></a><span class="sd">        -------</span>
</span><span id="Portfolio-460"><a href="#Portfolio-460"><span class="linenos">460</span></a><span class="sd">        float</span>
</span><span id="Portfolio-461"><a href="#Portfolio-461"><span class="linenos">461</span></a><span class="sd">            The Sharpe ratio of the portfolio</span>
</span><span id="Portfolio-462"><a href="#Portfolio-462"><span class="linenos">462</span></a>
</span><span id="Portfolio-463"><a href="#Portfolio-463"><span class="linenos">463</span></a><span class="sd">        Notes</span>
</span><span id="Portfolio-464"><a href="#Portfolio-464"><span class="linenos">464</span></a><span class="sd">        -----</span>
</span><span id="Portfolio-465"><a href="#Portfolio-465"><span class="linenos">465</span></a><span class="sd">        The Sharpe ratio is calculated using the portfolio&#39;s NAV time series.</span>
</span><span id="Portfolio-466"><a href="#Portfolio-466"><span class="linenos">466</span></a><span class="sd">        A higher Sharpe ratio indicates better risk-adjusted performance.</span>
</span><span id="Portfolio-467"><a href="#Portfolio-467"><span class="linenos">467</span></a>
</span><span id="Portfolio-468"><a href="#Portfolio-468"><span class="linenos">468</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Portfolio-469"><a href="#Portfolio-469"><span class="linenos">469</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">sharpe</span><span class="p">(</span><span class="n">periods</span><span class="o">=</span><span class="n">periods</span><span class="p">)[</span><span class="s2">&quot;NAV&quot;</span><span class="p">]</span>
</span><span id="Portfolio-470"><a href="#Portfolio-470"><span class="linenos">470</span></a>
</span><span id="Portfolio-471"><a href="#Portfolio-471"><span class="linenos">471</span></a>    <span class="nd">@classmethod</span>
</span><span id="Portfolio-472"><a href="#Portfolio-472"><span class="linenos">472</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">from_cashpos_prices</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">prices</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">cashposition</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">aum</span><span class="p">:</span> <span class="nb">float</span><span class="p">):</span>
</span><span id="Portfolio-473"><a href="#Portfolio-473"><span class="linenos">473</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a Portfolio instance from cash positions and prices.</span>
</span><span id="Portfolio-474"><a href="#Portfolio-474"><span class="linenos">474</span></a>
</span><span id="Portfolio-475"><a href="#Portfolio-475"><span class="linenos">475</span></a><span class="sd">        This class method provides an alternative way to create a Portfolio instance</span>
</span><span id="Portfolio-476"><a href="#Portfolio-476"><span class="linenos">476</span></a><span class="sd">        when you have the cash positions rather than the number of units.</span>
</span><span id="Portfolio-477"><a href="#Portfolio-477"><span class="linenos">477</span></a>
</span><span id="Portfolio-478"><a href="#Portfolio-478"><span class="linenos">478</span></a><span class="sd">        Parameters</span>
</span><span id="Portfolio-479"><a href="#Portfolio-479"><span class="linenos">479</span></a><span class="sd">        ----------</span>
</span><span id="Portfolio-480"><a href="#Portfolio-480"><span class="linenos">480</span></a><span class="sd">        prices : pd.DataFrame</span>
</span><span id="Portfolio-481"><a href="#Portfolio-481"><span class="linenos">481</span></a><span class="sd">            DataFrame of asset prices over time, with dates as index and assets as columns</span>
</span><span id="Portfolio-482"><a href="#Portfolio-482"><span class="linenos">482</span></a><span class="sd">        cashposition : pd.DataFrame</span>
</span><span id="Portfolio-483"><a href="#Portfolio-483"><span class="linenos">483</span></a><span class="sd">            DataFrame of cash positions over time, with dates as index and assets as columns</span>
</span><span id="Portfolio-484"><a href="#Portfolio-484"><span class="linenos">484</span></a><span class="sd">        aum : float</span>
</span><span id="Portfolio-485"><a href="#Portfolio-485"><span class="linenos">485</span></a><span class="sd">            Assets under management</span>
</span><span id="Portfolio-486"><a href="#Portfolio-486"><span class="linenos">486</span></a>
</span><span id="Portfolio-487"><a href="#Portfolio-487"><span class="linenos">487</span></a><span class="sd">        Returns</span>
</span><span id="Portfolio-488"><a href="#Portfolio-488"><span class="linenos">488</span></a><span class="sd">        -------</span>
</span><span id="Portfolio-489"><a href="#Portfolio-489"><span class="linenos">489</span></a><span class="sd">        Portfolio</span>
</span><span id="Portfolio-490"><a href="#Portfolio-490"><span class="linenos">490</span></a><span class="sd">            A new Portfolio instance with units calculated from cash positions and prices</span>
</span><span id="Portfolio-491"><a href="#Portfolio-491"><span class="linenos">491</span></a>
</span><span id="Portfolio-492"><a href="#Portfolio-492"><span class="linenos">492</span></a><span class="sd">        Notes</span>
</span><span id="Portfolio-493"><a href="#Portfolio-493"><span class="linenos">493</span></a><span class="sd">        -----</span>
</span><span id="Portfolio-494"><a href="#Portfolio-494"><span class="linenos">494</span></a><span class="sd">        The units are calculated by dividing the cash positions by the prices.</span>
</span><span id="Portfolio-495"><a href="#Portfolio-495"><span class="linenos">495</span></a><span class="sd">        This is useful when you have the monetary value of each position rather</span>
</span><span id="Portfolio-496"><a href="#Portfolio-496"><span class="linenos">496</span></a><span class="sd">        than the number of units.</span>
</span><span id="Portfolio-497"><a href="#Portfolio-497"><span class="linenos">497</span></a>
</span><span id="Portfolio-498"><a href="#Portfolio-498"><span class="linenos">498</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Portfolio-499"><a href="#Portfolio-499"><span class="linenos">499</span></a>        <span class="n">units</span> <span class="o">=</span> <span class="n">cashposition</span><span class="o">.</span><span class="n">div</span><span class="p">(</span><span class="n">prices</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="mf">0.0</span><span class="p">)</span>
</span><span id="Portfolio-500"><a href="#Portfolio-500"><span class="linenos">500</span></a>        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">prices</span><span class="o">=</span><span class="n">prices</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="n">units</span><span class="p">,</span> <span class="n">aum</span><span class="o">=</span><span class="n">aum</span><span class="p">)</span>
</span><span id="Portfolio-501"><a href="#Portfolio-501"><span class="linenos">501</span></a>
</span><span id="Portfolio-502"><a href="#Portfolio-502"><span class="linenos">502</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">snapshot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">title</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;Portfolio Summary&quot;</span><span class="p">,</span> <span class="n">log_scale</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">):</span>
</span><span id="Portfolio-503"><a href="#Portfolio-503"><span class="linenos">503</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Generate and display a snapshot of the portfolio summary.</span>
</span><span id="Portfolio-504"><a href="#Portfolio-504"><span class="linenos">504</span></a>
</span><span id="Portfolio-505"><a href="#Portfolio-505"><span class="linenos">505</span></a><span class="sd">        This method creates a visual representation of the portfolio summary</span>
</span><span id="Portfolio-506"><a href="#Portfolio-506"><span class="linenos">506</span></a><span class="sd">        using the associated plot functionalities. The snapshot can be</span>
</span><span id="Portfolio-507"><a href="#Portfolio-507"><span class="linenos">507</span></a><span class="sd">        configured with a title and whether to use a logarithmic scale.</span>
</span><span id="Portfolio-508"><a href="#Portfolio-508"><span class="linenos">508</span></a>
</span><span id="Portfolio-509"><a href="#Portfolio-509"><span class="linenos">509</span></a><span class="sd">        Args:</span>
</span><span id="Portfolio-510"><a href="#Portfolio-510"><span class="linenos">510</span></a><span class="sd">            title: A string specifying the title of the snapshot.</span>
</span><span id="Portfolio-511"><a href="#Portfolio-511"><span class="linenos">511</span></a><span class="sd">                   Default is &quot;Portfolio Summary&quot;.</span>
</span><span id="Portfolio-512"><a href="#Portfolio-512"><span class="linenos">512</span></a><span class="sd">            log_scale: A boolean indicating whether to display the plot</span>
</span><span id="Portfolio-513"><a href="#Portfolio-513"><span class="linenos">513</span></a><span class="sd">                       using a logarithmic scale. Default is True.</span>
</span><span id="Portfolio-514"><a href="#Portfolio-514"><span class="linenos">514</span></a>
</span><span id="Portfolio-515"><a href="#Portfolio-515"><span class="linenos">515</span></a><span class="sd">        Returns:</span>
</span><span id="Portfolio-516"><a href="#Portfolio-516"><span class="linenos">516</span></a><span class="sd">            The generated plot object representing the portfolio snapshot.</span>
</span><span id="Portfolio-517"><a href="#Portfolio-517"><span class="linenos">517</span></a>
</span><span id="Portfolio-518"><a href="#Portfolio-518"><span class="linenos">518</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Portfolio-519"><a href="#Portfolio-519"><span class="linenos">519</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">plots</span><span class="o">.</span><span class="n">plot_snapshot</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">log_scale</span><span class="o">=</span><span class="n">log_scale</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Represents a portfolio of assets with methods for analysis and visualization.</p>

<p>The Portfolio class is a frozen dataclass (immutable) that represents a portfolio
of assets with their prices and positions (units). It provides methods for
calculating various metrics like NAV, profit, drawdown, and for visualizing
the portfolio's performance.</p>

<h2 id="attributes">Attributes</h2>

<p>prices : pd.DataFrame
    DataFrame of asset prices over time, with dates as index and assets as columns
units : pd.DataFrame
    DataFrame of asset positions (units) over time, with dates as index and assets as columns
aum : Union[float, pd.Series]
    Assets under management, either as a constant float or as a Series over time</p>
</div>


                            <div id="Portfolio.__init__" class="classattr">
                                <div class="attr function">
            
        <span class="name">Portfolio</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">prices</span><span class="p">:</span> <span class="n">pandas</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">DataFrame</span>,</span><span class="param">	<span class="n">units</span><span class="p">:</span> <span class="n">pandas</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">DataFrame</span>,</span><span class="param">	<span class="n">aum</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="n">pandas</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">series</span><span class="o">.</span><span class="n">Series</span></span>)</span>

        
    </div>
    <a class="headerlink" href="#Portfolio.__init__"></a>
    
    

                            </div>
                            <div id="Portfolio.prices" class="classattr">
                                <div class="attr variable">
            <span class="name">prices</span><span class="annotation">: pandas.core.frame.DataFrame</span>

        
    </div>
    <a class="headerlink" href="#Portfolio.prices"></a>
    
    

                            </div>
                            <div id="Portfolio.units" class="classattr">
                                <div class="attr variable">
            <span class="name">units</span><span class="annotation">: pandas.core.frame.DataFrame</span>

        
    </div>
    <a class="headerlink" href="#Portfolio.units"></a>
    
    

                            </div>
                            <div id="Portfolio.aum" class="classattr">
                                <div class="attr variable">
            <span class="name">aum</span><span class="annotation">: float | pandas.core.series.Series</span>

        
    </div>
    <a class="headerlink" href="#Portfolio.aum"></a>
    
    

                            </div>
                            <div id="Portfolio.index" class="classattr">
                                        <input id="Portfolio.index-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">index</span><span class="annotation">: list[datetime.datetime]</span>

                <label class="view-source-button" for="Portfolio.index-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Portfolio.index"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Portfolio.index-104"><a href="#Portfolio.index-104"><span class="linenos">104</span></a>    <span class="nd">@property</span>
</span><span id="Portfolio.index-105"><a href="#Portfolio.index-105"><span class="linenos">105</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">index</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">datetime</span><span class="p">]:</span>
</span><span id="Portfolio.index-106"><a href="#Portfolio.index-106"><span class="linenos">106</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the time index of the portfolio.</span>
</span><span id="Portfolio.index-107"><a href="#Portfolio.index-107"><span class="linenos">107</span></a>
</span><span id="Portfolio.index-108"><a href="#Portfolio.index-108"><span class="linenos">108</span></a><span class="sd">        Returns</span>
</span><span id="Portfolio.index-109"><a href="#Portfolio.index-109"><span class="linenos">109</span></a><span class="sd">        -------</span>
</span><span id="Portfolio.index-110"><a href="#Portfolio.index-110"><span class="linenos">110</span></a><span class="sd">        pd.DatetimeIndex</span>
</span><span id="Portfolio.index-111"><a href="#Portfolio.index-111"><span class="linenos">111</span></a><span class="sd">            A DatetimeIndex representing the time period for which portfolio</span>
</span><span id="Portfolio.index-112"><a href="#Portfolio.index-112"><span class="linenos">112</span></a><span class="sd">            data is available</span>
</span><span id="Portfolio.index-113"><a href="#Portfolio.index-113"><span class="linenos">113</span></a>
</span><span id="Portfolio.index-114"><a href="#Portfolio.index-114"><span class="linenos">114</span></a><span class="sd">        Notes</span>
</span><span id="Portfolio.index-115"><a href="#Portfolio.index-115"><span class="linenos">115</span></a><span class="sd">        -----</span>
</span><span id="Portfolio.index-116"><a href="#Portfolio.index-116"><span class="linenos">116</span></a><span class="sd">        This property extracts the index from the prices DataFrame, which</span>
</span><span id="Portfolio.index-117"><a href="#Portfolio.index-117"><span class="linenos">117</span></a><span class="sd">        represents all time points in the portfolio history.</span>
</span><span id="Portfolio.index-118"><a href="#Portfolio.index-118"><span class="linenos">118</span></a>
</span><span id="Portfolio.index-119"><a href="#Portfolio.index-119"><span class="linenos">119</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Portfolio.index-120"><a href="#Portfolio.index-120"><span class="linenos">120</span></a>        <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DatetimeIndex</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">prices</span><span class="o">.</span><span class="n">index</span><span class="p">)</span><span class="o">.</span><span class="n">to_list</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>Get the time index of the portfolio.</p>

<h2 id="returns">Returns</h2>

<p>pd.DatetimeIndex
    A DatetimeIndex representing the time period for which portfolio
    data is available</p>

<h2 id="notes">Notes</h2>

<p>This property extracts the index from the prices DataFrame, which
represents all time points in the portfolio history.</p>
</div>


                            </div>
                            <div id="Portfolio.assets" class="classattr">
                                        <input id="Portfolio.assets-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">assets</span><span class="annotation">: list[str]</span>

                <label class="view-source-button" for="Portfolio.assets-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Portfolio.assets"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Portfolio.assets-122"><a href="#Portfolio.assets-122"><span class="linenos">122</span></a>    <span class="nd">@property</span>
</span><span id="Portfolio.assets-123"><a href="#Portfolio.assets-123"><span class="linenos">123</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">assets</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="Portfolio.assets-124"><a href="#Portfolio.assets-124"><span class="linenos">124</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the list of assets in the portfolio.</span>
</span><span id="Portfolio.assets-125"><a href="#Portfolio.assets-125"><span class="linenos">125</span></a>
</span><span id="Portfolio.assets-126"><a href="#Portfolio.assets-126"><span class="linenos">126</span></a><span class="sd">        Returns</span>
</span><span id="Portfolio.assets-127"><a href="#Portfolio.assets-127"><span class="linenos">127</span></a><span class="sd">        -------</span>
</span><span id="Portfolio.assets-128"><a href="#Portfolio.assets-128"><span class="linenos">128</span></a><span class="sd">        pd.Index</span>
</span><span id="Portfolio.assets-129"><a href="#Portfolio.assets-129"><span class="linenos">129</span></a><span class="sd">            An Index containing the names of all assets in the portfolio</span>
</span><span id="Portfolio.assets-130"><a href="#Portfolio.assets-130"><span class="linenos">130</span></a>
</span><span id="Portfolio.assets-131"><a href="#Portfolio.assets-131"><span class="linenos">131</span></a><span class="sd">        Notes</span>
</span><span id="Portfolio.assets-132"><a href="#Portfolio.assets-132"><span class="linenos">132</span></a><span class="sd">        -----</span>
</span><span id="Portfolio.assets-133"><a href="#Portfolio.assets-133"><span class="linenos">133</span></a><span class="sd">        This property extracts the column names from the prices DataFrame,</span>
</span><span id="Portfolio.assets-134"><a href="#Portfolio.assets-134"><span class="linenos">134</span></a><span class="sd">        which correspond to all assets for which price data is available.</span>
</span><span id="Portfolio.assets-135"><a href="#Portfolio.assets-135"><span class="linenos">135</span></a>
</span><span id="Portfolio.assets-136"><a href="#Portfolio.assets-136"><span class="linenos">136</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Portfolio.assets-137"><a href="#Portfolio.assets-137"><span class="linenos">137</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">prices</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">to_list</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>Get the list of assets in the portfolio.</p>

<h2 id="returns">Returns</h2>

<p>pd.Index
    An Index containing the names of all assets in the portfolio</p>

<h2 id="notes">Notes</h2>

<p>This property extracts the column names from the prices DataFrame,
which correspond to all assets for which price data is available.</p>
</div>


                            </div>
                            <div id="Portfolio.nav" class="classattr">
                                        <input id="Portfolio.nav-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">nav</span><span class="annotation">: pandas.core.series.Series</span>

                <label class="view-source-button" for="Portfolio.nav-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Portfolio.nav"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Portfolio.nav-139"><a href="#Portfolio.nav-139"><span class="linenos">139</span></a>    <span class="nd">@property</span>
</span><span id="Portfolio.nav-140"><a href="#Portfolio.nav-140"><span class="linenos">140</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">nav</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">:</span>
</span><span id="Portfolio.nav-141"><a href="#Portfolio.nav-141"><span class="linenos">141</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the net asset value (NAV) of the portfolio over time.</span>
</span><span id="Portfolio.nav-142"><a href="#Portfolio.nav-142"><span class="linenos">142</span></a>
</span><span id="Portfolio.nav-143"><a href="#Portfolio.nav-143"><span class="linenos">143</span></a><span class="sd">        The NAV represents the total value of the portfolio at each point in time.</span>
</span><span id="Portfolio.nav-144"><a href="#Portfolio.nav-144"><span class="linenos">144</span></a><span class="sd">        If aum is provided as a Series, it is used directly. Otherwise, the NAV</span>
</span><span id="Portfolio.nav-145"><a href="#Portfolio.nav-145"><span class="linenos">145</span></a><span class="sd">        is calculated from the cumulative profit plus the initial aum.</span>
</span><span id="Portfolio.nav-146"><a href="#Portfolio.nav-146"><span class="linenos">146</span></a>
</span><span id="Portfolio.nav-147"><a href="#Portfolio.nav-147"><span class="linenos">147</span></a><span class="sd">        Returns</span>
</span><span id="Portfolio.nav-148"><a href="#Portfolio.nav-148"><span class="linenos">148</span></a><span class="sd">        -------</span>
</span><span id="Portfolio.nav-149"><a href="#Portfolio.nav-149"><span class="linenos">149</span></a><span class="sd">        pd.Series</span>
</span><span id="Portfolio.nav-150"><a href="#Portfolio.nav-150"><span class="linenos">150</span></a><span class="sd">            Series representing the NAV of the portfolio over time</span>
</span><span id="Portfolio.nav-151"><a href="#Portfolio.nav-151"><span class="linenos">151</span></a>
</span><span id="Portfolio.nav-152"><a href="#Portfolio.nav-152"><span class="linenos">152</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Portfolio.nav-153"><a href="#Portfolio.nav-153"><span class="linenos">153</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">aum</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">):</span>
</span><span id="Portfolio.nav-154"><a href="#Portfolio.nav-154"><span class="linenos">154</span></a>            <span class="n">series</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">aum</span>
</span><span id="Portfolio.nav-155"><a href="#Portfolio.nav-155"><span class="linenos">155</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Portfolio.nav-156"><a href="#Portfolio.nav-156"><span class="linenos">156</span></a>            <span class="n">profit</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cashposition</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">returns</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mf">0.0</span><span class="p">))</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="Portfolio.nav-157"><a href="#Portfolio.nav-157"><span class="linenos">157</span></a>            <span class="n">series</span> <span class="o">=</span> <span class="n">profit</span><span class="o">.</span><span class="n">cumsum</span><span class="p">()</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">aum</span>
</span><span id="Portfolio.nav-158"><a href="#Portfolio.nav-158"><span class="linenos">158</span></a>
</span><span id="Portfolio.nav-159"><a href="#Portfolio.nav-159"><span class="linenos">159</span></a>        <span class="n">series</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;NAV&quot;</span>
</span><span id="Portfolio.nav-160"><a href="#Portfolio.nav-160"><span class="linenos">160</span></a>        <span class="k">return</span> <span class="n">series</span>
</span></pre></div>


            <div class="docstring"><p>Get the net asset value (NAV) of the portfolio over time.</p>

<p>The NAV represents the total value of the portfolio at each point in time.
If aum is provided as a Series, it is used directly. Otherwise, the NAV
is calculated from the cumulative profit plus the initial aum.</p>

<h2 id="returns">Returns</h2>

<p>pd.Series
    Series representing the NAV of the portfolio over time</p>
</div>


                            </div>
                            <div id="Portfolio.profit" class="classattr">
                                        <input id="Portfolio.profit-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">profit</span><span class="annotation">: pandas.core.series.Series</span>

                <label class="view-source-button" for="Portfolio.profit-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Portfolio.profit"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Portfolio.profit-162"><a href="#Portfolio.profit-162"><span class="linenos">162</span></a>    <span class="nd">@property</span>
</span><span id="Portfolio.profit-163"><a href="#Portfolio.profit-163"><span class="linenos">163</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">profit</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">:</span>
</span><span id="Portfolio.profit-164"><a href="#Portfolio.profit-164"><span class="linenos">164</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the profit/loss of the portfolio at each time point.</span>
</span><span id="Portfolio.profit-165"><a href="#Portfolio.profit-165"><span class="linenos">165</span></a>
</span><span id="Portfolio.profit-166"><a href="#Portfolio.profit-166"><span class="linenos">166</span></a><span class="sd">        This calculates the profit or loss at each time point based on the</span>
</span><span id="Portfolio.profit-167"><a href="#Portfolio.profit-167"><span class="linenos">167</span></a><span class="sd">        previous positions and the returns of each asset.</span>
</span><span id="Portfolio.profit-168"><a href="#Portfolio.profit-168"><span class="linenos">168</span></a>
</span><span id="Portfolio.profit-169"><a href="#Portfolio.profit-169"><span class="linenos">169</span></a><span class="sd">        Returns</span>
</span><span id="Portfolio.profit-170"><a href="#Portfolio.profit-170"><span class="linenos">170</span></a><span class="sd">        -------</span>
</span><span id="Portfolio.profit-171"><a href="#Portfolio.profit-171"><span class="linenos">171</span></a><span class="sd">        pd.Series</span>
</span><span id="Portfolio.profit-172"><a href="#Portfolio.profit-172"><span class="linenos">172</span></a><span class="sd">            Series representing the profit/loss at each time point</span>
</span><span id="Portfolio.profit-173"><a href="#Portfolio.profit-173"><span class="linenos">173</span></a>
</span><span id="Portfolio.profit-174"><a href="#Portfolio.profit-174"><span class="linenos">174</span></a><span class="sd">        Notes</span>
</span><span id="Portfolio.profit-175"><a href="#Portfolio.profit-175"><span class="linenos">175</span></a><span class="sd">        -----</span>
</span><span id="Portfolio.profit-176"><a href="#Portfolio.profit-176"><span class="linenos">176</span></a><span class="sd">        The profit is calculated by multiplying the previous day&#39;s positions</span>
</span><span id="Portfolio.profit-177"><a href="#Portfolio.profit-177"><span class="linenos">177</span></a><span class="sd">        (in currency terms) by the returns of each asset, and then summing</span>
</span><span id="Portfolio.profit-178"><a href="#Portfolio.profit-178"><span class="linenos">178</span></a><span class="sd">        across all assets.</span>
</span><span id="Portfolio.profit-179"><a href="#Portfolio.profit-179"><span class="linenos">179</span></a>
</span><span id="Portfolio.profit-180"><a href="#Portfolio.profit-180"><span class="linenos">180</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Portfolio.profit-181"><a href="#Portfolio.profit-181"><span class="linenos">181</span></a>        <span class="n">series</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cashposition</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">returns</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mf">0.0</span><span class="p">))</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="Portfolio.profit-182"><a href="#Portfolio.profit-182"><span class="linenos">182</span></a>        <span class="n">series</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;Profit&quot;</span>
</span><span id="Portfolio.profit-183"><a href="#Portfolio.profit-183"><span class="linenos">183</span></a>        <span class="k">return</span> <span class="n">series</span>
</span></pre></div>


            <div class="docstring"><p>Get the profit/loss of the portfolio at each time point.</p>

<p>This calculates the profit or loss at each time point based on the
previous positions and the returns of each asset.</p>

<h2 id="returns">Returns</h2>

<p>pd.Series
    Series representing the profit/loss at each time point</p>

<h2 id="notes">Notes</h2>

<p>The profit is calculated by multiplying the previous day's positions
(in currency terms) by the returns of each asset, and then summing
across all assets.</p>
</div>


                            </div>
                            <div id="Portfolio.cashposition" class="classattr">
                                        <input id="Portfolio.cashposition-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">cashposition</span><span class="annotation">: pandas.core.frame.DataFrame</span>

                <label class="view-source-button" for="Portfolio.cashposition-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Portfolio.cashposition"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Portfolio.cashposition-185"><a href="#Portfolio.cashposition-185"><span class="linenos">185</span></a>    <span class="nd">@property</span>
</span><span id="Portfolio.cashposition-186"><a href="#Portfolio.cashposition-186"><span class="linenos">186</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">cashposition</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
</span><span id="Portfolio.cashposition-187"><a href="#Portfolio.cashposition-187"><span class="linenos">187</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the cash value of each position over time.</span>
</span><span id="Portfolio.cashposition-188"><a href="#Portfolio.cashposition-188"><span class="linenos">188</span></a>
</span><span id="Portfolio.cashposition-189"><a href="#Portfolio.cashposition-189"><span class="linenos">189</span></a><span class="sd">        This calculates the cash value of each position by multiplying</span>
</span><span id="Portfolio.cashposition-190"><a href="#Portfolio.cashposition-190"><span class="linenos">190</span></a><span class="sd">        the number of units by the price for each asset at each time point.</span>
</span><span id="Portfolio.cashposition-191"><a href="#Portfolio.cashposition-191"><span class="linenos">191</span></a>
</span><span id="Portfolio.cashposition-192"><a href="#Portfolio.cashposition-192"><span class="linenos">192</span></a><span class="sd">        Returns</span>
</span><span id="Portfolio.cashposition-193"><a href="#Portfolio.cashposition-193"><span class="linenos">193</span></a><span class="sd">        -------</span>
</span><span id="Portfolio.cashposition-194"><a href="#Portfolio.cashposition-194"><span class="linenos">194</span></a><span class="sd">        pd.DataFrame</span>
</span><span id="Portfolio.cashposition-195"><a href="#Portfolio.cashposition-195"><span class="linenos">195</span></a><span class="sd">            DataFrame with the cash value of each position over time,</span>
</span><span id="Portfolio.cashposition-196"><a href="#Portfolio.cashposition-196"><span class="linenos">196</span></a><span class="sd">            with dates as index and assets as columns</span>
</span><span id="Portfolio.cashposition-197"><a href="#Portfolio.cashposition-197"><span class="linenos">197</span></a>
</span><span id="Portfolio.cashposition-198"><a href="#Portfolio.cashposition-198"><span class="linenos">198</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Portfolio.cashposition-199"><a href="#Portfolio.cashposition-199"><span class="linenos">199</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">prices</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">units</span>
</span></pre></div>


            <div class="docstring"><p>Get the cash value of each position over time.</p>

<p>This calculates the cash value of each position by multiplying
the number of units by the price for each asset at each time point.</p>

<h2 id="returns">Returns</h2>

<p>pd.DataFrame
    DataFrame with the cash value of each position over time,
    with dates as index and assets as columns</p>
</div>


                            </div>
                            <div id="Portfolio.returns" class="classattr">
                                        <input id="Portfolio.returns-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">returns</span><span class="annotation">: pandas.core.frame.DataFrame</span>

                <label class="view-source-button" for="Portfolio.returns-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Portfolio.returns"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Portfolio.returns-201"><a href="#Portfolio.returns-201"><span class="linenos">201</span></a>    <span class="nd">@property</span>
</span><span id="Portfolio.returns-202"><a href="#Portfolio.returns-202"><span class="linenos">202</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">returns</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
</span><span id="Portfolio.returns-203"><a href="#Portfolio.returns-203"><span class="linenos">203</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the returns of individual assets over time.</span>
</span><span id="Portfolio.returns-204"><a href="#Portfolio.returns-204"><span class="linenos">204</span></a>
</span><span id="Portfolio.returns-205"><a href="#Portfolio.returns-205"><span class="linenos">205</span></a><span class="sd">        This calculates the percentage change in price for each asset</span>
</span><span id="Portfolio.returns-206"><a href="#Portfolio.returns-206"><span class="linenos">206</span></a><span class="sd">        from one time point to the next.</span>
</span><span id="Portfolio.returns-207"><a href="#Portfolio.returns-207"><span class="linenos">207</span></a>
</span><span id="Portfolio.returns-208"><a href="#Portfolio.returns-208"><span class="linenos">208</span></a><span class="sd">        Returns</span>
</span><span id="Portfolio.returns-209"><a href="#Portfolio.returns-209"><span class="linenos">209</span></a><span class="sd">        -------</span>
</span><span id="Portfolio.returns-210"><a href="#Portfolio.returns-210"><span class="linenos">210</span></a><span class="sd">        pd.DataFrame</span>
</span><span id="Portfolio.returns-211"><a href="#Portfolio.returns-211"><span class="linenos">211</span></a><span class="sd">            DataFrame with the returns of each asset over time,</span>
</span><span id="Portfolio.returns-212"><a href="#Portfolio.returns-212"><span class="linenos">212</span></a><span class="sd">            with dates as index and assets as columns</span>
</span><span id="Portfolio.returns-213"><a href="#Portfolio.returns-213"><span class="linenos">213</span></a>
</span><span id="Portfolio.returns-214"><a href="#Portfolio.returns-214"><span class="linenos">214</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Portfolio.returns-215"><a href="#Portfolio.returns-215"><span class="linenos">215</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">prices</span><span class="o">.</span><span class="n">pct_change</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>Get the returns of individual assets over time.</p>

<p>This calculates the percentage change in price for each asset
from one time point to the next.</p>

<h2 id="returns">Returns</h2>

<p>pd.DataFrame
    DataFrame with the returns of each asset over time,
    with dates as index and assets as columns</p>
</div>


                            </div>
                            <div id="Portfolio.trades_units" class="classattr">
                                        <input id="Portfolio.trades_units-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">trades_units</span><span class="annotation">: pandas.core.frame.DataFrame</span>

                <label class="view-source-button" for="Portfolio.trades_units-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Portfolio.trades_units"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Portfolio.trades_units-217"><a href="#Portfolio.trades_units-217"><span class="linenos">217</span></a>    <span class="nd">@property</span>
</span><span id="Portfolio.trades_units-218"><a href="#Portfolio.trades_units-218"><span class="linenos">218</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">trades_units</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
</span><span id="Portfolio.trades_units-219"><a href="#Portfolio.trades_units-219"><span class="linenos">219</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the trades made in the portfolio in terms of units.</span>
</span><span id="Portfolio.trades_units-220"><a href="#Portfolio.trades_units-220"><span class="linenos">220</span></a>
</span><span id="Portfolio.trades_units-221"><a href="#Portfolio.trades_units-221"><span class="linenos">221</span></a><span class="sd">        This calculates the changes in position (units) from one time point</span>
</span><span id="Portfolio.trades_units-222"><a href="#Portfolio.trades_units-222"><span class="linenos">222</span></a><span class="sd">        to the next for each asset.</span>
</span><span id="Portfolio.trades_units-223"><a href="#Portfolio.trades_units-223"><span class="linenos">223</span></a>
</span><span id="Portfolio.trades_units-224"><a href="#Portfolio.trades_units-224"><span class="linenos">224</span></a><span class="sd">        Returns</span>
</span><span id="Portfolio.trades_units-225"><a href="#Portfolio.trades_units-225"><span class="linenos">225</span></a><span class="sd">        -------</span>
</span><span id="Portfolio.trades_units-226"><a href="#Portfolio.trades_units-226"><span class="linenos">226</span></a><span class="sd">        pd.DataFrame</span>
</span><span id="Portfolio.trades_units-227"><a href="#Portfolio.trades_units-227"><span class="linenos">227</span></a><span class="sd">            DataFrame with the trades (changes in units) for each asset over time,</span>
</span><span id="Portfolio.trades_units-228"><a href="#Portfolio.trades_units-228"><span class="linenos">228</span></a><span class="sd">            with dates as index and assets as columns</span>
</span><span id="Portfolio.trades_units-229"><a href="#Portfolio.trades_units-229"><span class="linenos">229</span></a>
</span><span id="Portfolio.trades_units-230"><a href="#Portfolio.trades_units-230"><span class="linenos">230</span></a><span class="sd">        Notes</span>
</span><span id="Portfolio.trades_units-231"><a href="#Portfolio.trades_units-231"><span class="linenos">231</span></a><span class="sd">        -----</span>
</span><span id="Portfolio.trades_units-232"><a href="#Portfolio.trades_units-232"><span class="linenos">232</span></a><span class="sd">        Calculated as the difference between consecutive position values.</span>
</span><span id="Portfolio.trades_units-233"><a href="#Portfolio.trades_units-233"><span class="linenos">233</span></a><span class="sd">        Positive values represent buys, negative values represent sells.</span>
</span><span id="Portfolio.trades_units-234"><a href="#Portfolio.trades_units-234"><span class="linenos">234</span></a><span class="sd">        The first row contains the initial positions, as there are no previous</span>
</span><span id="Portfolio.trades_units-235"><a href="#Portfolio.trades_units-235"><span class="linenos">235</span></a><span class="sd">        positions to compare with.</span>
</span><span id="Portfolio.trades_units-236"><a href="#Portfolio.trades_units-236"><span class="linenos">236</span></a>
</span><span id="Portfolio.trades_units-237"><a href="#Portfolio.trades_units-237"><span class="linenos">237</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Portfolio.trades_units-238"><a href="#Portfolio.trades_units-238"><span class="linenos">238</span></a>        <span class="n">t</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span>
</span><span id="Portfolio.trades_units-239"><a href="#Portfolio.trades_units-239"><span class="linenos">239</span></a>        <span class="n">t</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
</span><span id="Portfolio.trades_units-240"><a href="#Portfolio.trades_units-240"><span class="linenos">240</span></a>        <span class="k">return</span> <span class="n">t</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Get the trades made in the portfolio in terms of units.</p>

<p>This calculates the changes in position (units) from one time point
to the next for each asset.</p>

<h2 id="returns">Returns</h2>

<p>pd.DataFrame
    DataFrame with the trades (changes in units) for each asset over time,
    with dates as index and assets as columns</p>

<h2 id="notes">Notes</h2>

<p>Calculated as the difference between consecutive position values.
Positive values represent buys, negative values represent sells.
The first row contains the initial positions, as there are no previous
positions to compare with.</p>
</div>


                            </div>
                            <div id="Portfolio.trades_currency" class="classattr">
                                        <input id="Portfolio.trades_currency-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">trades_currency</span><span class="annotation">: pandas.core.frame.DataFrame</span>

                <label class="view-source-button" for="Portfolio.trades_currency-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Portfolio.trades_currency"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Portfolio.trades_currency-242"><a href="#Portfolio.trades_currency-242"><span class="linenos">242</span></a>    <span class="nd">@property</span>
</span><span id="Portfolio.trades_currency-243"><a href="#Portfolio.trades_currency-243"><span class="linenos">243</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">trades_currency</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
</span><span id="Portfolio.trades_currency-244"><a href="#Portfolio.trades_currency-244"><span class="linenos">244</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the trades made in the portfolio in terms of currency.</span>
</span><span id="Portfolio.trades_currency-245"><a href="#Portfolio.trades_currency-245"><span class="linenos">245</span></a>
</span><span id="Portfolio.trades_currency-246"><a href="#Portfolio.trades_currency-246"><span class="linenos">246</span></a><span class="sd">        This calculates the cash value of trades by multiplying the changes</span>
</span><span id="Portfolio.trades_currency-247"><a href="#Portfolio.trades_currency-247"><span class="linenos">247</span></a><span class="sd">        in position (units) by the current prices.</span>
</span><span id="Portfolio.trades_currency-248"><a href="#Portfolio.trades_currency-248"><span class="linenos">248</span></a>
</span><span id="Portfolio.trades_currency-249"><a href="#Portfolio.trades_currency-249"><span class="linenos">249</span></a><span class="sd">        Returns</span>
</span><span id="Portfolio.trades_currency-250"><a href="#Portfolio.trades_currency-250"><span class="linenos">250</span></a><span class="sd">        -------</span>
</span><span id="Portfolio.trades_currency-251"><a href="#Portfolio.trades_currency-251"><span class="linenos">251</span></a><span class="sd">        pd.DataFrame</span>
</span><span id="Portfolio.trades_currency-252"><a href="#Portfolio.trades_currency-252"><span class="linenos">252</span></a><span class="sd">            DataFrame with the cash value of trades for each asset over time,</span>
</span><span id="Portfolio.trades_currency-253"><a href="#Portfolio.trades_currency-253"><span class="linenos">253</span></a><span class="sd">            with dates as index and assets as columns</span>
</span><span id="Portfolio.trades_currency-254"><a href="#Portfolio.trades_currency-254"><span class="linenos">254</span></a>
</span><span id="Portfolio.trades_currency-255"><a href="#Portfolio.trades_currency-255"><span class="linenos">255</span></a><span class="sd">        Notes</span>
</span><span id="Portfolio.trades_currency-256"><a href="#Portfolio.trades_currency-256"><span class="linenos">256</span></a><span class="sd">        -----</span>
</span><span id="Portfolio.trades_currency-257"><a href="#Portfolio.trades_currency-257"><span class="linenos">257</span></a><span class="sd">        Calculated by multiplying trades_units by prices.</span>
</span><span id="Portfolio.trades_currency-258"><a href="#Portfolio.trades_currency-258"><span class="linenos">258</span></a><span class="sd">        Positive values represent buys (cash outflows),</span>
</span><span id="Portfolio.trades_currency-259"><a href="#Portfolio.trades_currency-259"><span class="linenos">259</span></a><span class="sd">        negative values represent sells (cash inflows).</span>
</span><span id="Portfolio.trades_currency-260"><a href="#Portfolio.trades_currency-260"><span class="linenos">260</span></a>
</span><span id="Portfolio.trades_currency-261"><a href="#Portfolio.trades_currency-261"><span class="linenos">261</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Portfolio.trades_currency-262"><a href="#Portfolio.trades_currency-262"><span class="linenos">262</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">trades_units</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">prices</span>
</span></pre></div>


            <div class="docstring"><p>Get the trades made in the portfolio in terms of currency.</p>

<p>This calculates the cash value of trades by multiplying the changes
in position (units) by the current prices.</p>

<h2 id="returns">Returns</h2>

<p>pd.DataFrame
    DataFrame with the cash value of trades for each asset over time,
    with dates as index and assets as columns</p>

<h2 id="notes">Notes</h2>

<p>Calculated by multiplying trades_units by prices.
Positive values represent buys (cash outflows),
negative values represent sells (cash inflows).</p>
</div>


                            </div>
                            <div id="Portfolio.turnover_relative" class="classattr">
                                        <input id="Portfolio.turnover_relative-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">turnover_relative</span><span class="annotation">: pandas.core.frame.DataFrame</span>

                <label class="view-source-button" for="Portfolio.turnover_relative-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Portfolio.turnover_relative"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Portfolio.turnover_relative-264"><a href="#Portfolio.turnover_relative-264"><span class="linenos">264</span></a>    <span class="nd">@property</span>
</span><span id="Portfolio.turnover_relative-265"><a href="#Portfolio.turnover_relative-265"><span class="linenos">265</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">turnover_relative</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
</span><span id="Portfolio.turnover_relative-266"><a href="#Portfolio.turnover_relative-266"><span class="linenos">266</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the turnover relative to the portfolio NAV.</span>
</span><span id="Portfolio.turnover_relative-267"><a href="#Portfolio.turnover_relative-267"><span class="linenos">267</span></a>
</span><span id="Portfolio.turnover_relative-268"><a href="#Portfolio.turnover_relative-268"><span class="linenos">268</span></a><span class="sd">        This calculates the trades as a percentage of the portfolio NAV,</span>
</span><span id="Portfolio.turnover_relative-269"><a href="#Portfolio.turnover_relative-269"><span class="linenos">269</span></a><span class="sd">        which provides a measure of trading activity relative to portfolio size.</span>
</span><span id="Portfolio.turnover_relative-270"><a href="#Portfolio.turnover_relative-270"><span class="linenos">270</span></a>
</span><span id="Portfolio.turnover_relative-271"><a href="#Portfolio.turnover_relative-271"><span class="linenos">271</span></a><span class="sd">        Returns</span>
</span><span id="Portfolio.turnover_relative-272"><a href="#Portfolio.turnover_relative-272"><span class="linenos">272</span></a><span class="sd">        -------</span>
</span><span id="Portfolio.turnover_relative-273"><a href="#Portfolio.turnover_relative-273"><span class="linenos">273</span></a><span class="sd">        pd.DataFrame</span>
</span><span id="Portfolio.turnover_relative-274"><a href="#Portfolio.turnover_relative-274"><span class="linenos">274</span></a><span class="sd">            DataFrame with the relative turnover for each asset over time,</span>
</span><span id="Portfolio.turnover_relative-275"><a href="#Portfolio.turnover_relative-275"><span class="linenos">275</span></a><span class="sd">            with dates as index and assets as columns</span>
</span><span id="Portfolio.turnover_relative-276"><a href="#Portfolio.turnover_relative-276"><span class="linenos">276</span></a>
</span><span id="Portfolio.turnover_relative-277"><a href="#Portfolio.turnover_relative-277"><span class="linenos">277</span></a><span class="sd">        Notes</span>
</span><span id="Portfolio.turnover_relative-278"><a href="#Portfolio.turnover_relative-278"><span class="linenos">278</span></a><span class="sd">        -----</span>
</span><span id="Portfolio.turnover_relative-279"><a href="#Portfolio.turnover_relative-279"><span class="linenos">279</span></a><span class="sd">        Calculated by dividing trades_currency by NAV.</span>
</span><span id="Portfolio.turnover_relative-280"><a href="#Portfolio.turnover_relative-280"><span class="linenos">280</span></a><span class="sd">        Positive values represent buys, negative values represent sells.</span>
</span><span id="Portfolio.turnover_relative-281"><a href="#Portfolio.turnover_relative-281"><span class="linenos">281</span></a><span class="sd">        A value of 0.05 means a buy equal to 5% of the portfolio NAV.</span>
</span><span id="Portfolio.turnover_relative-282"><a href="#Portfolio.turnover_relative-282"><span class="linenos">282</span></a>
</span><span id="Portfolio.turnover_relative-283"><a href="#Portfolio.turnover_relative-283"><span class="linenos">283</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Portfolio.turnover_relative-284"><a href="#Portfolio.turnover_relative-284"><span class="linenos">284</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">trades_currency</span><span class="o">.</span><span class="n">div</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nav</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Get the turnover relative to the portfolio NAV.</p>

<p>This calculates the trades as a percentage of the portfolio NAV,
which provides a measure of trading activity relative to portfolio size.</p>

<h2 id="returns">Returns</h2>

<p>pd.DataFrame
    DataFrame with the relative turnover for each asset over time,
    with dates as index and assets as columns</p>

<h2 id="notes">Notes</h2>

<p>Calculated by dividing trades_currency by NAV.
Positive values represent buys, negative values represent sells.
A value of 0.05 means a buy equal to 5% of the portfolio NAV.</p>
</div>


                            </div>
                            <div id="Portfolio.turnover" class="classattr">
                                        <input id="Portfolio.turnover-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">turnover</span><span class="annotation">: pandas.core.frame.DataFrame</span>

                <label class="view-source-button" for="Portfolio.turnover-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Portfolio.turnover"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Portfolio.turnover-286"><a href="#Portfolio.turnover-286"><span class="linenos">286</span></a>    <span class="nd">@property</span>
</span><span id="Portfolio.turnover-287"><a href="#Portfolio.turnover-287"><span class="linenos">287</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">turnover</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
</span><span id="Portfolio.turnover-288"><a href="#Portfolio.turnover-288"><span class="linenos">288</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the absolute turnover in the portfolio.</span>
</span><span id="Portfolio.turnover-289"><a href="#Portfolio.turnover-289"><span class="linenos">289</span></a>
</span><span id="Portfolio.turnover-290"><a href="#Portfolio.turnover-290"><span class="linenos">290</span></a><span class="sd">        This calculates the absolute value of trades in currency terms,</span>
</span><span id="Portfolio.turnover-291"><a href="#Portfolio.turnover-291"><span class="linenos">291</span></a><span class="sd">        which provides a measure of total trading activity regardless of</span>
</span><span id="Portfolio.turnover-292"><a href="#Portfolio.turnover-292"><span class="linenos">292</span></a><span class="sd">        direction (buy or sell).</span>
</span><span id="Portfolio.turnover-293"><a href="#Portfolio.turnover-293"><span class="linenos">293</span></a>
</span><span id="Portfolio.turnover-294"><a href="#Portfolio.turnover-294"><span class="linenos">294</span></a><span class="sd">        Returns</span>
</span><span id="Portfolio.turnover-295"><a href="#Portfolio.turnover-295"><span class="linenos">295</span></a><span class="sd">        -------</span>
</span><span id="Portfolio.turnover-296"><a href="#Portfolio.turnover-296"><span class="linenos">296</span></a><span class="sd">        pd.DataFrame</span>
</span><span id="Portfolio.turnover-297"><a href="#Portfolio.turnover-297"><span class="linenos">297</span></a><span class="sd">            DataFrame with the absolute turnover for each asset over time,</span>
</span><span id="Portfolio.turnover-298"><a href="#Portfolio.turnover-298"><span class="linenos">298</span></a><span class="sd">            with dates as index and assets as columns</span>
</span><span id="Portfolio.turnover-299"><a href="#Portfolio.turnover-299"><span class="linenos">299</span></a>
</span><span id="Portfolio.turnover-300"><a href="#Portfolio.turnover-300"><span class="linenos">300</span></a><span class="sd">        Notes</span>
</span><span id="Portfolio.turnover-301"><a href="#Portfolio.turnover-301"><span class="linenos">301</span></a><span class="sd">        -----</span>
</span><span id="Portfolio.turnover-302"><a href="#Portfolio.turnover-302"><span class="linenos">302</span></a><span class="sd">        Calculated as the absolute value of trades_currency.</span>
</span><span id="Portfolio.turnover-303"><a href="#Portfolio.turnover-303"><span class="linenos">303</span></a><span class="sd">        This is useful for calculating trading costs that apply equally</span>
</span><span id="Portfolio.turnover-304"><a href="#Portfolio.turnover-304"><span class="linenos">304</span></a><span class="sd">        to buys and sells.</span>
</span><span id="Portfolio.turnover-305"><a href="#Portfolio.turnover-305"><span class="linenos">305</span></a>
</span><span id="Portfolio.turnover-306"><a href="#Portfolio.turnover-306"><span class="linenos">306</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Portfolio.turnover-307"><a href="#Portfolio.turnover-307"><span class="linenos">307</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">trades_currency</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>Get the absolute turnover in the portfolio.</p>

<p>This calculates the absolute value of trades in currency terms,
which provides a measure of total trading activity regardless of
direction (buy or sell).</p>

<h2 id="returns">Returns</h2>

<p>pd.DataFrame
    DataFrame with the absolute turnover for each asset over time,
    with dates as index and assets as columns</p>

<h2 id="notes">Notes</h2>

<p>Calculated as the absolute value of trades_currency.
This is useful for calculating trading costs that apply equally
to buys and sells.</p>
</div>


                            </div>
                            <div id="Portfolio.equity" class="classattr">
                                        <input id="Portfolio.equity-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">equity</span><span class="annotation">: pandas.core.frame.DataFrame</span>

                <label class="view-source-button" for="Portfolio.equity-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Portfolio.equity"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Portfolio.equity-340"><a href="#Portfolio.equity-340"><span class="linenos">340</span></a>    <span class="nd">@property</span>
</span><span id="Portfolio.equity-341"><a href="#Portfolio.equity-341"><span class="linenos">341</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">equity</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
</span><span id="Portfolio.equity-342"><a href="#Portfolio.equity-342"><span class="linenos">342</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the equity (cash value) of each position over time.</span>
</span><span id="Portfolio.equity-343"><a href="#Portfolio.equity-343"><span class="linenos">343</span></a>
</span><span id="Portfolio.equity-344"><a href="#Portfolio.equity-344"><span class="linenos">344</span></a><span class="sd">        This property returns the cash value of each position in the portfolio,</span>
</span><span id="Portfolio.equity-345"><a href="#Portfolio.equity-345"><span class="linenos">345</span></a><span class="sd">        calculated by multiplying the number of units by the price for each asset.</span>
</span><span id="Portfolio.equity-346"><a href="#Portfolio.equity-346"><span class="linenos">346</span></a>
</span><span id="Portfolio.equity-347"><a href="#Portfolio.equity-347"><span class="linenos">347</span></a><span class="sd">        Returns</span>
</span><span id="Portfolio.equity-348"><a href="#Portfolio.equity-348"><span class="linenos">348</span></a><span class="sd">        -------</span>
</span><span id="Portfolio.equity-349"><a href="#Portfolio.equity-349"><span class="linenos">349</span></a><span class="sd">        pd.DataFrame</span>
</span><span id="Portfolio.equity-350"><a href="#Portfolio.equity-350"><span class="linenos">350</span></a><span class="sd">            DataFrame with the cash value of each position over time,</span>
</span><span id="Portfolio.equity-351"><a href="#Portfolio.equity-351"><span class="linenos">351</span></a><span class="sd">            with dates as index and assets as columns</span>
</span><span id="Portfolio.equity-352"><a href="#Portfolio.equity-352"><span class="linenos">352</span></a>
</span><span id="Portfolio.equity-353"><a href="#Portfolio.equity-353"><span class="linenos">353</span></a><span class="sd">        Notes</span>
</span><span id="Portfolio.equity-354"><a href="#Portfolio.equity-354"><span class="linenos">354</span></a><span class="sd">        -----</span>
</span><span id="Portfolio.equity-355"><a href="#Portfolio.equity-355"><span class="linenos">355</span></a><span class="sd">        This is an alias for the cashposition property and returns the same values.</span>
</span><span id="Portfolio.equity-356"><a href="#Portfolio.equity-356"><span class="linenos">356</span></a><span class="sd">        The term &quot;equity&quot; is used in the context of the cash value of positions,</span>
</span><span id="Portfolio.equity-357"><a href="#Portfolio.equity-357"><span class="linenos">357</span></a><span class="sd">        not to be confused with the equity asset class.</span>
</span><span id="Portfolio.equity-358"><a href="#Portfolio.equity-358"><span class="linenos">358</span></a>
</span><span id="Portfolio.equity-359"><a href="#Portfolio.equity-359"><span class="linenos">359</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Portfolio.equity-360"><a href="#Portfolio.equity-360"><span class="linenos">360</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">cashposition</span>
</span></pre></div>


            <div class="docstring"><p>Get the equity (cash value) of each position over time.</p>

<p>This property returns the cash value of each position in the portfolio,
calculated by multiplying the number of units by the price for each asset.</p>

<h2 id="returns">Returns</h2>

<p>pd.DataFrame
    DataFrame with the cash value of each position over time,
    with dates as index and assets as columns</p>

<h2 id="notes">Notes</h2>

<p>This is an alias for the cashposition property and returns the same values.
The term "equity" is used in the context of the cash value of positions,
not to be confused with the equity asset class.</p>
</div>


                            </div>
                            <div id="Portfolio.weights" class="classattr">
                                        <input id="Portfolio.weights-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">weights</span><span class="annotation">: pandas.core.frame.DataFrame</span>

                <label class="view-source-button" for="Portfolio.weights-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Portfolio.weights"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Portfolio.weights-362"><a href="#Portfolio.weights-362"><span class="linenos">362</span></a>    <span class="nd">@property</span>
</span><span id="Portfolio.weights-363"><a href="#Portfolio.weights-363"><span class="linenos">363</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">weights</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
</span><span id="Portfolio.weights-364"><a href="#Portfolio.weights-364"><span class="linenos">364</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the weight of each asset in the portfolio over time.</span>
</span><span id="Portfolio.weights-365"><a href="#Portfolio.weights-365"><span class="linenos">365</span></a>
</span><span id="Portfolio.weights-366"><a href="#Portfolio.weights-366"><span class="linenos">366</span></a><span class="sd">        This calculates the relative weight of each asset in the portfolio</span>
</span><span id="Portfolio.weights-367"><a href="#Portfolio.weights-367"><span class="linenos">367</span></a><span class="sd">        by dividing the cash value of each position by the total portfolio</span>
</span><span id="Portfolio.weights-368"><a href="#Portfolio.weights-368"><span class="linenos">368</span></a><span class="sd">        value (NAV) at each time point.</span>
</span><span id="Portfolio.weights-369"><a href="#Portfolio.weights-369"><span class="linenos">369</span></a>
</span><span id="Portfolio.weights-370"><a href="#Portfolio.weights-370"><span class="linenos">370</span></a><span class="sd">        Returns</span>
</span><span id="Portfolio.weights-371"><a href="#Portfolio.weights-371"><span class="linenos">371</span></a><span class="sd">        -------</span>
</span><span id="Portfolio.weights-372"><a href="#Portfolio.weights-372"><span class="linenos">372</span></a><span class="sd">        pd.DataFrame</span>
</span><span id="Portfolio.weights-373"><a href="#Portfolio.weights-373"><span class="linenos">373</span></a><span class="sd">            DataFrame with the weight of each asset over time,</span>
</span><span id="Portfolio.weights-374"><a href="#Portfolio.weights-374"><span class="linenos">374</span></a><span class="sd">            with dates as index and assets as columns</span>
</span><span id="Portfolio.weights-375"><a href="#Portfolio.weights-375"><span class="linenos">375</span></a>
</span><span id="Portfolio.weights-376"><a href="#Portfolio.weights-376"><span class="linenos">376</span></a><span class="sd">        Notes</span>
</span><span id="Portfolio.weights-377"><a href="#Portfolio.weights-377"><span class="linenos">377</span></a><span class="sd">        -----</span>
</span><span id="Portfolio.weights-378"><a href="#Portfolio.weights-378"><span class="linenos">378</span></a><span class="sd">        The sum of weights across all assets at any given time should equal 1.0</span>
</span><span id="Portfolio.weights-379"><a href="#Portfolio.weights-379"><span class="linenos">379</span></a><span class="sd">        for a fully invested portfolio with no leverage. Weights can be negative</span>
</span><span id="Portfolio.weights-380"><a href="#Portfolio.weights-380"><span class="linenos">380</span></a><span class="sd">        for short positions.</span>
</span><span id="Portfolio.weights-381"><a href="#Portfolio.weights-381"><span class="linenos">381</span></a>
</span><span id="Portfolio.weights-382"><a href="#Portfolio.weights-382"><span class="linenos">382</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Portfolio.weights-383"><a href="#Portfolio.weights-383"><span class="linenos">383</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">equity</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">nav</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Get the weight of each asset in the portfolio over time.</p>

<p>This calculates the relative weight of each asset in the portfolio
by dividing the cash value of each position by the total portfolio
value (NAV) at each time point.</p>

<h2 id="returns">Returns</h2>

<p>pd.DataFrame
    DataFrame with the weight of each asset over time,
    with dates as index and assets as columns</p>

<h2 id="notes">Notes</h2>

<p>The sum of weights across all assets at any given time should equal 1.0
for a fully invested portfolio with no leverage. Weights can be negative
for short positions.</p>
</div>


                            </div>
                            <div id="Portfolio.stats" class="classattr">
                                        <input id="Portfolio.stats-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">stats</span>

                <label class="view-source-button" for="Portfolio.stats-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Portfolio.stats"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Portfolio.stats-385"><a href="#Portfolio.stats-385"><span class="linenos">385</span></a>    <span class="nd">@property</span>
</span><span id="Portfolio.stats-386"><a href="#Portfolio.stats-386"><span class="linenos">386</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">stats</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Portfolio.stats-387"><a href="#Portfolio.stats-387"><span class="linenos">387</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get statistical analysis data for the portfolio.</span>
</span><span id="Portfolio.stats-388"><a href="#Portfolio.stats-388"><span class="linenos">388</span></a>
</span><span id="Portfolio.stats-389"><a href="#Portfolio.stats-389"><span class="linenos">389</span></a><span class="sd">        This property provides access to various statistical metrics calculated</span>
</span><span id="Portfolio.stats-390"><a href="#Portfolio.stats-390"><span class="linenos">390</span></a><span class="sd">        for the portfolio, such as Sharpe ratio, volatility, drawdowns, etc.</span>
</span><span id="Portfolio.stats-391"><a href="#Portfolio.stats-391"><span class="linenos">391</span></a>
</span><span id="Portfolio.stats-392"><a href="#Portfolio.stats-392"><span class="linenos">392</span></a><span class="sd">        Returns</span>
</span><span id="Portfolio.stats-393"><a href="#Portfolio.stats-393"><span class="linenos">393</span></a><span class="sd">        -------</span>
</span><span id="Portfolio.stats-394"><a href="#Portfolio.stats-394"><span class="linenos">394</span></a><span class="sd">        object</span>
</span><span id="Portfolio.stats-395"><a href="#Portfolio.stats-395"><span class="linenos">395</span></a><span class="sd">            An object containing various statistical metrics for the portfolio</span>
</span><span id="Portfolio.stats-396"><a href="#Portfolio.stats-396"><span class="linenos">396</span></a>
</span><span id="Portfolio.stats-397"><a href="#Portfolio.stats-397"><span class="linenos">397</span></a><span class="sd">        Notes</span>
</span><span id="Portfolio.stats-398"><a href="#Portfolio.stats-398"><span class="linenos">398</span></a><span class="sd">        -----</span>
</span><span id="Portfolio.stats-399"><a href="#Portfolio.stats-399"><span class="linenos">399</span></a><span class="sd">        The statistics are calculated by the underlying jquantstats library</span>
</span><span id="Portfolio.stats-400"><a href="#Portfolio.stats-400"><span class="linenos">400</span></a><span class="sd">        and are based on the portfolio&#39;s NAV time series.</span>
</span><span id="Portfolio.stats-401"><a href="#Portfolio.stats-401"><span class="linenos">401</span></a>
</span><span id="Portfolio.stats-402"><a href="#Portfolio.stats-402"><span class="linenos">402</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Portfolio.stats-403"><a href="#Portfolio.stats-403"><span class="linenos">403</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="o">.</span><span class="n">stats</span>
</span></pre></div>


            <div class="docstring"><p>Get statistical analysis data for the portfolio.</p>

<p>This property provides access to various statistical metrics calculated
for the portfolio, such as Sharpe ratio, volatility, drawdowns, etc.</p>

<h2 id="returns">Returns</h2>

<p>object
    An object containing various statistical metrics for the portfolio</p>

<h2 id="notes">Notes</h2>

<p>The statistics are calculated by the underlying jquantstats library
and are based on the portfolio's NAV time series.</p>
</div>


                            </div>
                            <div id="Portfolio.plots" class="classattr">
                                        <input id="Portfolio.plots-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">plots</span>

                <label class="view-source-button" for="Portfolio.plots-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Portfolio.plots"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Portfolio.plots-405"><a href="#Portfolio.plots-405"><span class="linenos">405</span></a>    <span class="nd">@property</span>
</span><span id="Portfolio.plots-406"><a href="#Portfolio.plots-406"><span class="linenos">406</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">plots</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Portfolio.plots-407"><a href="#Portfolio.plots-407"><span class="linenos">407</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get visualization tools for the portfolio.</span>
</span><span id="Portfolio.plots-408"><a href="#Portfolio.plots-408"><span class="linenos">408</span></a>
</span><span id="Portfolio.plots-409"><a href="#Portfolio.plots-409"><span class="linenos">409</span></a><span class="sd">        This property provides access to various plotting functions for visualizing</span>
</span><span id="Portfolio.plots-410"><a href="#Portfolio.plots-410"><span class="linenos">410</span></a><span class="sd">        the portfolio&#39;s performance, returns, drawdowns, etc.</span>
</span><span id="Portfolio.plots-411"><a href="#Portfolio.plots-411"><span class="linenos">411</span></a>
</span><span id="Portfolio.plots-412"><a href="#Portfolio.plots-412"><span class="linenos">412</span></a><span class="sd">        Returns</span>
</span><span id="Portfolio.plots-413"><a href="#Portfolio.plots-413"><span class="linenos">413</span></a><span class="sd">        -------</span>
</span><span id="Portfolio.plots-414"><a href="#Portfolio.plots-414"><span class="linenos">414</span></a><span class="sd">        object</span>
</span><span id="Portfolio.plots-415"><a href="#Portfolio.plots-415"><span class="linenos">415</span></a><span class="sd">            An object containing various plotting methods for the portfolio</span>
</span><span id="Portfolio.plots-416"><a href="#Portfolio.plots-416"><span class="linenos">416</span></a>
</span><span id="Portfolio.plots-417"><a href="#Portfolio.plots-417"><span class="linenos">417</span></a><span class="sd">        Notes</span>
</span><span id="Portfolio.plots-418"><a href="#Portfolio.plots-418"><span class="linenos">418</span></a><span class="sd">        -----</span>
</span><span id="Portfolio.plots-419"><a href="#Portfolio.plots-419"><span class="linenos">419</span></a><span class="sd">        The plotting functions are provided by the underlying jquantstats library</span>
</span><span id="Portfolio.plots-420"><a href="#Portfolio.plots-420"><span class="linenos">420</span></a><span class="sd">        and operate on the portfolio&#39;s NAV time series.</span>
</span><span id="Portfolio.plots-421"><a href="#Portfolio.plots-421"><span class="linenos">421</span></a>
</span><span id="Portfolio.plots-422"><a href="#Portfolio.plots-422"><span class="linenos">422</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Portfolio.plots-423"><a href="#Portfolio.plots-423"><span class="linenos">423</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="o">.</span><span class="n">plots</span>
</span></pre></div>


            <div class="docstring"><p>Get visualization tools for the portfolio.</p>

<p>This property provides access to various plotting functions for visualizing
the portfolio's performance, returns, drawdowns, etc.</p>

<h2 id="returns">Returns</h2>

<p>object
    An object containing various plotting methods for the portfolio</p>

<h2 id="notes">Notes</h2>

<p>The plotting functions are provided by the underlying jquantstats library
and operate on the portfolio's NAV time series.</p>
</div>


                            </div>
                            <div id="Portfolio.reports" class="classattr">
                                        <input id="Portfolio.reports-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">reports</span>

                <label class="view-source-button" for="Portfolio.reports-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Portfolio.reports"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Portfolio.reports-425"><a href="#Portfolio.reports-425"><span class="linenos">425</span></a>    <span class="nd">@property</span>
</span><span id="Portfolio.reports-426"><a href="#Portfolio.reports-426"><span class="linenos">426</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">reports</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Portfolio.reports-427"><a href="#Portfolio.reports-427"><span class="linenos">427</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get reporting tools for the portfolio.</span>
</span><span id="Portfolio.reports-428"><a href="#Portfolio.reports-428"><span class="linenos">428</span></a>
</span><span id="Portfolio.reports-429"><a href="#Portfolio.reports-429"><span class="linenos">429</span></a><span class="sd">        This property provides access to various reporting functions for generating</span>
</span><span id="Portfolio.reports-430"><a href="#Portfolio.reports-430"><span class="linenos">430</span></a><span class="sd">        performance reports, risk metrics, and other analytics for the portfolio.</span>
</span><span id="Portfolio.reports-431"><a href="#Portfolio.reports-431"><span class="linenos">431</span></a>
</span><span id="Portfolio.reports-432"><a href="#Portfolio.reports-432"><span class="linenos">432</span></a><span class="sd">        Returns</span>
</span><span id="Portfolio.reports-433"><a href="#Portfolio.reports-433"><span class="linenos">433</span></a><span class="sd">        -------</span>
</span><span id="Portfolio.reports-434"><a href="#Portfolio.reports-434"><span class="linenos">434</span></a><span class="sd">        object</span>
</span><span id="Portfolio.reports-435"><a href="#Portfolio.reports-435"><span class="linenos">435</span></a><span class="sd">            An object containing various reporting methods for the portfolio</span>
</span><span id="Portfolio.reports-436"><a href="#Portfolio.reports-436"><span class="linenos">436</span></a>
</span><span id="Portfolio.reports-437"><a href="#Portfolio.reports-437"><span class="linenos">437</span></a><span class="sd">        Notes</span>
</span><span id="Portfolio.reports-438"><a href="#Portfolio.reports-438"><span class="linenos">438</span></a><span class="sd">        -----</span>
</span><span id="Portfolio.reports-439"><a href="#Portfolio.reports-439"><span class="linenos">439</span></a><span class="sd">        The reporting functions are provided by the underlying jquantstats library</span>
</span><span id="Portfolio.reports-440"><a href="#Portfolio.reports-440"><span class="linenos">440</span></a><span class="sd">        and operate on the portfolio&#39;s NAV time series.</span>
</span><span id="Portfolio.reports-441"><a href="#Portfolio.reports-441"><span class="linenos">441</span></a>
</span><span id="Portfolio.reports-442"><a href="#Portfolio.reports-442"><span class="linenos">442</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Portfolio.reports-443"><a href="#Portfolio.reports-443"><span class="linenos">443</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="o">.</span><span class="n">reports</span>
</span></pre></div>


            <div class="docstring"><p>Get reporting tools for the portfolio.</p>

<p>This property provides access to various reporting functions for generating
performance reports, risk metrics, and other analytics for the portfolio.</p>

<h2 id="returns">Returns</h2>

<p>object
    An object containing various reporting methods for the portfolio</p>

<h2 id="notes">Notes</h2>

<p>The reporting functions are provided by the underlying jquantstats library
and operate on the portfolio's NAV time series.</p>
</div>


                            </div>
                            <div id="Portfolio.sharpe" class="classattr">
                                        <input id="Portfolio.sharpe-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">sharpe</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">periods</span><span class="o">=</span><span class="kc">None</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Portfolio.sharpe-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Portfolio.sharpe"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Portfolio.sharpe-445"><a href="#Portfolio.sharpe-445"><span class="linenos">445</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">sharpe</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="Portfolio.sharpe-446"><a href="#Portfolio.sharpe-446"><span class="linenos">446</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Calculate the Sharpe ratio for the portfolio.</span>
</span><span id="Portfolio.sharpe-447"><a href="#Portfolio.sharpe-447"><span class="linenos">447</span></a>
</span><span id="Portfolio.sharpe-448"><a href="#Portfolio.sharpe-448"><span class="linenos">448</span></a><span class="sd">        The Sharpe ratio is a measure of risk-adjusted return, calculated as</span>
</span><span id="Portfolio.sharpe-449"><a href="#Portfolio.sharpe-449"><span class="linenos">449</span></a><span class="sd">        the portfolio&#39;s excess return divided by its volatility.</span>
</span><span id="Portfolio.sharpe-450"><a href="#Portfolio.sharpe-450"><span class="linenos">450</span></a>
</span><span id="Portfolio.sharpe-451"><a href="#Portfolio.sharpe-451"><span class="linenos">451</span></a><span class="sd">        Parameters</span>
</span><span id="Portfolio.sharpe-452"><a href="#Portfolio.sharpe-452"><span class="linenos">452</span></a><span class="sd">        ----------</span>
</span><span id="Portfolio.sharpe-453"><a href="#Portfolio.sharpe-453"><span class="linenos">453</span></a><span class="sd">        periods : int, optional</span>
</span><span id="Portfolio.sharpe-454"><a href="#Portfolio.sharpe-454"><span class="linenos">454</span></a><span class="sd">            The number of periods per year for annualization.</span>
</span><span id="Portfolio.sharpe-455"><a href="#Portfolio.sharpe-455"><span class="linenos">455</span></a><span class="sd">            For daily data, use 252; for weekly data, use 52; for monthly data, use 12.</span>
</span><span id="Portfolio.sharpe-456"><a href="#Portfolio.sharpe-456"><span class="linenos">456</span></a><span class="sd">            If None, no annualization is performed.</span>
</span><span id="Portfolio.sharpe-457"><a href="#Portfolio.sharpe-457"><span class="linenos">457</span></a>
</span><span id="Portfolio.sharpe-458"><a href="#Portfolio.sharpe-458"><span class="linenos">458</span></a><span class="sd">        Returns</span>
</span><span id="Portfolio.sharpe-459"><a href="#Portfolio.sharpe-459"><span class="linenos">459</span></a><span class="sd">        -------</span>
</span><span id="Portfolio.sharpe-460"><a href="#Portfolio.sharpe-460"><span class="linenos">460</span></a><span class="sd">        float</span>
</span><span id="Portfolio.sharpe-461"><a href="#Portfolio.sharpe-461"><span class="linenos">461</span></a><span class="sd">            The Sharpe ratio of the portfolio</span>
</span><span id="Portfolio.sharpe-462"><a href="#Portfolio.sharpe-462"><span class="linenos">462</span></a>
</span><span id="Portfolio.sharpe-463"><a href="#Portfolio.sharpe-463"><span class="linenos">463</span></a><span class="sd">        Notes</span>
</span><span id="Portfolio.sharpe-464"><a href="#Portfolio.sharpe-464"><span class="linenos">464</span></a><span class="sd">        -----</span>
</span><span id="Portfolio.sharpe-465"><a href="#Portfolio.sharpe-465"><span class="linenos">465</span></a><span class="sd">        The Sharpe ratio is calculated using the portfolio&#39;s NAV time series.</span>
</span><span id="Portfolio.sharpe-466"><a href="#Portfolio.sharpe-466"><span class="linenos">466</span></a><span class="sd">        A higher Sharpe ratio indicates better risk-adjusted performance.</span>
</span><span id="Portfolio.sharpe-467"><a href="#Portfolio.sharpe-467"><span class="linenos">467</span></a>
</span><span id="Portfolio.sharpe-468"><a href="#Portfolio.sharpe-468"><span class="linenos">468</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Portfolio.sharpe-469"><a href="#Portfolio.sharpe-469"><span class="linenos">469</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">sharpe</span><span class="p">(</span><span class="n">periods</span><span class="o">=</span><span class="n">periods</span><span class="p">)[</span><span class="s2">&quot;NAV&quot;</span><span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>Calculate the Sharpe ratio for the portfolio.</p>

<p>The Sharpe ratio is a measure of risk-adjusted return, calculated as
the portfolio's excess return divided by its volatility.</p>

<h2 id="parameters">Parameters</h2>

<p>periods : int, optional
    The number of periods per year for annualization.
    For daily data, use 252; for weekly data, use 52; for monthly data, use 12.
    If None, no annualization is performed.</p>

<h2 id="returns">Returns</h2>

<p>float
    The Sharpe ratio of the portfolio</p>

<h2 id="notes">Notes</h2>

<p>The Sharpe ratio is calculated using the portfolio's NAV time series.
A higher Sharpe ratio indicates better risk-adjusted performance.</p>
</div>


                            </div>
                            <div id="Portfolio.from_cashpos_prices" class="classattr">
                                        <input id="Portfolio.from_cashpos_prices-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-classmethod">@classmethod</div>

        <span class="def">def</span>
        <span class="name">from_cashpos_prices</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">cls</span>,</span><span class="param">	<span class="n">prices</span><span class="p">:</span> <span class="n">pandas</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">DataFrame</span>,</span><span class="param">	<span class="n">cashposition</span><span class="p">:</span> <span class="n">pandas</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">DataFrame</span>,</span><span class="param">	<span class="n">aum</span><span class="p">:</span> <span class="nb">float</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Portfolio.from_cashpos_prices-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Portfolio.from_cashpos_prices"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Portfolio.from_cashpos_prices-471"><a href="#Portfolio.from_cashpos_prices-471"><span class="linenos">471</span></a>    <span class="nd">@classmethod</span>
</span><span id="Portfolio.from_cashpos_prices-472"><a href="#Portfolio.from_cashpos_prices-472"><span class="linenos">472</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">from_cashpos_prices</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">prices</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">cashposition</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">aum</span><span class="p">:</span> <span class="nb">float</span><span class="p">):</span>
</span><span id="Portfolio.from_cashpos_prices-473"><a href="#Portfolio.from_cashpos_prices-473"><span class="linenos">473</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a Portfolio instance from cash positions and prices.</span>
</span><span id="Portfolio.from_cashpos_prices-474"><a href="#Portfolio.from_cashpos_prices-474"><span class="linenos">474</span></a>
</span><span id="Portfolio.from_cashpos_prices-475"><a href="#Portfolio.from_cashpos_prices-475"><span class="linenos">475</span></a><span class="sd">        This class method provides an alternative way to create a Portfolio instance</span>
</span><span id="Portfolio.from_cashpos_prices-476"><a href="#Portfolio.from_cashpos_prices-476"><span class="linenos">476</span></a><span class="sd">        when you have the cash positions rather than the number of units.</span>
</span><span id="Portfolio.from_cashpos_prices-477"><a href="#Portfolio.from_cashpos_prices-477"><span class="linenos">477</span></a>
</span><span id="Portfolio.from_cashpos_prices-478"><a href="#Portfolio.from_cashpos_prices-478"><span class="linenos">478</span></a><span class="sd">        Parameters</span>
</span><span id="Portfolio.from_cashpos_prices-479"><a href="#Portfolio.from_cashpos_prices-479"><span class="linenos">479</span></a><span class="sd">        ----------</span>
</span><span id="Portfolio.from_cashpos_prices-480"><a href="#Portfolio.from_cashpos_prices-480"><span class="linenos">480</span></a><span class="sd">        prices : pd.DataFrame</span>
</span><span id="Portfolio.from_cashpos_prices-481"><a href="#Portfolio.from_cashpos_prices-481"><span class="linenos">481</span></a><span class="sd">            DataFrame of asset prices over time, with dates as index and assets as columns</span>
</span><span id="Portfolio.from_cashpos_prices-482"><a href="#Portfolio.from_cashpos_prices-482"><span class="linenos">482</span></a><span class="sd">        cashposition : pd.DataFrame</span>
</span><span id="Portfolio.from_cashpos_prices-483"><a href="#Portfolio.from_cashpos_prices-483"><span class="linenos">483</span></a><span class="sd">            DataFrame of cash positions over time, with dates as index and assets as columns</span>
</span><span id="Portfolio.from_cashpos_prices-484"><a href="#Portfolio.from_cashpos_prices-484"><span class="linenos">484</span></a><span class="sd">        aum : float</span>
</span><span id="Portfolio.from_cashpos_prices-485"><a href="#Portfolio.from_cashpos_prices-485"><span class="linenos">485</span></a><span class="sd">            Assets under management</span>
</span><span id="Portfolio.from_cashpos_prices-486"><a href="#Portfolio.from_cashpos_prices-486"><span class="linenos">486</span></a>
</span><span id="Portfolio.from_cashpos_prices-487"><a href="#Portfolio.from_cashpos_prices-487"><span class="linenos">487</span></a><span class="sd">        Returns</span>
</span><span id="Portfolio.from_cashpos_prices-488"><a href="#Portfolio.from_cashpos_prices-488"><span class="linenos">488</span></a><span class="sd">        -------</span>
</span><span id="Portfolio.from_cashpos_prices-489"><a href="#Portfolio.from_cashpos_prices-489"><span class="linenos">489</span></a><span class="sd">        Portfolio</span>
</span><span id="Portfolio.from_cashpos_prices-490"><a href="#Portfolio.from_cashpos_prices-490"><span class="linenos">490</span></a><span class="sd">            A new Portfolio instance with units calculated from cash positions and prices</span>
</span><span id="Portfolio.from_cashpos_prices-491"><a href="#Portfolio.from_cashpos_prices-491"><span class="linenos">491</span></a>
</span><span id="Portfolio.from_cashpos_prices-492"><a href="#Portfolio.from_cashpos_prices-492"><span class="linenos">492</span></a><span class="sd">        Notes</span>
</span><span id="Portfolio.from_cashpos_prices-493"><a href="#Portfolio.from_cashpos_prices-493"><span class="linenos">493</span></a><span class="sd">        -----</span>
</span><span id="Portfolio.from_cashpos_prices-494"><a href="#Portfolio.from_cashpos_prices-494"><span class="linenos">494</span></a><span class="sd">        The units are calculated by dividing the cash positions by the prices.</span>
</span><span id="Portfolio.from_cashpos_prices-495"><a href="#Portfolio.from_cashpos_prices-495"><span class="linenos">495</span></a><span class="sd">        This is useful when you have the monetary value of each position rather</span>
</span><span id="Portfolio.from_cashpos_prices-496"><a href="#Portfolio.from_cashpos_prices-496"><span class="linenos">496</span></a><span class="sd">        than the number of units.</span>
</span><span id="Portfolio.from_cashpos_prices-497"><a href="#Portfolio.from_cashpos_prices-497"><span class="linenos">497</span></a>
</span><span id="Portfolio.from_cashpos_prices-498"><a href="#Portfolio.from_cashpos_prices-498"><span class="linenos">498</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Portfolio.from_cashpos_prices-499"><a href="#Portfolio.from_cashpos_prices-499"><span class="linenos">499</span></a>        <span class="n">units</span> <span class="o">=</span> <span class="n">cashposition</span><span class="o">.</span><span class="n">div</span><span class="p">(</span><span class="n">prices</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="mf">0.0</span><span class="p">)</span>
</span><span id="Portfolio.from_cashpos_prices-500"><a href="#Portfolio.from_cashpos_prices-500"><span class="linenos">500</span></a>        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">prices</span><span class="o">=</span><span class="n">prices</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="n">units</span><span class="p">,</span> <span class="n">aum</span><span class="o">=</span><span class="n">aum</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Create a Portfolio instance from cash positions and prices.</p>

<p>This class method provides an alternative way to create a Portfolio instance
when you have the cash positions rather than the number of units.</p>

<h2 id="parameters">Parameters</h2>

<p>prices : pd.DataFrame
    DataFrame of asset prices over time, with dates as index and assets as columns
cashposition : pd.DataFrame
    DataFrame of cash positions over time, with dates as index and assets as columns
aum : float
    Assets under management</p>

<h2 id="returns">Returns</h2>

<p>Portfolio
    A new Portfolio instance with units calculated from cash positions and prices</p>

<h2 id="notes">Notes</h2>

<p>The units are calculated by dividing the cash positions by the prices.
This is useful when you have the monetary value of each position rather
than the number of units.</p>
</div>


                            </div>
                            <div id="Portfolio.snapshot" class="classattr">
                                        <input id="Portfolio.snapshot-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">snapshot</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">title</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;Portfolio Summary&#39;</span>, </span><span class="param"><span class="n">log_scale</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Portfolio.snapshot-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Portfolio.snapshot"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Portfolio.snapshot-502"><a href="#Portfolio.snapshot-502"><span class="linenos">502</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">snapshot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">title</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;Portfolio Summary&quot;</span><span class="p">,</span> <span class="n">log_scale</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">):</span>
</span><span id="Portfolio.snapshot-503"><a href="#Portfolio.snapshot-503"><span class="linenos">503</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Generate and display a snapshot of the portfolio summary.</span>
</span><span id="Portfolio.snapshot-504"><a href="#Portfolio.snapshot-504"><span class="linenos">504</span></a>
</span><span id="Portfolio.snapshot-505"><a href="#Portfolio.snapshot-505"><span class="linenos">505</span></a><span class="sd">        This method creates a visual representation of the portfolio summary</span>
</span><span id="Portfolio.snapshot-506"><a href="#Portfolio.snapshot-506"><span class="linenos">506</span></a><span class="sd">        using the associated plot functionalities. The snapshot can be</span>
</span><span id="Portfolio.snapshot-507"><a href="#Portfolio.snapshot-507"><span class="linenos">507</span></a><span class="sd">        configured with a title and whether to use a logarithmic scale.</span>
</span><span id="Portfolio.snapshot-508"><a href="#Portfolio.snapshot-508"><span class="linenos">508</span></a>
</span><span id="Portfolio.snapshot-509"><a href="#Portfolio.snapshot-509"><span class="linenos">509</span></a><span class="sd">        Args:</span>
</span><span id="Portfolio.snapshot-510"><a href="#Portfolio.snapshot-510"><span class="linenos">510</span></a><span class="sd">            title: A string specifying the title of the snapshot.</span>
</span><span id="Portfolio.snapshot-511"><a href="#Portfolio.snapshot-511"><span class="linenos">511</span></a><span class="sd">                   Default is &quot;Portfolio Summary&quot;.</span>
</span><span id="Portfolio.snapshot-512"><a href="#Portfolio.snapshot-512"><span class="linenos">512</span></a><span class="sd">            log_scale: A boolean indicating whether to display the plot</span>
</span><span id="Portfolio.snapshot-513"><a href="#Portfolio.snapshot-513"><span class="linenos">513</span></a><span class="sd">                       using a logarithmic scale. Default is True.</span>
</span><span id="Portfolio.snapshot-514"><a href="#Portfolio.snapshot-514"><span class="linenos">514</span></a>
</span><span id="Portfolio.snapshot-515"><a href="#Portfolio.snapshot-515"><span class="linenos">515</span></a><span class="sd">        Returns:</span>
</span><span id="Portfolio.snapshot-516"><a href="#Portfolio.snapshot-516"><span class="linenos">516</span></a><span class="sd">            The generated plot object representing the portfolio snapshot.</span>
</span><span id="Portfolio.snapshot-517"><a href="#Portfolio.snapshot-517"><span class="linenos">517</span></a>
</span><span id="Portfolio.snapshot-518"><a href="#Portfolio.snapshot-518"><span class="linenos">518</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Portfolio.snapshot-519"><a href="#Portfolio.snapshot-519"><span class="linenos">519</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">plots</span><span class="o">.</span><span class="n">plot_snapshot</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">log_scale</span><span class="o">=</span><span class="n">log_scale</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Generate and display a snapshot of the portfolio summary.</p>

<p>This method creates a visual representation of the portfolio summary
using the associated plot functionalities. The snapshot can be
configured with a title and whether to use a logarithmic scale.</p>

<p>Args:
    title: A string specifying the title of the snapshot.
           Default is "Portfolio Summary".
    log_scale: A boolean indicating whether to display the plot
               using a logarithmic scale. Default is True.</p>

<p>Returns:
    The generated plot object representing the portfolio snapshot.</p>
</div>


                            </div>
                </section>
                <section id="State">
                            <input id="State-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
                    <div class="decorator decorator-dataclass">@dataclass()</div>

    <span class="def">class</span>
    <span class="name">State</span>:

                <label class="view-source-button" for="State-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#State"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="State-29"><a href="#State-29"><span class="linenos"> 29</span></a><span class="nd">@dataclass</span><span class="p">()</span>
</span><span id="State-30"><a href="#State-30"><span class="linenos"> 30</span></a><span class="k">class</span><span class="w"> </span><span class="nc">State</span><span class="p">:</span>
</span><span id="State-31"><a href="#State-31"><span class="linenos"> 31</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Represents the current state of a portfolio during simulation.</span>
</span><span id="State-32"><a href="#State-32"><span class="linenos"> 32</span></a>
</span><span id="State-33"><a href="#State-33"><span class="linenos"> 33</span></a><span class="sd">    The State class tracks the current positions, prices, cash, and other metrics</span>
</span><span id="State-34"><a href="#State-34"><span class="linenos"> 34</span></a><span class="sd">    of a portfolio at a specific point in time. It is updated within a loop by the</span>
</span><span id="State-35"><a href="#State-35"><span class="linenos"> 35</span></a><span class="sd">    Builder class during the simulation process.</span>
</span><span id="State-36"><a href="#State-36"><span class="linenos"> 36</span></a>
</span><span id="State-37"><a href="#State-37"><span class="linenos"> 37</span></a><span class="sd">    The class provides properties for accessing various portfolio metrics like</span>
</span><span id="State-38"><a href="#State-38"><span class="linenos"> 38</span></a><span class="sd">    cash, NAV, value, weights, and leverage. It also provides setter methods</span>
</span><span id="State-39"><a href="#State-39"><span class="linenos"> 39</span></a><span class="sd">    for updating the portfolio state (aum, cash, position, prices).</span>
</span><span id="State-40"><a href="#State-40"><span class="linenos"> 40</span></a>
</span><span id="State-41"><a href="#State-41"><span class="linenos"> 41</span></a><span class="sd">    Attributes</span>
</span><span id="State-42"><a href="#State-42"><span class="linenos"> 42</span></a><span class="sd">    ----------</span>
</span><span id="State-43"><a href="#State-43"><span class="linenos"> 43</span></a><span class="sd">    _prices : pd.Series</span>
</span><span id="State-44"><a href="#State-44"><span class="linenos"> 44</span></a><span class="sd">        Current prices of assets in the portfolio</span>
</span><span id="State-45"><a href="#State-45"><span class="linenos"> 45</span></a><span class="sd">    _position : pd.Series</span>
</span><span id="State-46"><a href="#State-46"><span class="linenos"> 46</span></a><span class="sd">        Current positions (units) of assets in the portfolio</span>
</span><span id="State-47"><a href="#State-47"><span class="linenos"> 47</span></a><span class="sd">    _trades : pd.Series</span>
</span><span id="State-48"><a href="#State-48"><span class="linenos"> 48</span></a><span class="sd">        Trades needed to reach the current position</span>
</span><span id="State-49"><a href="#State-49"><span class="linenos"> 49</span></a><span class="sd">    _time : datetime</span>
</span><span id="State-50"><a href="#State-50"><span class="linenos"> 50</span></a><span class="sd">        Current time in the simulation</span>
</span><span id="State-51"><a href="#State-51"><span class="linenos"> 51</span></a><span class="sd">    _days : int</span>
</span><span id="State-52"><a href="#State-52"><span class="linenos"> 52</span></a><span class="sd">        Number of days between the current and previous time</span>
</span><span id="State-53"><a href="#State-53"><span class="linenos"> 53</span></a><span class="sd">    _profit : float</span>
</span><span id="State-54"><a href="#State-54"><span class="linenos"> 54</span></a><span class="sd">        Profit achieved between the previous and current prices</span>
</span><span id="State-55"><a href="#State-55"><span class="linenos"> 55</span></a><span class="sd">    _aum : float</span>
</span><span id="State-56"><a href="#State-56"><span class="linenos"> 56</span></a><span class="sd">        Current assets under management (AUM) of the portfolio</span>
</span><span id="State-57"><a href="#State-57"><span class="linenos"> 57</span></a>
</span><span id="State-58"><a href="#State-58"><span class="linenos"> 58</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="State-59"><a href="#State-59"><span class="linenos"> 59</span></a>
</span><span id="State-60"><a href="#State-60"><span class="linenos"> 60</span></a>    <span class="n">_prices</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="State-61"><a href="#State-61"><span class="linenos"> 61</span></a>    <span class="n">_position</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="State-62"><a href="#State-62"><span class="linenos"> 62</span></a>    <span class="n">_trades</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="State-63"><a href="#State-63"><span class="linenos"> 63</span></a>    <span class="n">_time</span><span class="p">:</span> <span class="n">datetime</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="State-64"><a href="#State-64"><span class="linenos"> 64</span></a>    <span class="n">_days</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="State-65"><a href="#State-65"><span class="linenos"> 65</span></a>    <span class="n">_profit</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>
</span><span id="State-66"><a href="#State-66"><span class="linenos"> 66</span></a>    <span class="n">_aum</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>
</span><span id="State-67"><a href="#State-67"><span class="linenos"> 67</span></a>
</span><span id="State-68"><a href="#State-68"><span class="linenos"> 68</span></a>    <span class="nd">@property</span>
</span><span id="State-69"><a href="#State-69"><span class="linenos"> 69</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">cash</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="State-70"><a href="#State-70"><span class="linenos"> 70</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the current amount of cash available in the portfolio.</span>
</span><span id="State-71"><a href="#State-71"><span class="linenos"> 71</span></a>
</span><span id="State-72"><a href="#State-72"><span class="linenos"> 72</span></a><span class="sd">        Returns</span>
</span><span id="State-73"><a href="#State-73"><span class="linenos"> 73</span></a><span class="sd">        -------</span>
</span><span id="State-74"><a href="#State-74"><span class="linenos"> 74</span></a><span class="sd">        float</span>
</span><span id="State-75"><a href="#State-75"><span class="linenos"> 75</span></a><span class="sd">            The cash component of the portfolio, calculated as NAV minus</span>
</span><span id="State-76"><a href="#State-76"><span class="linenos"> 76</span></a><span class="sd">            the value of all positions</span>
</span><span id="State-77"><a href="#State-77"><span class="linenos"> 77</span></a>
</span><span id="State-78"><a href="#State-78"><span class="linenos"> 78</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="State-79"><a href="#State-79"><span class="linenos"> 79</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">nav</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span>
</span><span id="State-80"><a href="#State-80"><span class="linenos"> 80</span></a>
</span><span id="State-81"><a href="#State-81"><span class="linenos"> 81</span></a>    <span class="nd">@cash</span><span class="o">.</span><span class="n">setter</span>
</span><span id="State-82"><a href="#State-82"><span class="linenos"> 82</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">cash</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cash</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="State-83"><a href="#State-83"><span class="linenos"> 83</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Update the amount of cash available in the portfolio.</span>
</span><span id="State-84"><a href="#State-84"><span class="linenos"> 84</span></a>
</span><span id="State-85"><a href="#State-85"><span class="linenos"> 85</span></a><span class="sd">        This updates the AUM (assets under management) based on the new</span>
</span><span id="State-86"><a href="#State-86"><span class="linenos"> 86</span></a><span class="sd">        cash amount while keeping the value of positions constant.</span>
</span><span id="State-87"><a href="#State-87"><span class="linenos"> 87</span></a>
</span><span id="State-88"><a href="#State-88"><span class="linenos"> 88</span></a><span class="sd">        Parameters</span>
</span><span id="State-89"><a href="#State-89"><span class="linenos"> 89</span></a><span class="sd">        ----------</span>
</span><span id="State-90"><a href="#State-90"><span class="linenos"> 90</span></a><span class="sd">        cash : float</span>
</span><span id="State-91"><a href="#State-91"><span class="linenos"> 91</span></a><span class="sd">            The new cash amount to set</span>
</span><span id="State-92"><a href="#State-92"><span class="linenos"> 92</span></a>
</span><span id="State-93"><a href="#State-93"><span class="linenos"> 93</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="State-94"><a href="#State-94"><span class="linenos"> 94</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">aum</span> <span class="o">=</span> <span class="n">cash</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span>
</span><span id="State-95"><a href="#State-95"><span class="linenos"> 95</span></a>
</span><span id="State-96"><a href="#State-96"><span class="linenos"> 96</span></a>    <span class="nd">@property</span>
</span><span id="State-97"><a href="#State-97"><span class="linenos"> 97</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">nav</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="State-98"><a href="#State-98"><span class="linenos"> 98</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the net asset value (NAV) of the portfolio.</span>
</span><span id="State-99"><a href="#State-99"><span class="linenos"> 99</span></a>
</span><span id="State-100"><a href="#State-100"><span class="linenos">100</span></a><span class="sd">        The NAV represents the total value of the portfolio, including</span>
</span><span id="State-101"><a href="#State-101"><span class="linenos">101</span></a><span class="sd">        both the value of positions and available cash.</span>
</span><span id="State-102"><a href="#State-102"><span class="linenos">102</span></a>
</span><span id="State-103"><a href="#State-103"><span class="linenos">103</span></a><span class="sd">        Returns</span>
</span><span id="State-104"><a href="#State-104"><span class="linenos">104</span></a><span class="sd">        -------</span>
</span><span id="State-105"><a href="#State-105"><span class="linenos">105</span></a><span class="sd">        float</span>
</span><span id="State-106"><a href="#State-106"><span class="linenos">106</span></a><span class="sd">            The net asset value of the portfolio</span>
</span><span id="State-107"><a href="#State-107"><span class="linenos">107</span></a>
</span><span id="State-108"><a href="#State-108"><span class="linenos">108</span></a><span class="sd">        Notes</span>
</span><span id="State-109"><a href="#State-109"><span class="linenos">109</span></a><span class="sd">        -----</span>
</span><span id="State-110"><a href="#State-110"><span class="linenos">110</span></a><span class="sd">        This is equivalent to the AUM (assets under management).</span>
</span><span id="State-111"><a href="#State-111"><span class="linenos">111</span></a>
</span><span id="State-112"><a href="#State-112"><span class="linenos">112</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="State-113"><a href="#State-113"><span class="linenos">113</span></a>        <span class="c1"># assert np.isclose(self.value + self.cash, self.aum), f&quot;{self.value + self.cash} != {self.aum}&quot;</span>
</span><span id="State-114"><a href="#State-114"><span class="linenos">114</span></a>        <span class="c1"># return self.value + self.cash</span>
</span><span id="State-115"><a href="#State-115"><span class="linenos">115</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">aum</span>
</span><span id="State-116"><a href="#State-116"><span class="linenos">116</span></a>
</span><span id="State-117"><a href="#State-117"><span class="linenos">117</span></a>    <span class="nd">@property</span>
</span><span id="State-118"><a href="#State-118"><span class="linenos">118</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">value</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="State-119"><a href="#State-119"><span class="linenos">119</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the value of all positions in the portfolio.</span>
</span><span id="State-120"><a href="#State-120"><span class="linenos">120</span></a>
</span><span id="State-121"><a href="#State-121"><span class="linenos">121</span></a><span class="sd">        This computes the total value of all holdings at current prices,</span>
</span><span id="State-122"><a href="#State-122"><span class="linenos">122</span></a><span class="sd">        not including cash.</span>
</span><span id="State-123"><a href="#State-123"><span class="linenos">123</span></a>
</span><span id="State-124"><a href="#State-124"><span class="linenos">124</span></a><span class="sd">        Returns</span>
</span><span id="State-125"><a href="#State-125"><span class="linenos">125</span></a><span class="sd">        -------</span>
</span><span id="State-126"><a href="#State-126"><span class="linenos">126</span></a><span class="sd">        float</span>
</span><span id="State-127"><a href="#State-127"><span class="linenos">127</span></a><span class="sd">            The sum of values of all positions</span>
</span><span id="State-128"><a href="#State-128"><span class="linenos">128</span></a>
</span><span id="State-129"><a href="#State-129"><span class="linenos">129</span></a><span class="sd">        Notes</span>
</span><span id="State-130"><a href="#State-130"><span class="linenos">130</span></a><span class="sd">        -----</span>
</span><span id="State-131"><a href="#State-131"><span class="linenos">131</span></a><span class="sd">        If positions are missing (None), the sum will effectively be zero.</span>
</span><span id="State-132"><a href="#State-132"><span class="linenos">132</span></a>
</span><span id="State-133"><a href="#State-133"><span class="linenos">133</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="State-134"><a href="#State-134"><span class="linenos">134</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">cashposition</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</span><span id="State-135"><a href="#State-135"><span class="linenos">135</span></a>
</span><span id="State-136"><a href="#State-136"><span class="linenos">136</span></a>    <span class="nd">@property</span>
</span><span id="State-137"><a href="#State-137"><span class="linenos">137</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">cashposition</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">:</span>
</span><span id="State-138"><a href="#State-138"><span class="linenos">138</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the cash value of each position in the portfolio.</span>
</span><span id="State-139"><a href="#State-139"><span class="linenos">139</span></a>
</span><span id="State-140"><a href="#State-140"><span class="linenos">140</span></a><span class="sd">        This computes the cash value of each position by multiplying</span>
</span><span id="State-141"><a href="#State-141"><span class="linenos">141</span></a><span class="sd">        the number of units by the current price for each asset.</span>
</span><span id="State-142"><a href="#State-142"><span class="linenos">142</span></a>
</span><span id="State-143"><a href="#State-143"><span class="linenos">143</span></a><span class="sd">        Returns</span>
</span><span id="State-144"><a href="#State-144"><span class="linenos">144</span></a><span class="sd">        -------</span>
</span><span id="State-145"><a href="#State-145"><span class="linenos">145</span></a><span class="sd">        pd.Series</span>
</span><span id="State-146"><a href="#State-146"><span class="linenos">146</span></a><span class="sd">            Series with the cash value of each position, indexed by asset</span>
</span><span id="State-147"><a href="#State-147"><span class="linenos">147</span></a>
</span><span id="State-148"><a href="#State-148"><span class="linenos">148</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="State-149"><a href="#State-149"><span class="linenos">149</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">prices</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">position</span>
</span><span id="State-150"><a href="#State-150"><span class="linenos">150</span></a>
</span><span id="State-151"><a href="#State-151"><span class="linenos">151</span></a>    <span class="nd">@property</span>
</span><span id="State-152"><a href="#State-152"><span class="linenos">152</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">position</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">:</span>
</span><span id="State-153"><a href="#State-153"><span class="linenos">153</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the current position (number of units) for each asset.</span>
</span><span id="State-154"><a href="#State-154"><span class="linenos">154</span></a>
</span><span id="State-155"><a href="#State-155"><span class="linenos">155</span></a><span class="sd">        Returns</span>
</span><span id="State-156"><a href="#State-156"><span class="linenos">156</span></a><span class="sd">        -------</span>
</span><span id="State-157"><a href="#State-157"><span class="linenos">157</span></a><span class="sd">        pd.Series</span>
</span><span id="State-158"><a href="#State-158"><span class="linenos">158</span></a><span class="sd">            Series with the number of units held for each asset, indexed by asset.</span>
</span><span id="State-159"><a href="#State-159"><span class="linenos">159</span></a><span class="sd">            If the position is not yet set, returns an empty series with the</span>
</span><span id="State-160"><a href="#State-160"><span class="linenos">160</span></a><span class="sd">            correct index.</span>
</span><span id="State-161"><a href="#State-161"><span class="linenos">161</span></a>
</span><span id="State-162"><a href="#State-162"><span class="linenos">162</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="State-163"><a href="#State-163"><span class="linenos">163</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_position</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="State-164"><a href="#State-164"><span class="linenos">164</span></a>            <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">assets</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
</span><span id="State-165"><a href="#State-165"><span class="linenos">165</span></a>
</span><span id="State-166"><a href="#State-166"><span class="linenos">166</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_position</span>
</span><span id="State-167"><a href="#State-167"><span class="linenos">167</span></a>
</span><span id="State-168"><a href="#State-168"><span class="linenos">168</span></a>    <span class="nd">@position</span><span class="o">.</span><span class="n">setter</span>
</span><span id="State-169"><a href="#State-169"><span class="linenos">169</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">position</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">position</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="State-170"><a href="#State-170"><span class="linenos">170</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Update the position of the portfolio.</span>
</span><span id="State-171"><a href="#State-171"><span class="linenos">171</span></a>
</span><span id="State-172"><a href="#State-172"><span class="linenos">172</span></a><span class="sd">        This method updates the position (number of units) for each asset,</span>
</span><span id="State-173"><a href="#State-173"><span class="linenos">173</span></a><span class="sd">        computes the required trades to reach the new position, and updates</span>
</span><span id="State-174"><a href="#State-174"><span class="linenos">174</span></a><span class="sd">        the internal state.</span>
</span><span id="State-175"><a href="#State-175"><span class="linenos">175</span></a>
</span><span id="State-176"><a href="#State-176"><span class="linenos">176</span></a><span class="sd">        Parameters</span>
</span><span id="State-177"><a href="#State-177"><span class="linenos">177</span></a><span class="sd">        ----------</span>
</span><span id="State-178"><a href="#State-178"><span class="linenos">178</span></a><span class="sd">        position : Union[np.ndarray, pd.Series]</span>
</span><span id="State-179"><a href="#State-179"><span class="linenos">179</span></a><span class="sd">            The new position to set, either as a numpy array or pandas Series.</span>
</span><span id="State-180"><a href="#State-180"><span class="linenos">180</span></a><span class="sd">            If a numpy array, it must have the same length as self.assets.</span>
</span><span id="State-181"><a href="#State-181"><span class="linenos">181</span></a>
</span><span id="State-182"><a href="#State-182"><span class="linenos">182</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="State-183"><a href="#State-183"><span class="linenos">183</span></a>        <span class="c1"># update the position</span>
</span><span id="State-184"><a href="#State-184"><span class="linenos">184</span></a>        <span class="n">position</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">assets</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">position</span><span class="p">)</span>
</span><span id="State-185"><a href="#State-185"><span class="linenos">185</span></a>
</span><span id="State-186"><a href="#State-186"><span class="linenos">186</span></a>        <span class="c1"># compute the trades (can be fractional)</span>
</span><span id="State-187"><a href="#State-187"><span class="linenos">187</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_trades</span> <span class="o">=</span> <span class="n">position</span><span class="o">.</span><span class="n">subtract</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">position</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="mf">0.0</span><span class="p">)</span>
</span><span id="State-188"><a href="#State-188"><span class="linenos">188</span></a>
</span><span id="State-189"><a href="#State-189"><span class="linenos">189</span></a>        <span class="c1"># update only now as otherwise the trades would be wrong</span>
</span><span id="State-190"><a href="#State-190"><span class="linenos">190</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_position</span> <span class="o">=</span> <span class="n">position</span>
</span><span id="State-191"><a href="#State-191"><span class="linenos">191</span></a>
</span><span id="State-192"><a href="#State-192"><span class="linenos">192</span></a>    <span class="nd">@property</span>
</span><span id="State-193"><a href="#State-193"><span class="linenos">193</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">gmv</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="State-194"><a href="#State-194"><span class="linenos">194</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the gross market value of the portfolio.</span>
</span><span id="State-195"><a href="#State-195"><span class="linenos">195</span></a>
</span><span id="State-196"><a href="#State-196"><span class="linenos">196</span></a><span class="sd">        The gross market value is the sum of the absolute values of all positions,</span>
</span><span id="State-197"><a href="#State-197"><span class="linenos">197</span></a><span class="sd">        which represents the total market exposure including both long and short positions.</span>
</span><span id="State-198"><a href="#State-198"><span class="linenos">198</span></a>
</span><span id="State-199"><a href="#State-199"><span class="linenos">199</span></a><span class="sd">        Returns</span>
</span><span id="State-200"><a href="#State-200"><span class="linenos">200</span></a><span class="sd">        -------</span>
</span><span id="State-201"><a href="#State-201"><span class="linenos">201</span></a><span class="sd">        float</span>
</span><span id="State-202"><a href="#State-202"><span class="linenos">202</span></a><span class="sd">            The gross market value (abs(short) + long)</span>
</span><span id="State-203"><a href="#State-203"><span class="linenos">203</span></a>
</span><span id="State-204"><a href="#State-204"><span class="linenos">204</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="State-205"><a href="#State-205"><span class="linenos">205</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">cashposition</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</span><span id="State-206"><a href="#State-206"><span class="linenos">206</span></a>
</span><span id="State-207"><a href="#State-207"><span class="linenos">207</span></a>    <span class="nd">@property</span>
</span><span id="State-208"><a href="#State-208"><span class="linenos">208</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">time</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">datetime</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="State-209"><a href="#State-209"><span class="linenos">209</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the current time of the portfolio state.</span>
</span><span id="State-210"><a href="#State-210"><span class="linenos">210</span></a>
</span><span id="State-211"><a href="#State-211"><span class="linenos">211</span></a><span class="sd">        Returns</span>
</span><span id="State-212"><a href="#State-212"><span class="linenos">212</span></a><span class="sd">        -------</span>
</span><span id="State-213"><a href="#State-213"><span class="linenos">213</span></a><span class="sd">        Optional[datetime]</span>
</span><span id="State-214"><a href="#State-214"><span class="linenos">214</span></a><span class="sd">            The current time in the simulation, or None if not set</span>
</span><span id="State-215"><a href="#State-215"><span class="linenos">215</span></a>
</span><span id="State-216"><a href="#State-216"><span class="linenos">216</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="State-217"><a href="#State-217"><span class="linenos">217</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_time</span>
</span><span id="State-218"><a href="#State-218"><span class="linenos">218</span></a>
</span><span id="State-219"><a href="#State-219"><span class="linenos">219</span></a>    <span class="nd">@time</span><span class="o">.</span><span class="n">setter</span>
</span><span id="State-220"><a href="#State-220"><span class="linenos">220</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">time</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">time</span><span class="p">:</span> <span class="n">datetime</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="State-221"><a href="#State-221"><span class="linenos">221</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Update the time of the portfolio state.</span>
</span><span id="State-222"><a href="#State-222"><span class="linenos">222</span></a>
</span><span id="State-223"><a href="#State-223"><span class="linenos">223</span></a><span class="sd">        This method updates the current time and computes the number of days</span>
</span><span id="State-224"><a href="#State-224"><span class="linenos">224</span></a><span class="sd">        between the new time and the previous time.</span>
</span><span id="State-225"><a href="#State-225"><span class="linenos">225</span></a>
</span><span id="State-226"><a href="#State-226"><span class="linenos">226</span></a><span class="sd">        Parameters</span>
</span><span id="State-227"><a href="#State-227"><span class="linenos">227</span></a><span class="sd">        ----------</span>
</span><span id="State-228"><a href="#State-228"><span class="linenos">228</span></a><span class="sd">        time : datetime</span>
</span><span id="State-229"><a href="#State-229"><span class="linenos">229</span></a><span class="sd">            The new time to set</span>
</span><span id="State-230"><a href="#State-230"><span class="linenos">230</span></a>
</span><span id="State-231"><a href="#State-231"><span class="linenos">231</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="State-232"><a href="#State-232"><span class="linenos">232</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">time</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="State-233"><a href="#State-233"><span class="linenos">233</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_days</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="State-234"><a href="#State-234"><span class="linenos">234</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_time</span> <span class="o">=</span> <span class="n">time</span>
</span><span id="State-235"><a href="#State-235"><span class="linenos">235</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="State-236"><a href="#State-236"><span class="linenos">236</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_days</span> <span class="o">=</span> <span class="p">(</span><span class="n">time</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">time</span><span class="p">)</span><span class="o">.</span><span class="n">days</span>
</span><span id="State-237"><a href="#State-237"><span class="linenos">237</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_time</span> <span class="o">=</span> <span class="n">time</span>
</span><span id="State-238"><a href="#State-238"><span class="linenos">238</span></a>
</span><span id="State-239"><a href="#State-239"><span class="linenos">239</span></a>    <span class="nd">@property</span>
</span><span id="State-240"><a href="#State-240"><span class="linenos">240</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">days</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span><span id="State-241"><a href="#State-241"><span class="linenos">241</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the number of days between the current and previous time.</span>
</span><span id="State-242"><a href="#State-242"><span class="linenos">242</span></a>
</span><span id="State-243"><a href="#State-243"><span class="linenos">243</span></a><span class="sd">        Returns</span>
</span><span id="State-244"><a href="#State-244"><span class="linenos">244</span></a><span class="sd">        -------</span>
</span><span id="State-245"><a href="#State-245"><span class="linenos">245</span></a><span class="sd">        int</span>
</span><span id="State-246"><a href="#State-246"><span class="linenos">246</span></a><span class="sd">            Number of days between the current and previous time</span>
</span><span id="State-247"><a href="#State-247"><span class="linenos">247</span></a>
</span><span id="State-248"><a href="#State-248"><span class="linenos">248</span></a><span class="sd">        Notes</span>
</span><span id="State-249"><a href="#State-249"><span class="linenos">249</span></a><span class="sd">        -----</span>
</span><span id="State-250"><a href="#State-250"><span class="linenos">250</span></a><span class="sd">        This is useful for computing interest when holding cash or for</span>
</span><span id="State-251"><a href="#State-251"><span class="linenos">251</span></a><span class="sd">        time-dependent calculations.</span>
</span><span id="State-252"><a href="#State-252"><span class="linenos">252</span></a>
</span><span id="State-253"><a href="#State-253"><span class="linenos">253</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="State-254"><a href="#State-254"><span class="linenos">254</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_days</span>
</span><span id="State-255"><a href="#State-255"><span class="linenos">255</span></a>
</span><span id="State-256"><a href="#State-256"><span class="linenos">256</span></a>    <span class="nd">@property</span>
</span><span id="State-257"><a href="#State-257"><span class="linenos">257</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">assets</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">Index</span><span class="p">:</span>
</span><span id="State-258"><a href="#State-258"><span class="linenos">258</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the assets currently in the portfolio.</span>
</span><span id="State-259"><a href="#State-259"><span class="linenos">259</span></a>
</span><span id="State-260"><a href="#State-260"><span class="linenos">260</span></a><span class="sd">        Returns</span>
</span><span id="State-261"><a href="#State-261"><span class="linenos">261</span></a><span class="sd">        -------</span>
</span><span id="State-262"><a href="#State-262"><span class="linenos">262</span></a><span class="sd">        pd.Index</span>
</span><span id="State-263"><a href="#State-263"><span class="linenos">263</span></a><span class="sd">            Index of assets with valid prices in the portfolio.</span>
</span><span id="State-264"><a href="#State-264"><span class="linenos">264</span></a><span class="sd">            If no prices are set, returns an empty index.</span>
</span><span id="State-265"><a href="#State-265"><span class="linenos">265</span></a>
</span><span id="State-266"><a href="#State-266"><span class="linenos">266</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="State-267"><a href="#State-267"><span class="linenos">267</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prices</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="State-268"><a href="#State-268"><span class="linenos">268</span></a>            <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">Index</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="p">[],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">str</span><span class="p">)</span>
</span><span id="State-269"><a href="#State-269"><span class="linenos">269</span></a>
</span><span id="State-270"><a href="#State-270"><span class="linenos">270</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">prices</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">index</span>
</span><span id="State-271"><a href="#State-271"><span class="linenos">271</span></a>
</span><span id="State-272"><a href="#State-272"><span class="linenos">272</span></a>    <span class="nd">@property</span>
</span><span id="State-273"><a href="#State-273"><span class="linenos">273</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">trades</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="State-274"><a href="#State-274"><span class="linenos">274</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the trades needed to reach the current position.</span>
</span><span id="State-275"><a href="#State-275"><span class="linenos">275</span></a>
</span><span id="State-276"><a href="#State-276"><span class="linenos">276</span></a><span class="sd">        Returns</span>
</span><span id="State-277"><a href="#State-277"><span class="linenos">277</span></a><span class="sd">        -------</span>
</span><span id="State-278"><a href="#State-278"><span class="linenos">278</span></a><span class="sd">        Optional[pd.Series]</span>
</span><span id="State-279"><a href="#State-279"><span class="linenos">279</span></a><span class="sd">            Series of trades (changes in position) needed to reach the current position.</span>
</span><span id="State-280"><a href="#State-280"><span class="linenos">280</span></a><span class="sd">            None if no trades have been calculated yet.</span>
</span><span id="State-281"><a href="#State-281"><span class="linenos">281</span></a>
</span><span id="State-282"><a href="#State-282"><span class="linenos">282</span></a><span class="sd">        Notes</span>
</span><span id="State-283"><a href="#State-283"><span class="linenos">283</span></a><span class="sd">        -----</span>
</span><span id="State-284"><a href="#State-284"><span class="linenos">284</span></a><span class="sd">        This is helpful when computing trading costs following a position change.</span>
</span><span id="State-285"><a href="#State-285"><span class="linenos">285</span></a><span class="sd">        Positive values represent buys, negative values represent sells.</span>
</span><span id="State-286"><a href="#State-286"><span class="linenos">286</span></a>
</span><span id="State-287"><a href="#State-287"><span class="linenos">287</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="State-288"><a href="#State-288"><span class="linenos">288</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_trades</span>
</span><span id="State-289"><a href="#State-289"><span class="linenos">289</span></a>
</span><span id="State-290"><a href="#State-290"><span class="linenos">290</span></a>    <span class="nd">@property</span>
</span><span id="State-291"><a href="#State-291"><span class="linenos">291</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">mask</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
</span><span id="State-292"><a href="#State-292"><span class="linenos">292</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get a boolean mask for assets with valid (non-NaN) prices.</span>
</span><span id="State-293"><a href="#State-293"><span class="linenos">293</span></a>
</span><span id="State-294"><a href="#State-294"><span class="linenos">294</span></a><span class="sd">        Returns</span>
</span><span id="State-295"><a href="#State-295"><span class="linenos">295</span></a><span class="sd">        -------</span>
</span><span id="State-296"><a href="#State-296"><span class="linenos">296</span></a><span class="sd">        np.ndarray</span>
</span><span id="State-297"><a href="#State-297"><span class="linenos">297</span></a><span class="sd">            Boolean array where True indicates a valid price and False indicates</span>
</span><span id="State-298"><a href="#State-298"><span class="linenos">298</span></a><span class="sd">            a missing (NaN) price. Returns an empty array if no prices are set.</span>
</span><span id="State-299"><a href="#State-299"><span class="linenos">299</span></a>
</span><span id="State-300"><a href="#State-300"><span class="linenos">300</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="State-301"><a href="#State-301"><span class="linenos">301</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prices</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="State-302"><a href="#State-302"><span class="linenos">302</span></a>            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">bool</span><span class="p">)</span>
</span><span id="State-303"><a href="#State-303"><span class="linenos">303</span></a>
</span><span id="State-304"><a href="#State-304"><span class="linenos">304</span></a>        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">isfinite</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">prices</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
</span><span id="State-305"><a href="#State-305"><span class="linenos">305</span></a>
</span><span id="State-306"><a href="#State-306"><span class="linenos">306</span></a>    <span class="nd">@property</span>
</span><span id="State-307"><a href="#State-307"><span class="linenos">307</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">prices</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">:</span>
</span><span id="State-308"><a href="#State-308"><span class="linenos">308</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the current prices of assets in the portfolio.</span>
</span><span id="State-309"><a href="#State-309"><span class="linenos">309</span></a>
</span><span id="State-310"><a href="#State-310"><span class="linenos">310</span></a><span class="sd">        Returns</span>
</span><span id="State-311"><a href="#State-311"><span class="linenos">311</span></a><span class="sd">        -------</span>
</span><span id="State-312"><a href="#State-312"><span class="linenos">312</span></a><span class="sd">        pd.Series</span>
</span><span id="State-313"><a href="#State-313"><span class="linenos">313</span></a><span class="sd">            Series of current prices indexed by asset.</span>
</span><span id="State-314"><a href="#State-314"><span class="linenos">314</span></a><span class="sd">            Returns an empty series if no prices are set.</span>
</span><span id="State-315"><a href="#State-315"><span class="linenos">315</span></a>
</span><span id="State-316"><a href="#State-316"><span class="linenos">316</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="State-317"><a href="#State-317"><span class="linenos">317</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prices</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="State-318"><a href="#State-318"><span class="linenos">318</span></a>            <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
</span><span id="State-319"><a href="#State-319"><span class="linenos">319</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prices</span>
</span><span id="State-320"><a href="#State-320"><span class="linenos">320</span></a>
</span><span id="State-321"><a href="#State-321"><span class="linenos">321</span></a>    <span class="nd">@prices</span><span class="o">.</span><span class="n">setter</span>
</span><span id="State-322"><a href="#State-322"><span class="linenos">322</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">prices</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prices</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span> <span class="o">|</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="State-323"><a href="#State-323"><span class="linenos">323</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Update the prices of assets in the portfolio.</span>
</span><span id="State-324"><a href="#State-324"><span class="linenos">324</span></a>
</span><span id="State-325"><a href="#State-325"><span class="linenos">325</span></a><span class="sd">        This method updates the prices and calculates the profit achieved</span>
</span><span id="State-326"><a href="#State-326"><span class="linenos">326</span></a><span class="sd">        due to price changes. It also updates the portfolio&#39;s AUM by adding</span>
</span><span id="State-327"><a href="#State-327"><span class="linenos">327</span></a><span class="sd">        the profit.</span>
</span><span id="State-328"><a href="#State-328"><span class="linenos">328</span></a>
</span><span id="State-329"><a href="#State-329"><span class="linenos">329</span></a><span class="sd">        Parameters</span>
</span><span id="State-330"><a href="#State-330"><span class="linenos">330</span></a><span class="sd">        ----------</span>
</span><span id="State-331"><a href="#State-331"><span class="linenos">331</span></a><span class="sd">        prices : pd.Series</span>
</span><span id="State-332"><a href="#State-332"><span class="linenos">332</span></a><span class="sd">            New prices for assets in the portfolio</span>
</span><span id="State-333"><a href="#State-333"><span class="linenos">333</span></a>
</span><span id="State-334"><a href="#State-334"><span class="linenos">334</span></a><span class="sd">        Notes</span>
</span><span id="State-335"><a href="#State-335"><span class="linenos">335</span></a><span class="sd">        -----</span>
</span><span id="State-336"><a href="#State-336"><span class="linenos">336</span></a><span class="sd">        The profit is calculated as the difference between the portfolio value</span>
</span><span id="State-337"><a href="#State-337"><span class="linenos">337</span></a><span class="sd">        before and after the price update.</span>
</span><span id="State-338"><a href="#State-338"><span class="linenos">338</span></a>
</span><span id="State-339"><a href="#State-339"><span class="linenos">339</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="State-340"><a href="#State-340"><span class="linenos">340</span></a>        <span class="n">value_before</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">prices</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">position</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>  <span class="c1"># self.cashposition.sum()</span>
</span><span id="State-341"><a href="#State-341"><span class="linenos">341</span></a>        <span class="n">value_after</span> <span class="o">=</span> <span class="p">(</span><span class="n">prices</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">position</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</span><span id="State-342"><a href="#State-342"><span class="linenos">342</span></a>
</span><span id="State-343"><a href="#State-343"><span class="linenos">343</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_prices</span> <span class="o">=</span> <span class="n">prices</span>
</span><span id="State-344"><a href="#State-344"><span class="linenos">344</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_profit</span> <span class="o">=</span> <span class="n">value_after</span> <span class="o">-</span> <span class="n">value_before</span>
</span><span id="State-345"><a href="#State-345"><span class="linenos">345</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">aum</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">profit</span>
</span><span id="State-346"><a href="#State-346"><span class="linenos">346</span></a>
</span><span id="State-347"><a href="#State-347"><span class="linenos">347</span></a>    <span class="nd">@property</span>
</span><span id="State-348"><a href="#State-348"><span class="linenos">348</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">profit</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="State-349"><a href="#State-349"><span class="linenos">349</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the profit achieved between the previous and current prices.</span>
</span><span id="State-350"><a href="#State-350"><span class="linenos">350</span></a>
</span><span id="State-351"><a href="#State-351"><span class="linenos">351</span></a><span class="sd">        Returns</span>
</span><span id="State-352"><a href="#State-352"><span class="linenos">352</span></a><span class="sd">        -------</span>
</span><span id="State-353"><a href="#State-353"><span class="linenos">353</span></a><span class="sd">        float</span>
</span><span id="State-354"><a href="#State-354"><span class="linenos">354</span></a><span class="sd">            The profit (or loss) achieved due to price changes since the</span>
</span><span id="State-355"><a href="#State-355"><span class="linenos">355</span></a><span class="sd">            last price update</span>
</span><span id="State-356"><a href="#State-356"><span class="linenos">356</span></a>
</span><span id="State-357"><a href="#State-357"><span class="linenos">357</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="State-358"><a href="#State-358"><span class="linenos">358</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_profit</span>
</span><span id="State-359"><a href="#State-359"><span class="linenos">359</span></a>
</span><span id="State-360"><a href="#State-360"><span class="linenos">360</span></a>    <span class="nd">@property</span>
</span><span id="State-361"><a href="#State-361"><span class="linenos">361</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">aum</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="State-362"><a href="#State-362"><span class="linenos">362</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the current assets under management (AUM) of the portfolio.</span>
</span><span id="State-363"><a href="#State-363"><span class="linenos">363</span></a>
</span><span id="State-364"><a href="#State-364"><span class="linenos">364</span></a><span class="sd">        Returns</span>
</span><span id="State-365"><a href="#State-365"><span class="linenos">365</span></a><span class="sd">        -------</span>
</span><span id="State-366"><a href="#State-366"><span class="linenos">366</span></a><span class="sd">        float</span>
</span><span id="State-367"><a href="#State-367"><span class="linenos">367</span></a><span class="sd">            The total assets under management</span>
</span><span id="State-368"><a href="#State-368"><span class="linenos">368</span></a>
</span><span id="State-369"><a href="#State-369"><span class="linenos">369</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="State-370"><a href="#State-370"><span class="linenos">370</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_aum</span>
</span><span id="State-371"><a href="#State-371"><span class="linenos">371</span></a>
</span><span id="State-372"><a href="#State-372"><span class="linenos">372</span></a>    <span class="nd">@aum</span><span class="o">.</span><span class="n">setter</span>
</span><span id="State-373"><a href="#State-373"><span class="linenos">373</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">aum</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">aum</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="State-374"><a href="#State-374"><span class="linenos">374</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Update the assets under management (AUM) of the portfolio.</span>
</span><span id="State-375"><a href="#State-375"><span class="linenos">375</span></a>
</span><span id="State-376"><a href="#State-376"><span class="linenos">376</span></a><span class="sd">        Parameters</span>
</span><span id="State-377"><a href="#State-377"><span class="linenos">377</span></a><span class="sd">        ----------</span>
</span><span id="State-378"><a href="#State-378"><span class="linenos">378</span></a><span class="sd">        aum : float</span>
</span><span id="State-379"><a href="#State-379"><span class="linenos">379</span></a><span class="sd">            The new assets under management value to set</span>
</span><span id="State-380"><a href="#State-380"><span class="linenos">380</span></a>
</span><span id="State-381"><a href="#State-381"><span class="linenos">381</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="State-382"><a href="#State-382"><span class="linenos">382</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_aum</span> <span class="o">=</span> <span class="n">aum</span>
</span><span id="State-383"><a href="#State-383"><span class="linenos">383</span></a>
</span><span id="State-384"><a href="#State-384"><span class="linenos">384</span></a>    <span class="nd">@property</span>
</span><span id="State-385"><a href="#State-385"><span class="linenos">385</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">weights</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">:</span>
</span><span id="State-386"><a href="#State-386"><span class="linenos">386</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the weight of each asset in the portfolio.</span>
</span><span id="State-387"><a href="#State-387"><span class="linenos">387</span></a>
</span><span id="State-388"><a href="#State-388"><span class="linenos">388</span></a><span class="sd">        This computes the weighting of each asset as a fraction of the</span>
</span><span id="State-389"><a href="#State-389"><span class="linenos">389</span></a><span class="sd">        total portfolio value (NAV).</span>
</span><span id="State-390"><a href="#State-390"><span class="linenos">390</span></a>
</span><span id="State-391"><a href="#State-391"><span class="linenos">391</span></a><span class="sd">        Returns</span>
</span><span id="State-392"><a href="#State-392"><span class="linenos">392</span></a><span class="sd">        -------</span>
</span><span id="State-393"><a href="#State-393"><span class="linenos">393</span></a><span class="sd">        pd.Series</span>
</span><span id="State-394"><a href="#State-394"><span class="linenos">394</span></a><span class="sd">            Series containing the weight of each asset as a fraction of the</span>
</span><span id="State-395"><a href="#State-395"><span class="linenos">395</span></a><span class="sd">            total portfolio value, indexed by asset</span>
</span><span id="State-396"><a href="#State-396"><span class="linenos">396</span></a>
</span><span id="State-397"><a href="#State-397"><span class="linenos">397</span></a><span class="sd">        Notes</span>
</span><span id="State-398"><a href="#State-398"><span class="linenos">398</span></a><span class="sd">        -----</span>
</span><span id="State-399"><a href="#State-399"><span class="linenos">399</span></a><span class="sd">        If positions are missing, a series of zeros is effectively returned.</span>
</span><span id="State-400"><a href="#State-400"><span class="linenos">400</span></a><span class="sd">        The sum of weights equals 1.0 for a fully invested portfolio with no leverage.</span>
</span><span id="State-401"><a href="#State-401"><span class="linenos">401</span></a>
</span><span id="State-402"><a href="#State-402"><span class="linenos">402</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="State-403"><a href="#State-403"><span class="linenos">403</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nav</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">aum</span><span class="p">):</span>
</span><span id="State-404"><a href="#State-404"><span class="linenos">404</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">nav</span><span class="si">}</span><span class="s2"> != </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">aum</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="State-405"><a href="#State-405"><span class="linenos">405</span></a>
</span><span id="State-406"><a href="#State-406"><span class="linenos">406</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">cashposition</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">nav</span>
</span><span id="State-407"><a href="#State-407"><span class="linenos">407</span></a>
</span><span id="State-408"><a href="#State-408"><span class="linenos">408</span></a>    <span class="nd">@property</span>
</span><span id="State-409"><a href="#State-409"><span class="linenos">409</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">leverage</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="State-410"><a href="#State-410"><span class="linenos">410</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the leverage of the portfolio.</span>
</span><span id="State-411"><a href="#State-411"><span class="linenos">411</span></a>
</span><span id="State-412"><a href="#State-412"><span class="linenos">412</span></a><span class="sd">        Leverage is calculated as the sum of the absolute values of all position</span>
</span><span id="State-413"><a href="#State-413"><span class="linenos">413</span></a><span class="sd">        weights. For a long-only portfolio with no cash, this equals 1.0.</span>
</span><span id="State-414"><a href="#State-414"><span class="linenos">414</span></a><span class="sd">        For a portfolio with shorts or leverage, this will be greater than 1.0.</span>
</span><span id="State-415"><a href="#State-415"><span class="linenos">415</span></a>
</span><span id="State-416"><a href="#State-416"><span class="linenos">416</span></a><span class="sd">        Returns</span>
</span><span id="State-417"><a href="#State-417"><span class="linenos">417</span></a><span class="sd">        -------</span>
</span><span id="State-418"><a href="#State-418"><span class="linenos">418</span></a><span class="sd">        float</span>
</span><span id="State-419"><a href="#State-419"><span class="linenos">419</span></a><span class="sd">            The leverage ratio of the portfolio</span>
</span><span id="State-420"><a href="#State-420"><span class="linenos">420</span></a>
</span><span id="State-421"><a href="#State-421"><span class="linenos">421</span></a><span class="sd">        Notes</span>
</span><span id="State-422"><a href="#State-422"><span class="linenos">422</span></a><span class="sd">        -----</span>
</span><span id="State-423"><a href="#State-423"><span class="linenos">423</span></a><span class="sd">        A leverage of 2.0 means the portfolio has twice the market exposure</span>
</span><span id="State-424"><a href="#State-424"><span class="linenos">424</span></a><span class="sd">        compared to its net asset value, which could be achieved through</span>
</span><span id="State-425"><a href="#State-425"><span class="linenos">425</span></a><span class="sd">        borrowing or short selling.</span>
</span><span id="State-426"><a href="#State-426"><span class="linenos">426</span></a>
</span><span id="State-427"><a href="#State-427"><span class="linenos">427</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="State-428"><a href="#State-428"><span class="linenos">428</span></a>        <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">weights</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
</span></pre></div>


            <div class="docstring"><p>Represents the current state of a portfolio during simulation.</p>

<p>The State class tracks the current positions, prices, cash, and other metrics
of a portfolio at a specific point in time. It is updated within a loop by the
Builder class during the simulation process.</p>

<p>The class provides properties for accessing various portfolio metrics like
cash, NAV, value, weights, and leverage. It also provides setter methods
for updating the portfolio state (aum, cash, position, prices).</p>

<h2 id="attributes">Attributes</h2>

<p>_prices : pd.Series
    Current prices of assets in the portfolio
_position : pd.Series
    Current positions (units) of assets in the portfolio
_trades : pd.Series
    Trades needed to reach the current position
_time : datetime
    Current time in the simulation
_days : int
    Number of days between the current and previous time
_profit : float
    Profit achieved between the previous and current prices
_aum : float
    Current assets under management (AUM) of the portfolio</p>
</div>


                            <div id="State.__init__" class="classattr">
                                <div class="attr function">
            
        <span class="name">State</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">_prices</span><span class="p">:</span> <span class="n">pandas</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">series</span><span class="o">.</span><span class="n">Series</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">_position</span><span class="p">:</span> <span class="n">pandas</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">series</span><span class="o">.</span><span class="n">Series</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">_trades</span><span class="p">:</span> <span class="n">pandas</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">series</span><span class="o">.</span><span class="n">Series</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">_time</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">_days</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>,</span><span class="param">	<span class="n">_profit</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>,</span><span class="param">	<span class="n">_aum</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span></span>)</span>

        
    </div>
    <a class="headerlink" href="#State.__init__"></a>
    
    

                            </div>
                            <div id="State.cash" class="classattr">
                                        <input id="State.cash-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">cash</span><span class="annotation">: float</span>

                <label class="view-source-button" for="State.cash-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#State.cash"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="State.cash-68"><a href="#State.cash-68"><span class="linenos">68</span></a>    <span class="nd">@property</span>
</span><span id="State.cash-69"><a href="#State.cash-69"><span class="linenos">69</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">cash</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="State.cash-70"><a href="#State.cash-70"><span class="linenos">70</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the current amount of cash available in the portfolio.</span>
</span><span id="State.cash-71"><a href="#State.cash-71"><span class="linenos">71</span></a>
</span><span id="State.cash-72"><a href="#State.cash-72"><span class="linenos">72</span></a><span class="sd">        Returns</span>
</span><span id="State.cash-73"><a href="#State.cash-73"><span class="linenos">73</span></a><span class="sd">        -------</span>
</span><span id="State.cash-74"><a href="#State.cash-74"><span class="linenos">74</span></a><span class="sd">        float</span>
</span><span id="State.cash-75"><a href="#State.cash-75"><span class="linenos">75</span></a><span class="sd">            The cash component of the portfolio, calculated as NAV minus</span>
</span><span id="State.cash-76"><a href="#State.cash-76"><span class="linenos">76</span></a><span class="sd">            the value of all positions</span>
</span><span id="State.cash-77"><a href="#State.cash-77"><span class="linenos">77</span></a>
</span><span id="State.cash-78"><a href="#State.cash-78"><span class="linenos">78</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="State.cash-79"><a href="#State.cash-79"><span class="linenos">79</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">nav</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span>
</span></pre></div>


            <div class="docstring"><p>Get the current amount of cash available in the portfolio.</p>

<h2 id="returns">Returns</h2>

<p>float
    The cash component of the portfolio, calculated as NAV minus
    the value of all positions</p>
</div>


                            </div>
                            <div id="State.nav" class="classattr">
                                        <input id="State.nav-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">nav</span><span class="annotation">: float</span>

                <label class="view-source-button" for="State.nav-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#State.nav"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="State.nav-96"><a href="#State.nav-96"><span class="linenos"> 96</span></a>    <span class="nd">@property</span>
</span><span id="State.nav-97"><a href="#State.nav-97"><span class="linenos"> 97</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">nav</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="State.nav-98"><a href="#State.nav-98"><span class="linenos"> 98</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the net asset value (NAV) of the portfolio.</span>
</span><span id="State.nav-99"><a href="#State.nav-99"><span class="linenos"> 99</span></a>
</span><span id="State.nav-100"><a href="#State.nav-100"><span class="linenos">100</span></a><span class="sd">        The NAV represents the total value of the portfolio, including</span>
</span><span id="State.nav-101"><a href="#State.nav-101"><span class="linenos">101</span></a><span class="sd">        both the value of positions and available cash.</span>
</span><span id="State.nav-102"><a href="#State.nav-102"><span class="linenos">102</span></a>
</span><span id="State.nav-103"><a href="#State.nav-103"><span class="linenos">103</span></a><span class="sd">        Returns</span>
</span><span id="State.nav-104"><a href="#State.nav-104"><span class="linenos">104</span></a><span class="sd">        -------</span>
</span><span id="State.nav-105"><a href="#State.nav-105"><span class="linenos">105</span></a><span class="sd">        float</span>
</span><span id="State.nav-106"><a href="#State.nav-106"><span class="linenos">106</span></a><span class="sd">            The net asset value of the portfolio</span>
</span><span id="State.nav-107"><a href="#State.nav-107"><span class="linenos">107</span></a>
</span><span id="State.nav-108"><a href="#State.nav-108"><span class="linenos">108</span></a><span class="sd">        Notes</span>
</span><span id="State.nav-109"><a href="#State.nav-109"><span class="linenos">109</span></a><span class="sd">        -----</span>
</span><span id="State.nav-110"><a href="#State.nav-110"><span class="linenos">110</span></a><span class="sd">        This is equivalent to the AUM (assets under management).</span>
</span><span id="State.nav-111"><a href="#State.nav-111"><span class="linenos">111</span></a>
</span><span id="State.nav-112"><a href="#State.nav-112"><span class="linenos">112</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="State.nav-113"><a href="#State.nav-113"><span class="linenos">113</span></a>        <span class="c1"># assert np.isclose(self.value + self.cash, self.aum), f&quot;{self.value + self.cash} != {self.aum}&quot;</span>
</span><span id="State.nav-114"><a href="#State.nav-114"><span class="linenos">114</span></a>        <span class="c1"># return self.value + self.cash</span>
</span><span id="State.nav-115"><a href="#State.nav-115"><span class="linenos">115</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">aum</span>
</span></pre></div>


            <div class="docstring"><p>Get the net asset value (NAV) of the portfolio.</p>

<p>The NAV represents the total value of the portfolio, including
both the value of positions and available cash.</p>

<h2 id="returns">Returns</h2>

<p>float
    The net asset value of the portfolio</p>

<h2 id="notes">Notes</h2>

<p>This is equivalent to the AUM (assets under management).</p>
</div>


                            </div>
                            <div id="State.value" class="classattr">
                                        <input id="State.value-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">value</span><span class="annotation">: float</span>

                <label class="view-source-button" for="State.value-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#State.value"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="State.value-117"><a href="#State.value-117"><span class="linenos">117</span></a>    <span class="nd">@property</span>
</span><span id="State.value-118"><a href="#State.value-118"><span class="linenos">118</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">value</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="State.value-119"><a href="#State.value-119"><span class="linenos">119</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the value of all positions in the portfolio.</span>
</span><span id="State.value-120"><a href="#State.value-120"><span class="linenos">120</span></a>
</span><span id="State.value-121"><a href="#State.value-121"><span class="linenos">121</span></a><span class="sd">        This computes the total value of all holdings at current prices,</span>
</span><span id="State.value-122"><a href="#State.value-122"><span class="linenos">122</span></a><span class="sd">        not including cash.</span>
</span><span id="State.value-123"><a href="#State.value-123"><span class="linenos">123</span></a>
</span><span id="State.value-124"><a href="#State.value-124"><span class="linenos">124</span></a><span class="sd">        Returns</span>
</span><span id="State.value-125"><a href="#State.value-125"><span class="linenos">125</span></a><span class="sd">        -------</span>
</span><span id="State.value-126"><a href="#State.value-126"><span class="linenos">126</span></a><span class="sd">        float</span>
</span><span id="State.value-127"><a href="#State.value-127"><span class="linenos">127</span></a><span class="sd">            The sum of values of all positions</span>
</span><span id="State.value-128"><a href="#State.value-128"><span class="linenos">128</span></a>
</span><span id="State.value-129"><a href="#State.value-129"><span class="linenos">129</span></a><span class="sd">        Notes</span>
</span><span id="State.value-130"><a href="#State.value-130"><span class="linenos">130</span></a><span class="sd">        -----</span>
</span><span id="State.value-131"><a href="#State.value-131"><span class="linenos">131</span></a><span class="sd">        If positions are missing (None), the sum will effectively be zero.</span>
</span><span id="State.value-132"><a href="#State.value-132"><span class="linenos">132</span></a>
</span><span id="State.value-133"><a href="#State.value-133"><span class="linenos">133</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="State.value-134"><a href="#State.value-134"><span class="linenos">134</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">cashposition</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>Get the value of all positions in the portfolio.</p>

<p>This computes the total value of all holdings at current prices,
not including cash.</p>

<h2 id="returns">Returns</h2>

<p>float
    The sum of values of all positions</p>

<h2 id="notes">Notes</h2>

<p>If positions are missing (None), the sum will effectively be zero.</p>
</div>


                            </div>
                            <div id="State.cashposition" class="classattr">
                                        <input id="State.cashposition-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">cashposition</span><span class="annotation">: pandas.core.series.Series</span>

                <label class="view-source-button" for="State.cashposition-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#State.cashposition"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="State.cashposition-136"><a href="#State.cashposition-136"><span class="linenos">136</span></a>    <span class="nd">@property</span>
</span><span id="State.cashposition-137"><a href="#State.cashposition-137"><span class="linenos">137</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">cashposition</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">:</span>
</span><span id="State.cashposition-138"><a href="#State.cashposition-138"><span class="linenos">138</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the cash value of each position in the portfolio.</span>
</span><span id="State.cashposition-139"><a href="#State.cashposition-139"><span class="linenos">139</span></a>
</span><span id="State.cashposition-140"><a href="#State.cashposition-140"><span class="linenos">140</span></a><span class="sd">        This computes the cash value of each position by multiplying</span>
</span><span id="State.cashposition-141"><a href="#State.cashposition-141"><span class="linenos">141</span></a><span class="sd">        the number of units by the current price for each asset.</span>
</span><span id="State.cashposition-142"><a href="#State.cashposition-142"><span class="linenos">142</span></a>
</span><span id="State.cashposition-143"><a href="#State.cashposition-143"><span class="linenos">143</span></a><span class="sd">        Returns</span>
</span><span id="State.cashposition-144"><a href="#State.cashposition-144"><span class="linenos">144</span></a><span class="sd">        -------</span>
</span><span id="State.cashposition-145"><a href="#State.cashposition-145"><span class="linenos">145</span></a><span class="sd">        pd.Series</span>
</span><span id="State.cashposition-146"><a href="#State.cashposition-146"><span class="linenos">146</span></a><span class="sd">            Series with the cash value of each position, indexed by asset</span>
</span><span id="State.cashposition-147"><a href="#State.cashposition-147"><span class="linenos">147</span></a>
</span><span id="State.cashposition-148"><a href="#State.cashposition-148"><span class="linenos">148</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="State.cashposition-149"><a href="#State.cashposition-149"><span class="linenos">149</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">prices</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">position</span>
</span></pre></div>


            <div class="docstring"><p>Get the cash value of each position in the portfolio.</p>

<p>This computes the cash value of each position by multiplying
the number of units by the current price for each asset.</p>

<h2 id="returns">Returns</h2>

<p>pd.Series
    Series with the cash value of each position, indexed by asset</p>
</div>


                            </div>
                            <div id="State.position" class="classattr">
                                        <input id="State.position-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">position</span><span class="annotation">: pandas.core.series.Series</span>

                <label class="view-source-button" for="State.position-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#State.position"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="State.position-151"><a href="#State.position-151"><span class="linenos">151</span></a>    <span class="nd">@property</span>
</span><span id="State.position-152"><a href="#State.position-152"><span class="linenos">152</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">position</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">:</span>
</span><span id="State.position-153"><a href="#State.position-153"><span class="linenos">153</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the current position (number of units) for each asset.</span>
</span><span id="State.position-154"><a href="#State.position-154"><span class="linenos">154</span></a>
</span><span id="State.position-155"><a href="#State.position-155"><span class="linenos">155</span></a><span class="sd">        Returns</span>
</span><span id="State.position-156"><a href="#State.position-156"><span class="linenos">156</span></a><span class="sd">        -------</span>
</span><span id="State.position-157"><a href="#State.position-157"><span class="linenos">157</span></a><span class="sd">        pd.Series</span>
</span><span id="State.position-158"><a href="#State.position-158"><span class="linenos">158</span></a><span class="sd">            Series with the number of units held for each asset, indexed by asset.</span>
</span><span id="State.position-159"><a href="#State.position-159"><span class="linenos">159</span></a><span class="sd">            If the position is not yet set, returns an empty series with the</span>
</span><span id="State.position-160"><a href="#State.position-160"><span class="linenos">160</span></a><span class="sd">            correct index.</span>
</span><span id="State.position-161"><a href="#State.position-161"><span class="linenos">161</span></a>
</span><span id="State.position-162"><a href="#State.position-162"><span class="linenos">162</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="State.position-163"><a href="#State.position-163"><span class="linenos">163</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_position</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="State.position-164"><a href="#State.position-164"><span class="linenos">164</span></a>            <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">assets</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
</span><span id="State.position-165"><a href="#State.position-165"><span class="linenos">165</span></a>
</span><span id="State.position-166"><a href="#State.position-166"><span class="linenos">166</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_position</span>
</span></pre></div>


            <div class="docstring"><p>Get the current position (number of units) for each asset.</p>

<h2 id="returns">Returns</h2>

<p>pd.Series
    Series with the number of units held for each asset, indexed by asset.
    If the position is not yet set, returns an empty series with the
    correct index.</p>
</div>


                            </div>
                            <div id="State.gmv" class="classattr">
                                        <input id="State.gmv-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">gmv</span><span class="annotation">: float</span>

                <label class="view-source-button" for="State.gmv-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#State.gmv"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="State.gmv-192"><a href="#State.gmv-192"><span class="linenos">192</span></a>    <span class="nd">@property</span>
</span><span id="State.gmv-193"><a href="#State.gmv-193"><span class="linenos">193</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">gmv</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="State.gmv-194"><a href="#State.gmv-194"><span class="linenos">194</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the gross market value of the portfolio.</span>
</span><span id="State.gmv-195"><a href="#State.gmv-195"><span class="linenos">195</span></a>
</span><span id="State.gmv-196"><a href="#State.gmv-196"><span class="linenos">196</span></a><span class="sd">        The gross market value is the sum of the absolute values of all positions,</span>
</span><span id="State.gmv-197"><a href="#State.gmv-197"><span class="linenos">197</span></a><span class="sd">        which represents the total market exposure including both long and short positions.</span>
</span><span id="State.gmv-198"><a href="#State.gmv-198"><span class="linenos">198</span></a>
</span><span id="State.gmv-199"><a href="#State.gmv-199"><span class="linenos">199</span></a><span class="sd">        Returns</span>
</span><span id="State.gmv-200"><a href="#State.gmv-200"><span class="linenos">200</span></a><span class="sd">        -------</span>
</span><span id="State.gmv-201"><a href="#State.gmv-201"><span class="linenos">201</span></a><span class="sd">        float</span>
</span><span id="State.gmv-202"><a href="#State.gmv-202"><span class="linenos">202</span></a><span class="sd">            The gross market value (abs(short) + long)</span>
</span><span id="State.gmv-203"><a href="#State.gmv-203"><span class="linenos">203</span></a>
</span><span id="State.gmv-204"><a href="#State.gmv-204"><span class="linenos">204</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="State.gmv-205"><a href="#State.gmv-205"><span class="linenos">205</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">cashposition</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>Get the gross market value of the portfolio.</p>

<p>The gross market value is the sum of the absolute values of all positions,
which represents the total market exposure including both long and short positions.</p>

<h2 id="returns">Returns</h2>

<p>float
    The gross market value (abs(short) + long)</p>
</div>


                            </div>
                            <div id="State.time" class="classattr">
                                        <input id="State.time-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">time</span><span class="annotation">: datetime.datetime | None</span>

                <label class="view-source-button" for="State.time-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#State.time"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="State.time-207"><a href="#State.time-207"><span class="linenos">207</span></a>    <span class="nd">@property</span>
</span><span id="State.time-208"><a href="#State.time-208"><span class="linenos">208</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">time</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">datetime</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="State.time-209"><a href="#State.time-209"><span class="linenos">209</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the current time of the portfolio state.</span>
</span><span id="State.time-210"><a href="#State.time-210"><span class="linenos">210</span></a>
</span><span id="State.time-211"><a href="#State.time-211"><span class="linenos">211</span></a><span class="sd">        Returns</span>
</span><span id="State.time-212"><a href="#State.time-212"><span class="linenos">212</span></a><span class="sd">        -------</span>
</span><span id="State.time-213"><a href="#State.time-213"><span class="linenos">213</span></a><span class="sd">        Optional[datetime]</span>
</span><span id="State.time-214"><a href="#State.time-214"><span class="linenos">214</span></a><span class="sd">            The current time in the simulation, or None if not set</span>
</span><span id="State.time-215"><a href="#State.time-215"><span class="linenos">215</span></a>
</span><span id="State.time-216"><a href="#State.time-216"><span class="linenos">216</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="State.time-217"><a href="#State.time-217"><span class="linenos">217</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_time</span>
</span></pre></div>


            <div class="docstring"><p>Get the current time of the portfolio state.</p>

<h2 id="returns">Returns</h2>

<p>Optional[datetime]
    The current time in the simulation, or None if not set</p>
</div>


                            </div>
                            <div id="State.days" class="classattr">
                                        <input id="State.days-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">days</span><span class="annotation">: int</span>

                <label class="view-source-button" for="State.days-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#State.days"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="State.days-239"><a href="#State.days-239"><span class="linenos">239</span></a>    <span class="nd">@property</span>
</span><span id="State.days-240"><a href="#State.days-240"><span class="linenos">240</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">days</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span><span id="State.days-241"><a href="#State.days-241"><span class="linenos">241</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the number of days between the current and previous time.</span>
</span><span id="State.days-242"><a href="#State.days-242"><span class="linenos">242</span></a>
</span><span id="State.days-243"><a href="#State.days-243"><span class="linenos">243</span></a><span class="sd">        Returns</span>
</span><span id="State.days-244"><a href="#State.days-244"><span class="linenos">244</span></a><span class="sd">        -------</span>
</span><span id="State.days-245"><a href="#State.days-245"><span class="linenos">245</span></a><span class="sd">        int</span>
</span><span id="State.days-246"><a href="#State.days-246"><span class="linenos">246</span></a><span class="sd">            Number of days between the current and previous time</span>
</span><span id="State.days-247"><a href="#State.days-247"><span class="linenos">247</span></a>
</span><span id="State.days-248"><a href="#State.days-248"><span class="linenos">248</span></a><span class="sd">        Notes</span>
</span><span id="State.days-249"><a href="#State.days-249"><span class="linenos">249</span></a><span class="sd">        -----</span>
</span><span id="State.days-250"><a href="#State.days-250"><span class="linenos">250</span></a><span class="sd">        This is useful for computing interest when holding cash or for</span>
</span><span id="State.days-251"><a href="#State.days-251"><span class="linenos">251</span></a><span class="sd">        time-dependent calculations.</span>
</span><span id="State.days-252"><a href="#State.days-252"><span class="linenos">252</span></a>
</span><span id="State.days-253"><a href="#State.days-253"><span class="linenos">253</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="State.days-254"><a href="#State.days-254"><span class="linenos">254</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_days</span>
</span></pre></div>


            <div class="docstring"><p>Get the number of days between the current and previous time.</p>

<h2 id="returns">Returns</h2>

<p>int
    Number of days between the current and previous time</p>

<h2 id="notes">Notes</h2>

<p>This is useful for computing interest when holding cash or for
time-dependent calculations.</p>
</div>


                            </div>
                            <div id="State.assets" class="classattr">
                                        <input id="State.assets-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">assets</span><span class="annotation">: pandas.core.indexes.base.Index</span>

                <label class="view-source-button" for="State.assets-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#State.assets"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="State.assets-256"><a href="#State.assets-256"><span class="linenos">256</span></a>    <span class="nd">@property</span>
</span><span id="State.assets-257"><a href="#State.assets-257"><span class="linenos">257</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">assets</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">Index</span><span class="p">:</span>
</span><span id="State.assets-258"><a href="#State.assets-258"><span class="linenos">258</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the assets currently in the portfolio.</span>
</span><span id="State.assets-259"><a href="#State.assets-259"><span class="linenos">259</span></a>
</span><span id="State.assets-260"><a href="#State.assets-260"><span class="linenos">260</span></a><span class="sd">        Returns</span>
</span><span id="State.assets-261"><a href="#State.assets-261"><span class="linenos">261</span></a><span class="sd">        -------</span>
</span><span id="State.assets-262"><a href="#State.assets-262"><span class="linenos">262</span></a><span class="sd">        pd.Index</span>
</span><span id="State.assets-263"><a href="#State.assets-263"><span class="linenos">263</span></a><span class="sd">            Index of assets with valid prices in the portfolio.</span>
</span><span id="State.assets-264"><a href="#State.assets-264"><span class="linenos">264</span></a><span class="sd">            If no prices are set, returns an empty index.</span>
</span><span id="State.assets-265"><a href="#State.assets-265"><span class="linenos">265</span></a>
</span><span id="State.assets-266"><a href="#State.assets-266"><span class="linenos">266</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="State.assets-267"><a href="#State.assets-267"><span class="linenos">267</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prices</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="State.assets-268"><a href="#State.assets-268"><span class="linenos">268</span></a>            <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">Index</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="p">[],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">str</span><span class="p">)</span>
</span><span id="State.assets-269"><a href="#State.assets-269"><span class="linenos">269</span></a>
</span><span id="State.assets-270"><a href="#State.assets-270"><span class="linenos">270</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">prices</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">index</span>
</span></pre></div>


            <div class="docstring"><p>Get the assets currently in the portfolio.</p>

<h2 id="returns">Returns</h2>

<p>pd.Index
    Index of assets with valid prices in the portfolio.
    If no prices are set, returns an empty index.</p>
</div>


                            </div>
                            <div id="State.trades" class="classattr">
                                        <input id="State.trades-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">trades</span><span class="annotation">: pandas.core.series.Series | None</span>

                <label class="view-source-button" for="State.trades-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#State.trades"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="State.trades-272"><a href="#State.trades-272"><span class="linenos">272</span></a>    <span class="nd">@property</span>
</span><span id="State.trades-273"><a href="#State.trades-273"><span class="linenos">273</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">trades</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="State.trades-274"><a href="#State.trades-274"><span class="linenos">274</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the trades needed to reach the current position.</span>
</span><span id="State.trades-275"><a href="#State.trades-275"><span class="linenos">275</span></a>
</span><span id="State.trades-276"><a href="#State.trades-276"><span class="linenos">276</span></a><span class="sd">        Returns</span>
</span><span id="State.trades-277"><a href="#State.trades-277"><span class="linenos">277</span></a><span class="sd">        -------</span>
</span><span id="State.trades-278"><a href="#State.trades-278"><span class="linenos">278</span></a><span class="sd">        Optional[pd.Series]</span>
</span><span id="State.trades-279"><a href="#State.trades-279"><span class="linenos">279</span></a><span class="sd">            Series of trades (changes in position) needed to reach the current position.</span>
</span><span id="State.trades-280"><a href="#State.trades-280"><span class="linenos">280</span></a><span class="sd">            None if no trades have been calculated yet.</span>
</span><span id="State.trades-281"><a href="#State.trades-281"><span class="linenos">281</span></a>
</span><span id="State.trades-282"><a href="#State.trades-282"><span class="linenos">282</span></a><span class="sd">        Notes</span>
</span><span id="State.trades-283"><a href="#State.trades-283"><span class="linenos">283</span></a><span class="sd">        -----</span>
</span><span id="State.trades-284"><a href="#State.trades-284"><span class="linenos">284</span></a><span class="sd">        This is helpful when computing trading costs following a position change.</span>
</span><span id="State.trades-285"><a href="#State.trades-285"><span class="linenos">285</span></a><span class="sd">        Positive values represent buys, negative values represent sells.</span>
</span><span id="State.trades-286"><a href="#State.trades-286"><span class="linenos">286</span></a>
</span><span id="State.trades-287"><a href="#State.trades-287"><span class="linenos">287</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="State.trades-288"><a href="#State.trades-288"><span class="linenos">288</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_trades</span>
</span></pre></div>


            <div class="docstring"><p>Get the trades needed to reach the current position.</p>

<h2 id="returns">Returns</h2>

<p>Optional[pd.Series]
    Series of trades (changes in position) needed to reach the current position.
    None if no trades have been calculated yet.</p>

<h2 id="notes">Notes</h2>

<p>This is helpful when computing trading costs following a position change.
Positive values represent buys, negative values represent sells.</p>
</div>


                            </div>
                            <div id="State.mask" class="classattr">
                                        <input id="State.mask-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">mask</span><span class="annotation">: numpy.ndarray</span>

                <label class="view-source-button" for="State.mask-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#State.mask"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="State.mask-290"><a href="#State.mask-290"><span class="linenos">290</span></a>    <span class="nd">@property</span>
</span><span id="State.mask-291"><a href="#State.mask-291"><span class="linenos">291</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">mask</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
</span><span id="State.mask-292"><a href="#State.mask-292"><span class="linenos">292</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get a boolean mask for assets with valid (non-NaN) prices.</span>
</span><span id="State.mask-293"><a href="#State.mask-293"><span class="linenos">293</span></a>
</span><span id="State.mask-294"><a href="#State.mask-294"><span class="linenos">294</span></a><span class="sd">        Returns</span>
</span><span id="State.mask-295"><a href="#State.mask-295"><span class="linenos">295</span></a><span class="sd">        -------</span>
</span><span id="State.mask-296"><a href="#State.mask-296"><span class="linenos">296</span></a><span class="sd">        np.ndarray</span>
</span><span id="State.mask-297"><a href="#State.mask-297"><span class="linenos">297</span></a><span class="sd">            Boolean array where True indicates a valid price and False indicates</span>
</span><span id="State.mask-298"><a href="#State.mask-298"><span class="linenos">298</span></a><span class="sd">            a missing (NaN) price. Returns an empty array if no prices are set.</span>
</span><span id="State.mask-299"><a href="#State.mask-299"><span class="linenos">299</span></a>
</span><span id="State.mask-300"><a href="#State.mask-300"><span class="linenos">300</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="State.mask-301"><a href="#State.mask-301"><span class="linenos">301</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prices</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="State.mask-302"><a href="#State.mask-302"><span class="linenos">302</span></a>            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">bool</span><span class="p">)</span>
</span><span id="State.mask-303"><a href="#State.mask-303"><span class="linenos">303</span></a>
</span><span id="State.mask-304"><a href="#State.mask-304"><span class="linenos">304</span></a>        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">isfinite</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">prices</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Get a boolean mask for assets with valid (non-NaN) prices.</p>

<h2 id="returns">Returns</h2>

<p>np.ndarray
    Boolean array where True indicates a valid price and False indicates
    a missing (NaN) price. Returns an empty array if no prices are set.</p>
</div>


                            </div>
                            <div id="State.prices" class="classattr">
                                        <input id="State.prices-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">prices</span><span class="annotation">: pandas.core.series.Series</span>

                <label class="view-source-button" for="State.prices-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#State.prices"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="State.prices-306"><a href="#State.prices-306"><span class="linenos">306</span></a>    <span class="nd">@property</span>
</span><span id="State.prices-307"><a href="#State.prices-307"><span class="linenos">307</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">prices</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">:</span>
</span><span id="State.prices-308"><a href="#State.prices-308"><span class="linenos">308</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the current prices of assets in the portfolio.</span>
</span><span id="State.prices-309"><a href="#State.prices-309"><span class="linenos">309</span></a>
</span><span id="State.prices-310"><a href="#State.prices-310"><span class="linenos">310</span></a><span class="sd">        Returns</span>
</span><span id="State.prices-311"><a href="#State.prices-311"><span class="linenos">311</span></a><span class="sd">        -------</span>
</span><span id="State.prices-312"><a href="#State.prices-312"><span class="linenos">312</span></a><span class="sd">        pd.Series</span>
</span><span id="State.prices-313"><a href="#State.prices-313"><span class="linenos">313</span></a><span class="sd">            Series of current prices indexed by asset.</span>
</span><span id="State.prices-314"><a href="#State.prices-314"><span class="linenos">314</span></a><span class="sd">            Returns an empty series if no prices are set.</span>
</span><span id="State.prices-315"><a href="#State.prices-315"><span class="linenos">315</span></a>
</span><span id="State.prices-316"><a href="#State.prices-316"><span class="linenos">316</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="State.prices-317"><a href="#State.prices-317"><span class="linenos">317</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prices</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="State.prices-318"><a href="#State.prices-318"><span class="linenos">318</span></a>            <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
</span><span id="State.prices-319"><a href="#State.prices-319"><span class="linenos">319</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prices</span>
</span></pre></div>


            <div class="docstring"><p>Get the current prices of assets in the portfolio.</p>

<h2 id="returns">Returns</h2>

<p>pd.Series
    Series of current prices indexed by asset.
    Returns an empty series if no prices are set.</p>
</div>


                            </div>
                            <div id="State.profit" class="classattr">
                                        <input id="State.profit-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">profit</span><span class="annotation">: float</span>

                <label class="view-source-button" for="State.profit-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#State.profit"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="State.profit-347"><a href="#State.profit-347"><span class="linenos">347</span></a>    <span class="nd">@property</span>
</span><span id="State.profit-348"><a href="#State.profit-348"><span class="linenos">348</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">profit</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="State.profit-349"><a href="#State.profit-349"><span class="linenos">349</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the profit achieved between the previous and current prices.</span>
</span><span id="State.profit-350"><a href="#State.profit-350"><span class="linenos">350</span></a>
</span><span id="State.profit-351"><a href="#State.profit-351"><span class="linenos">351</span></a><span class="sd">        Returns</span>
</span><span id="State.profit-352"><a href="#State.profit-352"><span class="linenos">352</span></a><span class="sd">        -------</span>
</span><span id="State.profit-353"><a href="#State.profit-353"><span class="linenos">353</span></a><span class="sd">        float</span>
</span><span id="State.profit-354"><a href="#State.profit-354"><span class="linenos">354</span></a><span class="sd">            The profit (or loss) achieved due to price changes since the</span>
</span><span id="State.profit-355"><a href="#State.profit-355"><span class="linenos">355</span></a><span class="sd">            last price update</span>
</span><span id="State.profit-356"><a href="#State.profit-356"><span class="linenos">356</span></a>
</span><span id="State.profit-357"><a href="#State.profit-357"><span class="linenos">357</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="State.profit-358"><a href="#State.profit-358"><span class="linenos">358</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_profit</span>
</span></pre></div>


            <div class="docstring"><p>Get the profit achieved between the previous and current prices.</p>

<h2 id="returns">Returns</h2>

<p>float
    The profit (or loss) achieved due to price changes since the
    last price update</p>
</div>


                            </div>
                            <div id="State.aum" class="classattr">
                                        <input id="State.aum-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">aum</span><span class="annotation">: float</span>

                <label class="view-source-button" for="State.aum-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#State.aum"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="State.aum-360"><a href="#State.aum-360"><span class="linenos">360</span></a>    <span class="nd">@property</span>
</span><span id="State.aum-361"><a href="#State.aum-361"><span class="linenos">361</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">aum</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="State.aum-362"><a href="#State.aum-362"><span class="linenos">362</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the current assets under management (AUM) of the portfolio.</span>
</span><span id="State.aum-363"><a href="#State.aum-363"><span class="linenos">363</span></a>
</span><span id="State.aum-364"><a href="#State.aum-364"><span class="linenos">364</span></a><span class="sd">        Returns</span>
</span><span id="State.aum-365"><a href="#State.aum-365"><span class="linenos">365</span></a><span class="sd">        -------</span>
</span><span id="State.aum-366"><a href="#State.aum-366"><span class="linenos">366</span></a><span class="sd">        float</span>
</span><span id="State.aum-367"><a href="#State.aum-367"><span class="linenos">367</span></a><span class="sd">            The total assets under management</span>
</span><span id="State.aum-368"><a href="#State.aum-368"><span class="linenos">368</span></a>
</span><span id="State.aum-369"><a href="#State.aum-369"><span class="linenos">369</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="State.aum-370"><a href="#State.aum-370"><span class="linenos">370</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_aum</span>
</span></pre></div>


            <div class="docstring"><p>Get the current assets under management (AUM) of the portfolio.</p>

<h2 id="returns">Returns</h2>

<p>float
    The total assets under management</p>
</div>


                            </div>
                            <div id="State.weights" class="classattr">
                                        <input id="State.weights-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">weights</span><span class="annotation">: pandas.core.series.Series</span>

                <label class="view-source-button" for="State.weights-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#State.weights"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="State.weights-384"><a href="#State.weights-384"><span class="linenos">384</span></a>    <span class="nd">@property</span>
</span><span id="State.weights-385"><a href="#State.weights-385"><span class="linenos">385</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">weights</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">:</span>
</span><span id="State.weights-386"><a href="#State.weights-386"><span class="linenos">386</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the weight of each asset in the portfolio.</span>
</span><span id="State.weights-387"><a href="#State.weights-387"><span class="linenos">387</span></a>
</span><span id="State.weights-388"><a href="#State.weights-388"><span class="linenos">388</span></a><span class="sd">        This computes the weighting of each asset as a fraction of the</span>
</span><span id="State.weights-389"><a href="#State.weights-389"><span class="linenos">389</span></a><span class="sd">        total portfolio value (NAV).</span>
</span><span id="State.weights-390"><a href="#State.weights-390"><span class="linenos">390</span></a>
</span><span id="State.weights-391"><a href="#State.weights-391"><span class="linenos">391</span></a><span class="sd">        Returns</span>
</span><span id="State.weights-392"><a href="#State.weights-392"><span class="linenos">392</span></a><span class="sd">        -------</span>
</span><span id="State.weights-393"><a href="#State.weights-393"><span class="linenos">393</span></a><span class="sd">        pd.Series</span>
</span><span id="State.weights-394"><a href="#State.weights-394"><span class="linenos">394</span></a><span class="sd">            Series containing the weight of each asset as a fraction of the</span>
</span><span id="State.weights-395"><a href="#State.weights-395"><span class="linenos">395</span></a><span class="sd">            total portfolio value, indexed by asset</span>
</span><span id="State.weights-396"><a href="#State.weights-396"><span class="linenos">396</span></a>
</span><span id="State.weights-397"><a href="#State.weights-397"><span class="linenos">397</span></a><span class="sd">        Notes</span>
</span><span id="State.weights-398"><a href="#State.weights-398"><span class="linenos">398</span></a><span class="sd">        -----</span>
</span><span id="State.weights-399"><a href="#State.weights-399"><span class="linenos">399</span></a><span class="sd">        If positions are missing, a series of zeros is effectively returned.</span>
</span><span id="State.weights-400"><a href="#State.weights-400"><span class="linenos">400</span></a><span class="sd">        The sum of weights equals 1.0 for a fully invested portfolio with no leverage.</span>
</span><span id="State.weights-401"><a href="#State.weights-401"><span class="linenos">401</span></a>
</span><span id="State.weights-402"><a href="#State.weights-402"><span class="linenos">402</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="State.weights-403"><a href="#State.weights-403"><span class="linenos">403</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nav</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">aum</span><span class="p">):</span>
</span><span id="State.weights-404"><a href="#State.weights-404"><span class="linenos">404</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">nav</span><span class="si">}</span><span class="s2"> != </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">aum</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="State.weights-405"><a href="#State.weights-405"><span class="linenos">405</span></a>
</span><span id="State.weights-406"><a href="#State.weights-406"><span class="linenos">406</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">cashposition</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">nav</span>
</span></pre></div>


            <div class="docstring"><p>Get the weight of each asset in the portfolio.</p>

<p>This computes the weighting of each asset as a fraction of the
total portfolio value (NAV).</p>

<h2 id="returns">Returns</h2>

<p>pd.Series
    Series containing the weight of each asset as a fraction of the
    total portfolio value, indexed by asset</p>

<h2 id="notes">Notes</h2>

<p>If positions are missing, a series of zeros is effectively returned.
The sum of weights equals 1.0 for a fully invested portfolio with no leverage.</p>
</div>


                            </div>
                            <div id="State.leverage" class="classattr">
                                        <input id="State.leverage-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">leverage</span><span class="annotation">: float</span>

                <label class="view-source-button" for="State.leverage-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#State.leverage"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="State.leverage-408"><a href="#State.leverage-408"><span class="linenos">408</span></a>    <span class="nd">@property</span>
</span><span id="State.leverage-409"><a href="#State.leverage-409"><span class="linenos">409</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">leverage</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="State.leverage-410"><a href="#State.leverage-410"><span class="linenos">410</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the leverage of the portfolio.</span>
</span><span id="State.leverage-411"><a href="#State.leverage-411"><span class="linenos">411</span></a>
</span><span id="State.leverage-412"><a href="#State.leverage-412"><span class="linenos">412</span></a><span class="sd">        Leverage is calculated as the sum of the absolute values of all position</span>
</span><span id="State.leverage-413"><a href="#State.leverage-413"><span class="linenos">413</span></a><span class="sd">        weights. For a long-only portfolio with no cash, this equals 1.0.</span>
</span><span id="State.leverage-414"><a href="#State.leverage-414"><span class="linenos">414</span></a><span class="sd">        For a portfolio with shorts or leverage, this will be greater than 1.0.</span>
</span><span id="State.leverage-415"><a href="#State.leverage-415"><span class="linenos">415</span></a>
</span><span id="State.leverage-416"><a href="#State.leverage-416"><span class="linenos">416</span></a><span class="sd">        Returns</span>
</span><span id="State.leverage-417"><a href="#State.leverage-417"><span class="linenos">417</span></a><span class="sd">        -------</span>
</span><span id="State.leverage-418"><a href="#State.leverage-418"><span class="linenos">418</span></a><span class="sd">        float</span>
</span><span id="State.leverage-419"><a href="#State.leverage-419"><span class="linenos">419</span></a><span class="sd">            The leverage ratio of the portfolio</span>
</span><span id="State.leverage-420"><a href="#State.leverage-420"><span class="linenos">420</span></a>
</span><span id="State.leverage-421"><a href="#State.leverage-421"><span class="linenos">421</span></a><span class="sd">        Notes</span>
</span><span id="State.leverage-422"><a href="#State.leverage-422"><span class="linenos">422</span></a><span class="sd">        -----</span>
</span><span id="State.leverage-423"><a href="#State.leverage-423"><span class="linenos">423</span></a><span class="sd">        A leverage of 2.0 means the portfolio has twice the market exposure</span>
</span><span id="State.leverage-424"><a href="#State.leverage-424"><span class="linenos">424</span></a><span class="sd">        compared to its net asset value, which could be achieved through</span>
</span><span id="State.leverage-425"><a href="#State.leverage-425"><span class="linenos">425</span></a><span class="sd">        borrowing or short selling.</span>
</span><span id="State.leverage-426"><a href="#State.leverage-426"><span class="linenos">426</span></a>
</span><span id="State.leverage-427"><a href="#State.leverage-427"><span class="linenos">427</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="State.leverage-428"><a href="#State.leverage-428"><span class="linenos">428</span></a>        <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">weights</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
</span></pre></div>


            <div class="docstring"><p>Get the leverage of the portfolio.</p>

<p>Leverage is calculated as the sum of the absolute values of all position
weights. For a long-only portfolio with no cash, this equals 1.0.
For a portfolio with shorts or leverage, this will be greater than 1.0.</p>

<h2 id="returns">Returns</h2>

<p>float
    The leverage ratio of the portfolio</p>

<h2 id="notes">Notes</h2>

<p>A leverage of 2.0 means the portfolio has twice the market exposure
compared to its net asset value, which could be achieved through
borrowing or short selling.</p>
</div>


                            </div>
                </section>
                <section id="interpolate">
                            <input id="interpolate-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">interpolate</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">ts</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="interpolate-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#interpolate"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="interpolate-25"><a href="#interpolate-25"><span class="linenos">25</span></a><span class="k">def</span><span class="w"> </span><span class="nf">interpolate</span><span class="p">(</span><span class="n">ts</span><span class="p">):</span>
</span><span id="interpolate-26"><a href="#interpolate-26"><span class="linenos">26</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Interpolate missing values in a time series between the first and last valid indices.</span>
</span><span id="interpolate-27"><a href="#interpolate-27"><span class="linenos">27</span></a>
</span><span id="interpolate-28"><a href="#interpolate-28"><span class="linenos">28</span></a><span class="sd">    This function fills forward (ffill) missing values in a time series, but only</span>
</span><span id="interpolate-29"><a href="#interpolate-29"><span class="linenos">29</span></a><span class="sd">    between the first and last valid indices. Values outside this range remain NaN/null.</span>
</span><span id="interpolate-30"><a href="#interpolate-30"><span class="linenos">30</span></a>
</span><span id="interpolate-31"><a href="#interpolate-31"><span class="linenos">31</span></a><span class="sd">    Parameters</span>
</span><span id="interpolate-32"><a href="#interpolate-32"><span class="linenos">32</span></a><span class="sd">    ----------</span>
</span><span id="interpolate-33"><a href="#interpolate-33"><span class="linenos">33</span></a><span class="sd">    ts : pd.Series or pl.Series</span>
</span><span id="interpolate-34"><a href="#interpolate-34"><span class="linenos">34</span></a><span class="sd">        The time series to interpolate</span>
</span><span id="interpolate-35"><a href="#interpolate-35"><span class="linenos">35</span></a>
</span><span id="interpolate-36"><a href="#interpolate-36"><span class="linenos">36</span></a><span class="sd">    Returns</span>
</span><span id="interpolate-37"><a href="#interpolate-37"><span class="linenos">37</span></a><span class="sd">    -------</span>
</span><span id="interpolate-38"><a href="#interpolate-38"><span class="linenos">38</span></a><span class="sd">    pd.Series or pl.Series</span>
</span><span id="interpolate-39"><a href="#interpolate-39"><span class="linenos">39</span></a><span class="sd">        The interpolated time series</span>
</span><span id="interpolate-40"><a href="#interpolate-40"><span class="linenos">40</span></a>
</span><span id="interpolate-41"><a href="#interpolate-41"><span class="linenos">41</span></a><span class="sd">    Examples</span>
</span><span id="interpolate-42"><a href="#interpolate-42"><span class="linenos">42</span></a><span class="sd">    --------</span>
</span><span id="interpolate-43"><a href="#interpolate-43"><span class="linenos">43</span></a><span class="sd">    &gt;&gt;&gt; import pandas as pd</span>
</span><span id="interpolate-44"><a href="#interpolate-44"><span class="linenos">44</span></a><span class="sd">    &gt;&gt;&gt; import numpy as np</span>
</span><span id="interpolate-45"><a href="#interpolate-45"><span class="linenos">45</span></a><span class="sd">    &gt;&gt;&gt; ts = pd.Series([1, np.nan, np.nan, 4, 5])</span>
</span><span id="interpolate-46"><a href="#interpolate-46"><span class="linenos">46</span></a><span class="sd">    &gt;&gt;&gt; interpolate(ts)</span>
</span><span id="interpolate-47"><a href="#interpolate-47"><span class="linenos">47</span></a><span class="sd">    0    1.0</span>
</span><span id="interpolate-48"><a href="#interpolate-48"><span class="linenos">48</span></a><span class="sd">    1    1.0</span>
</span><span id="interpolate-49"><a href="#interpolate-49"><span class="linenos">49</span></a><span class="sd">    2    1.0</span>
</span><span id="interpolate-50"><a href="#interpolate-50"><span class="linenos">50</span></a><span class="sd">    3    4.0</span>
</span><span id="interpolate-51"><a href="#interpolate-51"><span class="linenos">51</span></a><span class="sd">    4    5.0</span>
</span><span id="interpolate-52"><a href="#interpolate-52"><span class="linenos">52</span></a><span class="sd">    dtype: float64</span>
</span><span id="interpolate-53"><a href="#interpolate-53"><span class="linenos">53</span></a>
</span><span id="interpolate-54"><a href="#interpolate-54"><span class="linenos">54</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="interpolate-55"><a href="#interpolate-55"><span class="linenos">55</span></a>    <span class="c1"># Check if the input is a valid type</span>
</span><span id="interpolate-56"><a href="#interpolate-56"><span class="linenos">56</span></a>    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ts</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span> <span class="o">|</span> <span class="n">pl</span><span class="o">.</span><span class="n">Series</span><span class="p">):</span>
</span><span id="interpolate-57"><a href="#interpolate-57"><span class="linenos">57</span></a>        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Expected pd.Series or pl.Series, got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">ts</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="interpolate-58"><a href="#interpolate-58"><span class="linenos">58</span></a>
</span><span id="interpolate-59"><a href="#interpolate-59"><span class="linenos">59</span></a>    <span class="c1"># If the input is a polars Series, use the polars-specific function</span>
</span><span id="interpolate-60"><a href="#interpolate-60"><span class="linenos">60</span></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ts</span><span class="p">,</span> <span class="n">pl</span><span class="o">.</span><span class="n">Series</span><span class="p">):</span>
</span><span id="interpolate-61"><a href="#interpolate-61"><span class="linenos">61</span></a>        <span class="k">return</span> <span class="n">interpolate_pl</span><span class="p">(</span><span class="n">ts</span><span class="p">)</span>
</span><span id="interpolate-62"><a href="#interpolate-62"><span class="linenos">62</span></a>    <span class="n">first</span> <span class="o">=</span> <span class="n">ts</span><span class="o">.</span><span class="n">first_valid_index</span><span class="p">()</span>
</span><span id="interpolate-63"><a href="#interpolate-63"><span class="linenos">63</span></a>    <span class="n">last</span> <span class="o">=</span> <span class="n">ts</span><span class="o">.</span><span class="n">last_valid_index</span><span class="p">()</span>
</span><span id="interpolate-64"><a href="#interpolate-64"><span class="linenos">64</span></a>
</span><span id="interpolate-65"><a href="#interpolate-65"><span class="linenos">65</span></a>    <span class="k">if</span> <span class="n">first</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">last</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="interpolate-66"><a href="#interpolate-66"><span class="linenos">66</span></a>        <span class="n">ts_slice</span> <span class="o">=</span> <span class="n">ts</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">first</span><span class="p">:</span><span class="n">last</span><span class="p">]</span>
</span><span id="interpolate-67"><a href="#interpolate-67"><span class="linenos">67</span></a>        <span class="n">ts_slice</span> <span class="o">=</span> <span class="n">ts_slice</span><span class="o">.</span><span class="n">ffill</span><span class="p">()</span>
</span><span id="interpolate-68"><a href="#interpolate-68"><span class="linenos">68</span></a>        <span class="n">result</span> <span class="o">=</span> <span class="n">ts</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="interpolate-69"><a href="#interpolate-69"><span class="linenos">69</span></a>        <span class="n">result</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">first</span><span class="p">:</span><span class="n">last</span><span class="p">]</span> <span class="o">=</span> <span class="n">ts_slice</span>
</span><span id="interpolate-70"><a href="#interpolate-70"><span class="linenos">70</span></a>        <span class="k">return</span> <span class="n">result</span>
</span><span id="interpolate-71"><a href="#interpolate-71"><span class="linenos">71</span></a>    <span class="k">return</span> <span class="n">ts</span>
</span></pre></div>


            <div class="docstring"><p>Interpolate missing values in a time series between the first and last valid indices.</p>

<p>This function fills forward (ffill) missing values in a time series, but only
between the first and last valid indices. Values outside this range remain NaN/null.</p>

<h2 id="parameters">Parameters</h2>

<p>ts : pd.Series or pl.Series
    The time series to interpolate</p>

<h2 id="returns">Returns</h2>

<p>pd.Series or pl.Series
    The interpolated time series</p>

<h2 id="examples">Examples</h2>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ts</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">interpolate</span><span class="p">(</span><span class="n">ts</span><span class="p">)</span>
<span class="go">0    1.0</span>
<span class="go">1    1.0</span>
<span class="go">2    1.0</span>
<span class="go">3    4.0</span>
<span class="go">4    5.0</span>
<span class="go">dtype: float64</span>
</code></pre>
</div>
</div>


                </section>
                <section id="valid">
                            <input id="valid-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">valid</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">ts</span></span><span class="return-annotation">) -> <span class="nb">bool</span>:</span></span>

                <label class="view-source-button" for="valid-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#valid"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="valid-74"><a href="#valid-74"><span class="linenos"> 74</span></a><span class="k">def</span><span class="w"> </span><span class="nf">valid</span><span class="p">(</span><span class="n">ts</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="valid-75"><a href="#valid-75"><span class="linenos"> 75</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Check if a time series has no missing values between the first and last valid indices.</span>
</span><span id="valid-76"><a href="#valid-76"><span class="linenos"> 76</span></a>
</span><span id="valid-77"><a href="#valid-77"><span class="linenos"> 77</span></a><span class="sd">    This function verifies that a time series doesn&#39;t have any NaN/null values in the middle.</span>
</span><span id="valid-78"><a href="#valid-78"><span class="linenos"> 78</span></a><span class="sd">    It&#39;s acceptable to have NaNs/nulls at the beginning or end of the series.</span>
</span><span id="valid-79"><a href="#valid-79"><span class="linenos"> 79</span></a>
</span><span id="valid-80"><a href="#valid-80"><span class="linenos"> 80</span></a><span class="sd">    Parameters</span>
</span><span id="valid-81"><a href="#valid-81"><span class="linenos"> 81</span></a><span class="sd">    ----------</span>
</span><span id="valid-82"><a href="#valid-82"><span class="linenos"> 82</span></a><span class="sd">    ts : pd.Series or pl.Series</span>
</span><span id="valid-83"><a href="#valid-83"><span class="linenos"> 83</span></a><span class="sd">        The time series to check</span>
</span><span id="valid-84"><a href="#valid-84"><span class="linenos"> 84</span></a>
</span><span id="valid-85"><a href="#valid-85"><span class="linenos"> 85</span></a><span class="sd">    Returns</span>
</span><span id="valid-86"><a href="#valid-86"><span class="linenos"> 86</span></a><span class="sd">    -------</span>
</span><span id="valid-87"><a href="#valid-87"><span class="linenos"> 87</span></a><span class="sd">    bool</span>
</span><span id="valid-88"><a href="#valid-88"><span class="linenos"> 88</span></a><span class="sd">        True if the time series has no missing values between the first and last valid indices,</span>
</span><span id="valid-89"><a href="#valid-89"><span class="linenos"> 89</span></a><span class="sd">        False otherwise</span>
</span><span id="valid-90"><a href="#valid-90"><span class="linenos"> 90</span></a>
</span><span id="valid-91"><a href="#valid-91"><span class="linenos"> 91</span></a><span class="sd">    Examples</span>
</span><span id="valid-92"><a href="#valid-92"><span class="linenos"> 92</span></a><span class="sd">    --------</span>
</span><span id="valid-93"><a href="#valid-93"><span class="linenos"> 93</span></a><span class="sd">    &gt;&gt;&gt; import pandas as pd</span>
</span><span id="valid-94"><a href="#valid-94"><span class="linenos"> 94</span></a><span class="sd">    &gt;&gt;&gt; import numpy as np</span>
</span><span id="valid-95"><a href="#valid-95"><span class="linenos"> 95</span></a><span class="sd">    &gt;&gt;&gt; ts1 = pd.Series([np.nan, 1, 2, 3, np.nan])  # NaNs only at beginning and end</span>
</span><span id="valid-96"><a href="#valid-96"><span class="linenos"> 96</span></a><span class="sd">    &gt;&gt;&gt; valid(ts1)</span>
</span><span id="valid-97"><a href="#valid-97"><span class="linenos"> 97</span></a><span class="sd">    True</span>
</span><span id="valid-98"><a href="#valid-98"><span class="linenos"> 98</span></a><span class="sd">    &gt;&gt;&gt; ts2 = pd.Series([1, 2, np.nan, 4, 5])  # NaN in the middle</span>
</span><span id="valid-99"><a href="#valid-99"><span class="linenos"> 99</span></a><span class="sd">    &gt;&gt;&gt; valid(ts2)</span>
</span><span id="valid-100"><a href="#valid-100"><span class="linenos">100</span></a><span class="sd">    False</span>
</span><span id="valid-101"><a href="#valid-101"><span class="linenos">101</span></a>
</span><span id="valid-102"><a href="#valid-102"><span class="linenos">102</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="valid-103"><a href="#valid-103"><span class="linenos">103</span></a>    <span class="c1"># Check if the input is a valid type</span>
</span><span id="valid-104"><a href="#valid-104"><span class="linenos">104</span></a>    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ts</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span> <span class="o">|</span> <span class="n">pl</span><span class="o">.</span><span class="n">Series</span><span class="p">):</span>
</span><span id="valid-105"><a href="#valid-105"><span class="linenos">105</span></a>        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Expected pd.Series or pl.Series, got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">ts</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="valid-106"><a href="#valid-106"><span class="linenos">106</span></a>
</span><span id="valid-107"><a href="#valid-107"><span class="linenos">107</span></a>    <span class="c1"># If the input is a polars Series, use the polars-specific function</span>
</span><span id="valid-108"><a href="#valid-108"><span class="linenos">108</span></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ts</span><span class="p">,</span> <span class="n">pl</span><span class="o">.</span><span class="n">Series</span><span class="p">):</span>
</span><span id="valid-109"><a href="#valid-109"><span class="linenos">109</span></a>        <span class="k">return</span> <span class="n">valid_pl</span><span class="p">(</span><span class="n">ts</span><span class="p">)</span>
</span><span id="valid-110"><a href="#valid-110"><span class="linenos">110</span></a>    <span class="c1"># Check if the series with NaNs dropped has the same indices as the interpolated series with NaNs dropped</span>
</span><span id="valid-111"><a href="#valid-111"><span class="linenos">111</span></a>    <span class="c1"># If they&#39;re the same, there are no NaNs in the middle of the series</span>
</span><span id="valid-112"><a href="#valid-112"><span class="linenos">112</span></a>    <span class="k">return</span> <span class="n">ts</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">equals</span><span class="p">(</span><span class="n">interpolate</span><span class="p">(</span><span class="n">ts</span><span class="p">)</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Check if a time series has no missing values between the first and last valid indices.</p>

<p>This function verifies that a time series doesn't have any NaN/null values in the middle.
It's acceptable to have NaNs/nulls at the beginning or end of the series.</p>

<h2 id="parameters">Parameters</h2>

<p>ts : pd.Series or pl.Series
    The time series to check</p>

<h2 id="returns">Returns</h2>

<p>bool
    True if the time series has no missing values between the first and last valid indices,
    False otherwise</p>

<h2 id="examples">Examples</h2>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ts1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">])</span>  <span class="c1"># NaNs only at beginning and end</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">valid</span><span class="p">(</span><span class="n">ts1</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ts2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>  <span class="c1"># NaN in the middle</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">valid</span><span class="p">(</span><span class="n">ts2</span><span class="p">)</span>
<span class="go">False</span>
</code></pre>
</div>
</div>


                </section>
    </main>
</body>
</html>